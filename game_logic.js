const _0x571912=_0x377a;(function(_0x21c866,_0x2b91b5){const _0x499e0f=_0x377a,_0x5611e1=_0x21c866();while(!![]){try{const _0x3f3f54=-parseInt(_0x499e0f(0xb9))/0x1+-parseInt(_0x499e0f(0x1c8))/0x2*(parseInt(_0x499e0f(0xf3))/0x3)+-parseInt(_0x499e0f(0x139))/0x4+-parseInt(_0x499e0f(0x90))/0x5+-parseInt(_0x499e0f(0x16f))/0x6+parseInt(_0x499e0f(0xc0))/0x7*(-parseInt(_0x499e0f(0xc8))/0x8)+parseInt(_0x499e0f(0x114))/0x9;if(_0x3f3f54===_0x2b91b5)break;else _0x5611e1['push'](_0x5611e1['shift']());}catch(_0x2b6526){_0x5611e1['push'](_0x5611e1['shift']());}}}(_0x5062,0x2f35c));function generateAttackPathInternal(_0x1c2872){const _0x5838b7=_0x377a;try{if(!_0x1c2872||!gameCanvas)return[];const _0x591fa1=_0x1c2872[_0x5838b7(0x9f)]===ENEMY3_TYPE?BOSS_WIDTH:_0x1c2872[_0x5838b7(0x9f)]===ENEMY1_TYPE?ENEMY1_WIDTH:ENEMY_WIDTH,_0x37316b=_0x1c2872['type']===ENEMY3_TYPE?BOSS_HEIGHT:_0x1c2872['type']===ENEMY1_TYPE?ENEMY1_HEIGHT:ENEMY_HEIGHT,_0x1c8712=_0x591fa1*0.5,_0xdd8c96=gameCanvas[_0x5838b7(0x1c4)],_0xdd47fb=gameCanvas['height'];let _0x7111aa=[];const _0x499268={'x':_0x1c2872['x'],'y':_0x1c2872['y']},_0xe62539=Math[_0x5838b7(0xf4)](_0xdd47fb*0.06,_0x37316b*1.8),_0x3829b1=Math[_0x5838b7(0xf4)](_0xdd8c96*0.04,_0x591fa1*1.2),_0x1bb8c7=_0x1c2872['x']+_0x591fa1/0x2<_0xdd8c96/0x2?0x1:-0x1,_0x4a5e80={'x':_0x499268['x']-_0x1bb8c7*_0x3829b1*0.6,'y':_0x499268['y']-_0xe62539};_0x4a5e80['x']=Math[_0x5838b7(0x14a)](_0x1c8712,Math[_0x5838b7(0xf4)](_0xdd8c96-_0x1c8712-_0x591fa1,_0x4a5e80['x'])),_0x4a5e80['y']=Math[_0x5838b7(0x14a)](_0x1c8712,_0x4a5e80['y']);const _0x1c2e49={'x':_0x499268['x']+_0x1bb8c7*_0x3829b1*0.1,'y':_0x499268['y']-_0xe62539*1.4},_0x11d583={'x':_0x4a5e80['x']+_0x1bb8c7*_0x3829b1*0.3,'y':_0x499268['y']-_0xe62539*1.5},_0x1e45b2={'p0':_0x499268,'p1':_0x1c2e49,'p2':_0x11d583,'p3':_0x4a5e80};_0x7111aa[_0x5838b7(0xd2)](_0x1e45b2);const _0x3e08c0=_0x4a5e80,_0x198f9b=_0xdd47fb*0.45,_0x509cfe=_0xdd8c96*0.22,_0x435bab=_0xdd47fb*0.28,_0x36a892=0.5,_0x2407d1=0.6,_0x5e4252=_0xdd47fb*0.85,_0x97a2fc=Math[_0x5838b7(0x9c)](Math['random']()*0x3);let _0x247894=[];if(_0x97a2fc===0x0){const _0x3a5d3e=_0x198f9b+Math['random']()*_0xdd47fb*0.1,_0x378cd4=_0x509cfe+Math['random']()*_0xdd8c96*0.08,_0x526ac6=_0x435bab+Math[_0x5838b7(0xcb)]()*_0xdd47fb*0.08,_0x297351=_0x3e08c0['x']+_0x1bb8c7*_0x378cd4*0.5,_0x488647=Math[_0x5838b7(0xf4)](_0x5e4252,_0x3e08c0['y']+_0x3a5d3e),_0x14d34b=_0x297351+_0x1bb8c7*_0x378cd4*0.5,_0x5b2e3d=Math[_0x5838b7(0x14a)](_0x3e08c0['y']+0x14,_0x488647-_0x526ac6),_0x764808=_0x14d34b-_0x1bb8c7*_0x378cd4*0.9,_0x4900e0=Math[_0x5838b7(0x14a)](_0x3e08c0['y']+0x28,_0x5b2e3d+_0x526ac6*0.6),_0x175708=_0x764808-_0x1bb8c7*_0x378cd4*0.3,_0x223fda=_0xdd47fb+_0x37316b*0x2,_0x38e37d=Math[_0x5838b7(0x14a)](_0x1c8712,Math[_0x5838b7(0xf4)](_0xdd8c96-_0x1c8712-_0x591fa1,_0x297351)),_0x5426cd=Math['max'](_0x1c8712,Math[_0x5838b7(0xf4)](_0xdd8c96-_0x1c8712-_0x591fa1,_0x14d34b)),_0x3e904a=Math[_0x5838b7(0x14a)](_0x1c8712,Math[_0x5838b7(0xf4)](_0xdd8c96-_0x1c8712-_0x591fa1,_0x764808)),_0x561b71={'x':_0x3e08c0['x'],'y':_0x3e08c0['y']+_0x3a5d3e*_0x2407d1*0.5},_0x3e4a93={'x':_0x38e37d-_0x1bb8c7*_0x378cd4*_0x36a892,'y':_0x488647},_0x3f4df7={'x':_0x38e37d,'y':_0x488647},_0x27b318={'x':_0x38e37d+_0x1bb8c7*_0x378cd4*_0x36a892,'y':_0x488647},_0x2afd1e={'x':_0x5426cd,'y':_0x5b2e3d+_0x526ac6*_0x2407d1},_0x9e8a2={'x':_0x5426cd,'y':_0x5b2e3d},_0x5b697e={'x':_0x5426cd,'y':_0x5b2e3d-_0x526ac6*_0x2407d1*0.5},_0x24dc98={'x':_0x3e904a+_0x1bb8c7*_0x378cd4*_0x36a892,'y':_0x4900e0},_0x1d820c={'x':_0x3e904a,'y':_0x4900e0},_0x13cb66={'x':_0x1d820c['x'],'y':_0x1d820c['y']+_0xdd47fb*0.1},_0x9f8b86={'x':_0x175708,'y':_0x223fda-_0xdd47fb*0.2},_0x26e440={'x':_0x175708,'y':_0x223fda};_0x247894=[{'p0':_0x3e08c0,'p1':_0x561b71,'p2':_0x3e4a93,'p3':_0x3f4df7},{'p0':_0x3f4df7,'p1':_0x27b318,'p2':_0x2afd1e,'p3':_0x9e8a2},{'p0':_0x9e8a2,'p1':_0x5b697e,'p2':_0x24dc98,'p3':_0x1d820c},{'p0':_0x1d820c,'p1':_0x13cb66,'p2':_0x9f8b86,'p3':_0x26e440}];}else{if(_0x97a2fc===0x1){const _0x22d4f4=_0x198f9b*0.8+Math[_0x5838b7(0xcb)]()*_0xdd47fb*0.1,_0x697a08=_0x509cfe*1.2+Math['random']()*_0xdd8c96*0.1,_0x1813ab=_0x435bab*0.7+Math['random']()*_0xdd47fb*0.1,_0x513cde=_0x3e08c0['x']+_0x1bb8c7*_0x697a08*0.4,_0x318bd6=Math[_0x5838b7(0xf4)](_0x5e4252-_0x1813ab*0.5,_0x3e08c0['y']+_0x22d4f4*0.6),_0x30ed32=_0x513cde+_0x1bb8c7*_0x697a08*0.6,_0x406885=Math[_0x5838b7(0xf4)](_0x5e4252,_0x318bd6+_0x1813ab),_0x13fcf6=_0x30ed32-_0x1bb8c7*_0x697a08*0.5,_0x56f406=_0xdd47fb+_0x37316b*0x2,_0x248831=Math['max'](_0x1c8712,Math['min'](_0xdd8c96-_0x1c8712-_0x591fa1,_0x513cde)),_0x19012c=Math['max'](_0x1c8712,Math[_0x5838b7(0xf4)](_0xdd8c96-_0x1c8712-_0x591fa1,_0x30ed32)),_0x56b857={'x':_0x3e08c0['x']-_0x1bb8c7*_0x697a08*0.1,'y':_0x3e08c0['y']+_0x22d4f4*0.3},_0x56af07={'x':_0x248831-_0x1bb8c7*_0x697a08*_0x36a892*0.8,'y':_0x318bd6+_0x1813ab*_0x2407d1*0.4},_0x177750={'x':_0x248831,'y':_0x318bd6},_0x295d30={'x':_0x248831+_0x1bb8c7*_0x697a08*_0x36a892*0.8,'y':_0x318bd6-_0x1813ab*_0x2407d1*0.4},_0x54159c={'x':_0x19012c+_0x1bb8c7*_0x697a08*_0x36a892*0.6,'y':_0x406885+_0x1813ab*_0x2407d1*0.5},_0x1ae5f1={'x':_0x19012c,'y':_0x406885},_0x1bb5a9={'x':_0x19012c-_0x1bb8c7*_0x697a08*0.2,'y':_0x406885+_0xdd47fb*0.1},_0x157542={'x':_0x13fcf6,'y':_0x56f406-_0xdd47fb*0.3},_0x18baf4={'x':_0x13fcf6,'y':_0x56f406};_0x247894=[{'p0':_0x3e08c0,'p1':_0x56b857,'p2':_0x56af07,'p3':_0x177750},{'p0':_0x177750,'p1':_0x295d30,'p2':_0x54159c,'p3':_0x1ae5f1},{'p0':_0x1ae5f1,'p1':_0x1bb5a9,'p2':_0x157542,'p3':_0x18baf4}];}else{const _0x21e2a8=_0x198f9b*0.6+Math['random']()*_0xdd47fb*0.05,_0x1aa98a=_0x509cfe*0.7+Math[_0x5838b7(0xcb)]()*_0xdd8c96*0.05,_0xa75ab4=_0x435bab*0.6+Math[_0x5838b7(0xcb)]()*_0xdd47fb*0.05,_0x345397=_0xa75ab4*1.5,_0xb5226=_0x3e08c0['x']+_0x1bb8c7*_0x1aa98a*0.5,_0x12f94a=Math[_0x5838b7(0xf4)](_0x5e4252-_0x345397,_0x3e08c0['y']+_0x21e2a8),_0x24f148=_0xb5226+_0x1bb8c7*_0x1aa98a*0.5,_0x1ef49e=_0x12f94a+_0xa75ab4,_0x4c475e=_0x24f148-_0x1bb8c7*_0x1aa98a*0.8,_0x5c182c=Math[_0x5838b7(0xf4)](_0x5e4252,_0x1ef49e+_0x345397*0.7),_0x30159b=_0x4c475e+_0x1bb8c7*_0x1aa98a*0.4,_0xb2c38f=_0x5c182c+_0xa75ab4*0.8,_0xd3966d=_0x30159b,_0x19574b=_0xdd47fb+_0x37316b*0x2,_0x33489a=Math['max'](_0x1c8712,Math[_0x5838b7(0xf4)](_0xdd8c96-_0x1c8712-_0x591fa1,_0xb5226)),_0x2e2a88=Math[_0x5838b7(0x14a)](_0x1c8712,Math[_0x5838b7(0xf4)](_0xdd8c96-_0x1c8712-_0x591fa1,_0x24f148)),_0x488976=Math[_0x5838b7(0x14a)](_0x1c8712,Math[_0x5838b7(0xf4)](_0xdd8c96-_0x1c8712-_0x591fa1,_0x4c475e)),_0x5a0831=Math['max'](_0x1c8712,Math[_0x5838b7(0xf4)](_0xdd8c96-_0x1c8712-_0x591fa1,_0x30159b)),_0x15a421={'x':_0x3e08c0['x'],'y':_0x3e08c0['y']+_0x21e2a8*0.5},_0x2109ed={'x':_0x33489a-_0x1bb8c7*_0x1aa98a*_0x36a892,'y':_0x12f94a+_0xa75ab4*_0x2407d1*0.3},_0x3feee3={'x':_0x33489a,'y':_0x12f94a},_0x1aa164={'x':_0x33489a+_0x1bb8c7*_0x1aa98a*_0x36a892,'y':_0x12f94a-_0xa75ab4*_0x2407d1*0.3},_0x2f2676={'x':_0x2e2a88+_0x1bb8c7*_0x1aa98a*_0x36a892,'y':_0x1ef49e+_0xa75ab4*_0x2407d1*0.5},_0x5250fe={'x':_0x2e2a88,'y':_0x1ef49e},_0x34b27f={'x':_0x2e2a88-_0x1bb8c7*_0x1aa98a*_0x36a892,'y':_0x1ef49e-_0xa75ab4*_0x2407d1*0.5},_0x3b6ed6={'x':_0x488976-_0x1bb8c7*_0x1aa98a*_0x36a892,'y':_0x5c182c+_0xa75ab4*_0x2407d1*0.4},_0x1ae075={'x':_0x488976,'y':_0x5c182c},_0x5597f3={'x':_0x488976+_0x1bb8c7*_0x1aa98a*_0x36a892,'y':_0x5c182c-_0xa75ab4*_0x2407d1*0.4},_0x329030={'x':_0x5a0831+_0x1bb8c7*_0x1aa98a*_0x36a892,'y':_0xb2c38f+_0xa75ab4*_0x2407d1*0.6},_0x155189={'x':_0x5a0831,'y':_0xb2c38f},_0x52c165={'x':_0x5a0831-_0x1bb8c7*_0x1aa98a*0.1,'y':_0xb2c38f+_0xdd47fb*0.05},_0x1dc1df={'x':_0xd3966d,'y':_0x19574b-_0xdd47fb*0.2},_0xd95fd4={'x':_0xd3966d,'y':_0x19574b};_0x247894=[{'p0':_0x3e08c0,'p1':_0x15a421,'p2':_0x2109ed,'p3':_0x3feee3},{'p0':_0x3feee3,'p1':_0x1aa164,'p2':_0x2f2676,'p3':_0x5250fe},{'p0':_0x5250fe,'p1':_0x34b27f,'p2':_0x3b6ed6,'p3':_0x1ae075},{'p0':_0x1ae075,'p1':_0x5597f3,'p2':_0x329030,'p3':_0x155189},{'p0':_0x155189,'p1':_0x52c165,'p2':_0x1dc1df,'p3':_0xd95fd4}];}}return _0x7111aa[_0x5838b7(0xd2)](..._0x247894),_0x7111aa;}catch(_0x547f62){return console[_0x5838b7(0x95)](_0x5838b7(0x15e)+_0x1c2872?.['id']+':',_0x547f62),[];}}window['generateAttackPath']=generateAttackPathInternal;function resetAllMessagesInternal(){showReadyMessage=![],isShowingIntro=![],showCsHitsMessage=![],showPerfectMessage=![],showCsBonusScoreMessage=![],showCSClearMessage=![],showCsHitsForClearMessage=![],showCsScoreForClearMessage=![],showExtraLifeMessage=![],isShowingCaptureMessage=![],isShowingPlayerGameOverMessage=![],isShowingCoopPlayersReady=![],csHitsMessageStartTime=0x0,perfectMessageStartTime=0x0,csBonusScoreMessageStartTime=0x0,csClearMessageStartTime=0x0,extraLifeMessageStartTime=0x0,readyMessageStartTime=0x0,captureMessageStartTime=0x0,playerGameOverMessageStartTime=0x0,csCompletionDelayStartTime=0x0,introDisplayStartTime=0x0,coopPlayersReadyStartTime=0x0;}window['resetAllMessages']=resetAllMessagesInternal;function stopAllGameSoundsInternal(){const _0x559123=_0x377a;if(typeof soundPaths===_0x559123(0x171)&&soundPaths!==null&&typeof stopSound===_0x559123(0x11f))for(const _0x67fcca in soundPaths){stopSound(_0x67fcca);}isGridSoundPlaying=![];}window[_0x571912(0x187)]=stopAllGameSoundsInternal;function resetGameInternal(){const _0x1617db=_0x571912;score=0x0,level=0x1,playerLives=0x3;if(isTwoPlayerMode){player1Lives=0x3,player2Lives=0x3,player1Score=0x0,player2Score=0x0,currentPlayer=0x1,player1CompletedLevel=-0x1,player1MaxLevelReached=0x1,player2MaxLevelReached=0x1;if(player1LifeThresholdsMet instanceof Set)player1LifeThresholdsMet[_0x1617db(0x10b)]();else player1LifeThresholdsMet=new Set();if(player2LifeThresholdsMet instanceof Set)player2LifeThresholdsMet[_0x1617db(0x10b)]();else player2LifeThresholdsMet=new Set();player1IsDualShipActive=![],player2IsDualShipActive=![],isPlayer1ShipCaptured=![],isPlayer2ShipCaptured=![],isPlayer1WaitingForRespawn=![],isPlayer2WaitingForRespawn=![],isPlayer1Invincible=![],isPlayer2Invincible=![],player1RespawnTime=0x0,player2RespawnTime=0x0,player1InvincibilityEndTime=0x0,player2InvincibilityEndTime=0x0,player1CaptureRespawnX=0x0,player2CaptureRespawnX=0x0,player1NeedsRespawnAfterCapture=![],player2NeedsRespawnAfterCapture=![];if(selectedGameMode===_0x1617db(0x99)){playerLives=0x0;if(gameCanvas&&gameCanvas[_0x1617db(0x1c4)]>0x0&&gameCanvas['height']>0x0){const _0x56d6ea=gameCanvas[_0x1617db(0x1c4)]/0x2-gameCanvas[_0x1617db(0x1c4)]*COOP_SHIP_HORIZONTAL_OFFSET_FACTOR-SHIP_WIDTH/0x2,_0x553064=gameCanvas[_0x1617db(0x1c4)]/0x2+gameCanvas[_0x1617db(0x1c4)]*COOP_SHIP_HORIZONTAL_OFFSET_FACTOR-SHIP_WIDTH/0x2,_0x2d1aad=gameCanvas[_0x1617db(0x120)]-SHIP_HEIGHT-SHIP_BOTTOM_MARGIN;ship1={'x':_0x56d6ea,'y':_0x2d1aad,'width':SHIP_WIDTH,'height':SHIP_HEIGHT,'speed':SHIP_MOVE_SPEED,'targetX':_0x56d6ea,'id':'p1'},ship2={'x':_0x553064,'y':_0x2d1aad,'width':SHIP_WIDTH,'height':SHIP_HEIGHT,'speed':SHIP_MOVE_SPEED,'targetX':_0x553064,'id':'p2'},(isCoopAIDemoActive||isPlayerTwoAI&&selectedOnePlayerGameVariant===_0x1617db(0x165))&&(smoothedShip1X=_0x56d6ea,smoothedShip2X=_0x553064,aiShip1TargetEnemy=null,aiShip2TargetEnemy=null,aiShip1CanShootTime=0x0,aiShip2CanShootTime=0x0,aiShip1LastShotTime=0x0,aiShip2LastShotTime=0x0,aiPlayerActivelySeekingCaptureById=null,coopAICaptureDiveAnticipationActive=![],coopAICaptureDiveAnticipationEndTime=0x0);}ship=null;}else{if(!ship&&gameCanvas&&gameCanvas[_0x1617db(0x1c4)]>0x0&&gameCanvas[_0x1617db(0x120)]>0x0)ship={'x':Math[_0x1617db(0x196)](gameCanvas[_0x1617db(0x1c4)]/0x2-SHIP_WIDTH/0x2),'y':gameCanvas[_0x1617db(0x120)]-SHIP_HEIGHT-SHIP_BOTTOM_MARGIN,'width':SHIP_WIDTH,'height':SHIP_HEIGHT,'speed':SHIP_MOVE_SPEED,'targetX':0x0,'id':_0x1617db(0x133)},ship[_0x1617db(0x107)]=ship['x'];else ship&&gameCanvas&&gameCanvas['width']>0x0&&gameCanvas[_0x1617db(0x120)]>0x0&&(ship['x']=Math[_0x1617db(0x196)](gameCanvas['width']/0x2-SHIP_WIDTH/0x2),ship['targetX']=ship['x'],ship['y']=gameCanvas['height']-SHIP_HEIGHT-SHIP_BOTTOM_MARGIN);ship1=null,ship2=null;}}else{player1Lives=0x3,player1Score=0x0,player1MaxLevelReached=0x1;if(player1LifeThresholdsMet instanceof Set)player1LifeThresholdsMet[_0x1617db(0x10b)]();else player1LifeThresholdsMet=new Set();if(!ship&&gameCanvas&&gameCanvas[_0x1617db(0x1c4)]>0x0&&gameCanvas['height']>0x0)ship={'x':Math[_0x1617db(0x196)](gameCanvas['width']/0x2-SHIP_WIDTH/0x2),'y':gameCanvas['height']-SHIP_HEIGHT-SHIP_BOTTOM_MARGIN,'width':SHIP_WIDTH,'height':SHIP_HEIGHT,'speed':SHIP_MOVE_SPEED,'targetX':0x0,'id':_0x1617db(0x133)},ship[_0x1617db(0x107)]=ship['x'];else ship&&gameCanvas&&gameCanvas['width']>0x0&&gameCanvas[_0x1617db(0x120)]>0x0&&(ship['x']=Math[_0x1617db(0x196)](gameCanvas['width']/0x2-SHIP_WIDTH/0x2),ship[_0x1617db(0x107)]=ship['x'],ship['y']=gameCanvas['height']-SHIP_HEIGHT-SHIP_BOTTOM_MARGIN);ship1=null,ship2=null;}isShipCaptured=![],isWaitingForRespawn=![],respawnTime=0x0,isInvincible=![],invincibilityEndTime=0x0,isDualShipActive=![];if(!isTwoPlayerMode)player1IsDualShipActive=![];fallingShips=[],visualOffsetX=-0x14,gameOverSequenceStartTime=0x0,isShowingResultsScreen=![],gameStartTime=Date[_0x1617db(0x1a6)](),gameJustStarted=!![],gameJustStartedAndWaveLaunched=![],currentGridOffsetX=0x0,gridMoveDirection=0x1,gridJustCompleted=![],isGridBreathingActive=![],gridBreathStartTime=0x0,currentGridBreathFactor=0x0,lastGridFireCheckTime=0x0,player1ShotsFired=0x0,player2ShotsFired=0x0,player1EnemiesHit=0x0,player2EnemiesHit=0x0,scoreEarnedThisCS=0x0,challengingStageEnemiesHit=0x0,aiNeedsStabilization=!![],aiStabilizationEndTime=0x0,smoothedShipX=undefined,aiCanShootTime=0x0,aiLastShotTime=0x0,!(selectedGameMode===_0x1617db(0x99)&&(isCoopAIDemoActive||isPlayerTwoAI&&selectedOnePlayerGameVariant===_0x1617db(0x165)))&&(aiPlayerActivelySeekingCaptureById=null,coopAICaptureDiveAnticipationActive=![],coopAICaptureDiveAnticipationEndTime=0x0),playerLastShotTime=0x0,player1LastShotTime=0x0,player2LastShotTime=0x0,p1FireInputWasDown=![],p2FireInputWasDown=![],p1JustFiredSingle=![],p2JustFiredSingle=![],player1TriggeredHighScoreSound=![],player2TriggeredHighScoreSound=![],isShowingCoopPlayersReady=![],coopPlayersReadyStartTime=0x0,resetWaveInternal();}window[_0x571912(0xc5)]=resetGameInternal;function resetWaveInternal(){const _0x24ff37=_0x571912;isWaveTransitioning=![],readyForNextWave=![],readyForNextWaveReset=![],isEntrancePhaseActive=!![],firstEnemyLanded=![],captureAttemptMadeThisLevel=![],gameJustStartedAndWaveLaunched=![],aiPlayerActivelySeekingCaptureById=null,coopAICaptureDiveAnticipationActive=![],coopAICaptureDiveAnticipationEndTime=0x0,player1CaptureRespawnX=0x0,player2CaptureRespawnX=0x0,player1NeedsRespawnAfterCapture=![],player2NeedsRespawnAfterCapture=![],enemies=[],bullets=[],enemyBullets=[],explosions=[],floatingScores=[],hitSparks=[];Array[_0x24ff37(0xd8)](enemySpawnTimeouts)&&enemySpawnTimeouts[_0x24ff37(0xce)](clearTimeout);enemySpawnTimeouts=[],squadronCompletionStatus={},squadronEntranceFiringStatus={},totalEnemiesScheduledForWave=0x0,enemiesSpawnedThisWave=0x0;const _0x4a1af7=getWaveTypeInternal(level);isChallengingStage=_0x4a1af7===_0x24ff37(0x105),isFullGridWave=_0x4a1af7===_0x24ff37(0xd1),challengingStageEnemiesHit=0x0,scoreEarnedThisCS=0x0,csCurrentChainHits=0x0,csCurrentChainScore=0x0,csLastHitTime=0x0,csLastChainHitPosition=null;(isFullGridWave||isChallengingStage)&&(isEntrancePhaseActive=![]);const _0x55803c=isShowingDemoText;resetAllMessagesInternal();_0x55803c&&(isShowingDemoText=!![]);if(selectedGameMode==='coop'&&level===0x1)isShowingIntro=![],introStep=0x2;else{if(isTwoPlayerMode&&selectedGameMode===_0x24ff37(0x156)||isPlayerTwoAI&&selectedOnePlayerGameVariant===_0x24ff37(0xde)){introStep=0x1,isShowingIntro=!![];if(!isManualControl)isShowingDemoText=!![];}else{if(isChallengingStage){introStep=0x3,isShowingIntro=!![];if(!isManualControl)isShowingDemoText=!![];}else{if(level===0x1&&!isTwoPlayerMode){introStep=0x1,isShowingIntro=!![];if(!isManualControl)isShowingDemoText=!![];}else{introStep=0x2,isShowingIntro=!![];if(!isManualControl)isShowingDemoText=!![];}}}}isShowingIntro&&!(selectedGameMode==='coop'&&level===0x1)&&(introDisplayStartTime=Date[_0x24ff37(0x1a6)]());playerIntroSoundPlayed=![],stageIntroSoundPlayed=![],csIntroSoundPlayed=![],currentWaveDefinition=generateWaveDefinitionInternal(level);if(selectedGameMode===_0x24ff37(0x99)){if(gameCanvas&&gameCanvas[_0x24ff37(0x1c4)]>0x0&&gameCanvas['height']>0x0){const _0x119d0b=ship1&&player1Lives>0x0,_0x41ecc8=ship2&&player2Lives>0x0,_0x52852a=gameCanvas[_0x24ff37(0x120)]-SHIP_HEIGHT-SHIP_BOTTOM_MARGIN;if(isCoopAIDemoActive||isPlayerTwoAI&&selectedOnePlayerGameVariant===_0x24ff37(0x165)){if(_0x119d0b&&_0x41ecc8){const _0x1541b9=gameCanvas[_0x24ff37(0x1c4)]/0x2-gameCanvas['width']*COOP_SHIP_HORIZONTAL_OFFSET_FACTOR-SHIP_WIDTH/0x2;ship1&&(ship1[_0x24ff37(0x107)]=_0x1541b9,ship1['x']=_0x1541b9,smoothedShip1X=_0x1541b9,ship1['y']=_0x52852a);const _0x3d827a=gameCanvas[_0x24ff37(0x1c4)]/0x2+gameCanvas[_0x24ff37(0x1c4)]*COOP_SHIP_HORIZONTAL_OFFSET_FACTOR-SHIP_WIDTH/0x2;ship2&&(ship2[_0x24ff37(0x107)]=_0x3d827a,ship2['x']=_0x3d827a,smoothedShip2X=_0x3d827a,ship2['y']=_0x52852a);}else{if(_0x119d0b&&ship1){const _0x148587=player1IsDualShipActive?SHIP_WIDTH+DUAL_SHIP_OFFSET_X:SHIP_WIDTH,_0x237476=Math[_0x24ff37(0x196)](gameCanvas[_0x24ff37(0x1c4)]/0x2-_0x148587/0x2);ship1[_0x24ff37(0x107)]=_0x237476,ship1['x']=_0x237476,smoothedShip1X=_0x237476,ship1['y']=_0x52852a;}else{if(_0x41ecc8&&ship2){const _0x5be022=player2IsDualShipActive?SHIP_WIDTH+DUAL_SHIP_OFFSET_X:SHIP_WIDTH,_0x28fe4c=Math['round'](gameCanvas['width']/0x2-_0x5be022/0x2);ship2[_0x24ff37(0x107)]=_0x28fe4c,ship2['x']=_0x28fe4c,smoothedShip2X=_0x28fe4c,ship2['y']=_0x52852a;}}}}else{if(_0x119d0b&&ship1)ship1['y']=_0x52852a;if(_0x41ecc8&&ship2)ship2['y']=_0x52852a;}}}else{if(ship&&gameCanvas&&gameCanvas[_0x24ff37(0x1c4)]>0x0&&gameCanvas[_0x24ff37(0x120)]>0x0&&(forceCenterShipNextReset||!isManualControl||isPlayerTwoAI&&selectedGameMode===_0x24ff37(0x156)&&currentPlayer===0x2)){let _0x5353d2=ship[_0x24ff37(0x1c4)];if(isDualShipActive)_0x5353d2=DUAL_SHIP_OFFSET_X+SHIP_WIDTH;ship['x']=Math[_0x24ff37(0x196)](gameCanvas['width']/0x2-_0x5353d2/0x2),ship[_0x24ff37(0x107)]=ship['x'],ship['y']=gameCanvas[_0x24ff37(0x120)]-SHIP_HEIGHT-SHIP_BOTTOM_MARGIN;if(isPlayerTwoAI&&selectedGameMode===_0x24ff37(0x156)&&currentPlayer===0x2)smoothedShipX=ship['x'];}else ship&&gameCanvas&&gameCanvas[_0x24ff37(0x1c4)]>0x0&&(ship['y']=gameCanvas[_0x24ff37(0x120)]-SHIP_HEIGHT-SHIP_BOTTOM_MARGIN);}forceCenterShipNextReset=![];if(!isManualControl&&aiNeedsStabilization&&selectedGameMode!=='coop'&&!isCoopAIDemoActive&&!(isPlayerTwoAI&&selectedGameMode===_0x24ff37(0x156)&&currentPlayer===0x2)){aiStabilizationEndTime=Date[_0x24ff37(0x1a6)]()+AI_STABILIZATION_DURATION;if(ship)smoothedShipX=ship['x'];}else{if(isPlayerTwoAI&&selectedGameMode===_0x24ff37(0x156)&&currentPlayer===0x2&&aiNeedsStabilization){aiStabilizationEndTime=Date[_0x24ff37(0x1a6)]()+AI_STABILIZATION_DURATION;if(ship)smoothedShipX=ship['x'];}}}window['resetWave']=resetWaveInternal;function getWaveTypeInternal(_0x4b634a){const _0xa371a4=_0x571912,_0x1eba63=(_0x4b634a-0x1)%0x4;switch(_0x1eba63){case 0x0:return _0xa371a4(0xd1);case 0x1:return _0xa371a4(0x149);case 0x2:return _0xa371a4(0x105);case 0x3:return _0xa371a4(0x157);default:return _0xa371a4(0xdf);}}window[_0x571912(0x18d)]=getWaveTypeInternal;function _0x5062(){const _0x36550a=['fillRect','Error\x20during\x20enemy\x20burst\x20firing\x20(bullet\x20','\x20not\x20found.','[scheduleEntranceFlightWave]\x20Called\x20inappropriately\x20or\x20with\x20no\x20definition.\x20Level\x20','Error\x20calculating\x20Normal\x20Bezier\x20point\x20for\x20enemy\x20','\x20attacking,\x20index\x20','velocityX','Error\x20updating\x20floating\x20scores:','CO-OP\x20GAME','rotation','string','main','.\x20Removing.','canFireThisDive','\x20after\x20bad\x20next\x20segment','warn','fillStyle','1322028aXOgGc','num','Error\x20starting\x20attack\x20for\x20','Error\x20checking/awarding\x20extra\x20life:','preparing_capture','CS3_DiveLoopL_Sharp','attackType','totalRotation','Error\x20updating\x20target\x20grid\x20pos\x20for\x20enemy\x20','.\x20Transitioning.','clearRect','\x20(state:\x20','\x20diving\x20to\x20capture\x20without\x20targetX/Y!\x20Aborting.','naturalHeight','preparing_attack','returnLogDone','entrance_flight_1','max','destroyed','CS_HorizontalFlyByL','Entrance\x20Wave:\x20Squadron\x20','returning','CS_LoopAttack_BL','Entrance\x20Wave:\x20Path\x20','restore','blue','Error\x20getting\x20grid\x20pos\x20within\x20\x27in_grid\x27\x20for\x20','toString','\x20missing\x20SHARED\x20path\x20','normal','entrance_flight_2','\x20after\x20bezier\x20error','left','),\x20index\x20','CS:\x20No\x20squadrons\x20generated.\x20Skipping\x20CS\x20sequence.','NORMAL\x20GAME','\x20destroyed,\x20had\x20ship\x20initially\x20but\x20dimensions\x20missing!\x20Resetting\x20state\x20anyway.','[DEBUG]\x20Error\x20generating\x20attack\x20path\x20for\x20enemy\x20','moving_to_grid','[handleEnemyHit]\x20CRITICAL:\x20Boss\x20destroyed,\x20had\x20ship\x20initially\x20but\x20dimensions\x20missing!',').\x20Skipping.','\x20path\x20index\x20','squadronId',',\x20Idx\x20','1P_VS_AI_COOP','Error\x20creating\x20player\x20bullet(s):','resultsMusicSound','rotationCompleted','showing_capture_message','Invalid\x20Normal\x20Bezier\x20segment\x20','\x20(invalid\x20attack\x20segment):','attackPathSegments','parse','Entrance\x20Wave:\x20Invalid\x20enemy\x20def\x20in\x20squadron\x20','1113864MGBubl','\x20(Path\x20','object','playerId','entranceSound','velocityY','initialCaptureAnimationY','\x20at\x20end\x20of\x20normal\x20path\x20','boss_loop_left','Full\x20Grid:\x20Invalid\x20enemy\x20def\x20in\x20squadron\x20','Invalid\x20next\x20Normal\x20Bezier\x20segment\x20','Error\x20updating\x20explosions:','shipCapturedSound','CS:\x20Error\x20during\x20enemy\x20spawn\x20execution\x20(Sq\x20','\x20points.\x20Health\x20was:\x20','\x20off\x20screen:','speed','[handleEnemyHit]\x20CRITICAL:\x20Boss\x20','Failed\x20to\x20return\x20to\x20menu\x20after\x20critical\x20error:','entrancePathId','capturedShipX','isPreparingForImmediateCapture','beeHitSound',',\x20isFullGrid:\x20','stopAllGameSounds','Boss\x20','green','landed','Error\x20calculating\x20CS\x20Bezier\x20point\x20for\x20enemy\x20','[Capture\x20Message\x20End]\x20Error\x20getting\x20grid\x20pos\x20for\x20returning\x20boss\x20','getWaveType','Entrance\x20Wave:\x20Assigned\x20entrance\x20path\x20\x22','following_bezier_path','FATAL\x20Error\x20in\x20moveEntities:','targetGridY','show_results','center','EASY','scheduledStartTime','round','capturedShipLastFiredTime','pathSegmentIndex','hiScoreSound','NORMAL','find','1UP','LOGO','filter','Invalid\x20next\x20CS\x20Bezier\x20segment\x20','Error\x20getting\x20grid\x20pos\x20after\x20invalid\x20NEXT\x20attack\x20segment\x20for\x20','isDamaged','health','butterflyDiveSound','shoot','\x20for\x20path\x20','now','waveUpSound','\x20in\x20moving_to_grid\x20state\x20without\x20target.\x20Recalculating.','naturalWidth','attack-','attackPathT','enemy-entr-','Error\x20getting\x20grid\x20pos\x20after\x20bezier\x20error\x20for\x20','captureSound','buttons','splice','pathId','sqrt','CS3_DiveLoopR_Sharp','pressed','Error\x20creating\x20CO-OP\x20AI\x20bullet\x20for\x20','creationTime','bossHit2Sound','\x20out\x20of\x20bounds\x20for\x20SHARED\x20path\x20','hasCapturedShip','sort','shipObj','substring','capturedShipDimensions','\x20not\x20found.\x20Enemy\x20will\x20follow\x20squadron\x20path\x20\x22','gridCol','CS:\x20Error\x20setting\x20up\x20spawns\x20for\x20squadron\x20','squadronEnemyIndex','findIndex','captureStartTime','width','A\x20critical\x20error\x20occurred\x20in\x20the\x20game\x20loop.\x20Please\x20refresh.','Error\x20getting\x20target\x20grid\x20pos\x20for\x20','hasFiredPostLanding','18HMLpPe','gridRow','FATAL\x20Error\x20in\x20moveEntities\x20(Restored\x20Conditions):',',\x20isCS:\x20','stringify','Full\x20Grid:\x20Squadron\x20','drawImage',',\x20index\x20','526975xtJabb','indexOf','getGamepads','enemy-cs-','right','error','pathSpeedMultiplier','switch_player','capturedShipY','coop',')\x20for\x20','rotationDirection','floor','in_grid','completed','type','\x20attacking\x20without\x20path!\x20Returning.','sin','white','currentLives','\x20for\x20squadron\x20','single','hasFired','Enemy\x20','lastFiredTime','alpha','\x20(invalid\x20attack\x20index):','landedTime','\x20in\x20returning','dual','CS_LoopAttack_TR','targetPlayerId','[scheduleSingleEntranceSquadron]\x20Called\x20inappropriately\x20for\x20non-entrance\x20wave\x20type\x20(Level\x20','thresholdsMet','\x20(no\x20attack\x20path):','pause','tintProgress','Error\x20getting\x20grid\x20pos\x20for\x20returning\x20enemy\x20','\x20has\x20invalid\x20enemy\x20data.','attackGroupId','30px\x20Arial','327506aWTwjP','.\x20Switching\x20to\x20moving_to_grid.','CRITICAL:\x20Required\x20CS\x20path\x20\x22','!\x20Returning.','Invalid\x20start\x20segment\x20for\x20path\x20','targetGridX','\x20at\x20[','14AkevMS','duration','CS_LoopAttack_BR','\x20in\x20moving_to_grid',',\x20Path\x20','resetGame','targetY','add','1439296vyAWUw','Invalid\x20start\x20segment\x20for\x20squadron\x20path\x20','cos','random','\x20after\x20bad\x20segment','stack','forEach','Error\x20getting\x20grid\x20pos\x20for\x20returning\x20boss\x20','gameOverSound','full_grid','push','following_entrance_path','Error\x20in\x20renderGame:','diving_to_capture_position','GAME\x20EXIT','back','isArray','save','attackFormationOffsetX',',\x20def\x20length:\x20','Error\x20getting\x20grid\x20pos\x20for\x20','some','1P_VS_AI_NORMAL','unknown','rapid','lifetime','complete','hasOwnProperty','.\x20Skipping.','HIGH\x20SCORE','pathT','levelUpSound','2\x20PLAYER','extraLifeSound','butterflyHitSound','attacking','total','ai_p2','playerNum','lostLifeSound','undefined','player2','captureAnimationRotation','115809Ubjyao','min','\x20attacking,\x20invalid\x20segment\x20','atan2','\x20is\x20empty\x20or\x20invalid.','justReturned','CS:\x20Path\x20',')!\x20Returning.','enemyShootSound','newButtonStates','Error\x20in\x20triggerImmediateCaptureDive:','slice',')\x20during\x20shift:','length','abs','\x20after\x20invalid\x20path\x20index','keys','dualShipSound','challenging_stage','state','targetX','\x20after\x20missing\x20path','size','playerShootSound','clear','player1','has','NaN\x20detected\x20in\x20CS\x20path\x20calculation\x20for\x20enemy\x20','enemies','sign','Error\x20calculating\x20FINAL\x20bezier\x20point\x20for\x20attack\x20','number','capturing','16647075baVgyg','Error\x20calculating\x20bezier\x20point\x20during\x20attack\x20for\x20','startSound','Full\x20Grid:\x20Error\x20getting\x20target\x20grid\x20pos\x20for\x20enemy\x20','Error\x20during\x20FIXED\x20enemy\x20burst\x20firing\x20(bullet\x20','attackPathSegmentIndex','NaN\x20detected\x20in\x20Normal\x20path\x20calculation\x20for\x20enemy\x20','map','gridBackgroundSound','Critical\x20error\x20during\x20entity\x20movement/collision.\x20Returning\x20to\x20menu.','bossGalagaDiveSound','function','height','explosionSound','Full\x20Grid:\x20Error\x20placing\x20enemy\x20(Sq\x20','capturePrepareTimeout','csClearSound','.\x20Enemy\x20','\x20attacking,\x20invalid\x20NEXT\x20segment\x20','diveStartTime'];_0x5062=function(){return _0x36550a;};return _0x5062();}function generateWaveDefinitionInternal(_0x5b0532){const _0x500cdc=_0x571912;let _0x274e80=[];currentWavePatternIndex=-0x1;const _0x5a54ff=getWaveTypeInternal(_0x5b0532);if(typeof waveEntrancePatterns===_0x500cdc(0xf0)||!Array['isArray'](waveEntrancePatterns)||waveEntrancePatterns[_0x500cdc(0x100)]<0x2)return[];if(_0x5a54ff==='challenging_stage')_0x274e80=[];else{if(_0x5a54ff===_0x500cdc(0xd1)){currentWavePatternIndex=0x0;const _0x9a22ae=waveEntrancePatterns[0x0];if(!_0x9a22ae||_0x9a22ae[_0x500cdc(0x100)]===0x0)_0x274e80=[];else try{_0x274e80=JSON[_0x500cdc(0x16d)](JSON[_0x500cdc(0x8c)](_0x9a22ae),(_0x390bde,_0x2c0f9e)=>{const _0x239197=_0x500cdc;return _0x2c0f9e&&typeof _0x2c0f9e==='object'&&_0x2c0f9e['type']===ENEMY3_TYPE&&typeof _0x2c0f9e[_0x239197(0x1b9)]==='undefined'&&(_0x2c0f9e[_0x239197(0x1b9)]=![]),_0x2c0f9e;});}catch(_0x161d86){_0x274e80=[];}}else{if(_0x5a54ff===_0x500cdc(0x149)){currentWavePatternIndex=0x0;const _0xf1cc47=waveEntrancePatterns[0x0];if(!_0xf1cc47||_0xf1cc47[_0x500cdc(0x100)]===0x0)_0x274e80=[];else try{_0x274e80=JSON[_0x500cdc(0x16d)](JSON[_0x500cdc(0x8c)](_0xf1cc47),(_0x9de1d1,_0x4ab619)=>{const _0xbe44ff=_0x500cdc;return _0x4ab619&&typeof _0x4ab619==='object'&&_0x4ab619['type']===ENEMY3_TYPE&&typeof _0x4ab619[_0xbe44ff(0x1b9)]===_0xbe44ff(0xf0)&&(_0x4ab619[_0xbe44ff(0x1b9)]=![]),_0x4ab619;});}catch(_0x50f60d){_0x274e80=[];}}else{if(_0x5a54ff==='entrance_flight_2'){currentWavePatternIndex=0x1;const _0x140dd4=waveEntrancePatterns[0x1];if(!_0x140dd4||_0x140dd4['length']===0x0)_0x274e80=[];else try{_0x274e80=JSON[_0x500cdc(0x16d)](JSON[_0x500cdc(0x8c)](_0x140dd4),(_0x332a53,_0x3d8791)=>{const _0x248b0d=_0x500cdc;return _0x3d8791&&typeof _0x3d8791===_0x248b0d(0x171)&&_0x3d8791['type']===ENEMY3_TYPE&&typeof _0x3d8791['hasCapturedShip']===_0x248b0d(0xf0)&&(_0x3d8791[_0x248b0d(0x1b9)]=![]),_0x3d8791;});}catch(_0x3ba112){_0x274e80=[];}}else _0x274e80=[];}}}if(_0x5a54ff!=='challenging_stage'){if(typeof normalWaveEntrancePaths===_0x500cdc(0xf0)||Object[_0x500cdc(0x103)](normalWaveEntrancePaths)[_0x500cdc(0x100)]===0x0)return _0x274e80;for(let _0x5b0dc1=_0x274e80['length']-0x1;_0x5b0dc1>=0x0;_0x5b0dc1--){const _0x3a8ed8=_0x274e80[_0x5b0dc1];if(!normalWaveEntrancePaths?.[_0x3a8ed8['pathId']]){_0x274e80['splice'](_0x5b0dc1,0x1);continue;}if(_0x3a8ed8[_0x500cdc(0x10f)]&&Array[_0x500cdc(0xd8)](_0x3a8ed8[_0x500cdc(0x10f)])){for(let _0x114fef=_0x3a8ed8['enemies'][_0x500cdc(0x100)]-0x1;_0x114fef>=0x0;_0x114fef--){const _0x2e48e4=_0x3a8ed8[_0x500cdc(0x10f)][_0x114fef];(!_0x2e48e4||!normalWaveEntrancePaths?.[_0x2e48e4[_0x500cdc(0x182)]])&&_0x3a8ed8['enemies']['splice'](_0x114fef,0x1),_0x2e48e4&&_0x2e48e4[_0x500cdc(0x9f)]===ENEMY3_TYPE&&typeof _0x2e48e4['hasCapturedShip']===_0x500cdc(0xf0)&&(_0x2e48e4[_0x500cdc(0x1b9)]=![]);}_0x3a8ed8[_0x500cdc(0x10f)][_0x500cdc(0x100)]===0x0&&_0x274e80[_0x500cdc(0x1b0)](_0x5b0dc1,0x1);}else _0x274e80[_0x500cdc(0x1b0)](_0x5b0dc1,0x1);}}return _0x274e80;}window['generateWaveDefinition']=generateWaveDefinitionInternal;const createBulletSimple=(_0x149219,_0x50abd9=null)=>{const _0xa5ee98=_0x571912;let _0x452ce9=null,_0x3030e6=![];if(isTwoPlayerMode&&selectedGameMode===_0xa5ee98(0x99)){const _0x16d012=ship1&&player1Lives>0x0&&!isPlayer1WaitingForRespawn&&!isPlayer1ShipCaptured,_0x47e829=ship2&&player2Lives>0x0&&!isPlayer2WaitingForRespawn&&!isPlayer2ShipCaptured;if(_0x16d012&&_0x47e829)_0x452ce9=Math[_0xa5ee98(0xcb)]()<0.5?ship1:ship2,_0x3030e6=!![];else{if(_0x16d012)_0x452ce9=ship1,_0x3030e6=!![];else _0x47e829&&(_0x452ce9=ship2,_0x3030e6=!![]);}}else ship&&playerLives>0x0&&!isShipCaptured&&!isWaitingForRespawn&&(_0x452ce9=ship,_0x3030e6=!![]);if(!_0x149219||!isInGameState||!_0x3030e6||!_0x452ce9)return![];const _0x4ef436=scaleValue(level,BASE_ENEMY_BULLET_SPEED,MAX_ENEMY_BULLET_SPEED),_0x2cd40e=_0x50abd9?_0x50abd9['x']:_0x149219['x']+_0x149219[_0xa5ee98(0x1c4)]/0x2,_0x920145=_0x50abd9?_0x50abd9['y']:_0x149219['y']+_0x149219[_0xa5ee98(0x120)]/0x2;let _0x39d807=0x0,_0x2987f4=_0x4ef436;const _0x4aaae7=_0x452ce9['x']+_0x452ce9[_0xa5ee98(0x1c4)]/0x2-_0x2cd40e,_0xfc25d6=_0x452ce9['y']+_0x452ce9[_0xa5ee98(0x120)]/0x2-_0x920145,_0x3b9451=Math[_0xa5ee98(0x1b2)](_0x4aaae7*_0x4aaae7+_0xfc25d6*_0xfc25d6);if(_0x3b9451>0x0){let _0x4890a7=0x0;!isChallengingStage&&(_0x4890a7=scaleValue(level,BASE_ENEMY_AIM_FACTOR,MAX_ENEMY_AIM_FACTOR));let _0x439904=Math[_0xa5ee98(0xf6)](_0xfc25d6,_0x4aaae7);_0x39d807=Math[_0xa5ee98(0xca)](_0x439904)*_0x4ef436*_0x4890a7,_0x2987f4=Math[_0xa5ee98(0x1b2)](_0x4ef436**0x2-_0x39d807**0x2),_0x2987f4=Math[_0xa5ee98(0x14a)](_0x4ef436*(0x1-_0x4890a7)*0.5,_0x2987f4);if(_0xfc25d6<0x0&&_0x2987f4>0x0){}if(_0xfc25d6<0x0)_0x2987f4=Math[_0xa5ee98(0x101)](_0x2987f4);return enemyBullets['push']({'x':_0x2cd40e-ENEMY_BULLET_WIDTH/0x2,'y':_0x920145,'width':ENEMY_BULLET_WIDTH,'height':ENEMY_BULLET_HEIGHT,'vx':_0x39d807,'vy':_0x2987f4,'type':_0x149219['type']}),!![];}return![];};function scheduleSingleEntranceSquadron(_0x33f0d0,_0x34e819,_0x52f905){const _0x5ab51d=_0x571912;if(isFullGridWave||isChallengingStage)return console[_0x5ab51d(0x137)](_0x5ab51d(0xb0)+level+',\x20isFullGrid:\x20'+isFullGridWave+_0x5ab51d(0x1cb)+isChallengingStage+_0x5ab51d(0x161)),_0x33f0d0?.[_0x5ab51d(0x10f)]?.[_0x5ab51d(0x100)]>0x0&&(enemiesSpawnedThisWave+=_0x33f0d0[_0x5ab51d(0x10f)][_0x5ab51d(0x100)],squadronCompletionStatus[_0x34e819]&&(squadronCompletionStatus[_0x34e819][_0x5ab51d(0x9e)]=squadronCompletionStatus[_0x34e819][_0x5ab51d(0xec)])),![];const _0x13d628=normalWaveEntrancePaths,_0x2b6f0f=_0x33f0d0[_0x5ab51d(0x1b1)],_0x5ed596=_0x13d628[_0x2b6f0f];if(!_0x5ed596||_0x5ed596['length']===0x0)return console['error'](_0x5ab51d(0x150)+_0x2b6f0f+'\x20for\x20squadron\x20'+_0x34e819+'\x20invalid!\x20Skipping\x20squadron.'),_0x33f0d0?.[_0x5ab51d(0x10f)]?.[_0x5ab51d(0x100)]>0x0&&(enemiesSpawnedThisWave+=_0x33f0d0[_0x5ab51d(0x10f)]['length'],squadronCompletionStatus[_0x34e819]&&(squadronCompletionStatus[_0x34e819][_0x5ab51d(0x9e)]=squadronCompletionStatus[_0x34e819]['total'])),![];const _0x4ff396=setTimeout(()=>{const _0x3ca5fa=_0x5ab51d,_0x313c5f=enemySpawnTimeouts[_0x3ca5fa(0x91)](_0x4ff396);if(_0x313c5f>-0x1)enemySpawnTimeouts[_0x3ca5fa(0x1b0)](_0x313c5f,0x1);let _0x20e328=![];isTwoPlayerMode&&selectedGameMode===_0x3ca5fa(0x99)?_0x20e328=player1Lives>0x0&&!isPlayer1ShipCaptured||player2Lives>0x0&&!isPlayer2ShipCaptured:_0x20e328=playerLives>0x0&&!isShipCaptured;if(isPaused||!isInGameState||!isEntrancePhaseActive||isChallengingStage||isWaveTransitioning||!_0x20e328||isFullGridWave){_0x33f0d0?.[_0x3ca5fa(0x10f)]?.['length']>0x0&&(enemiesSpawnedThisWave+=_0x33f0d0[_0x3ca5fa(0x10f)][_0x3ca5fa(0x100)],squadronCompletionStatus[_0x34e819]&&(squadronCompletionStatus[_0x34e819][_0x3ca5fa(0x9e)]=squadronCompletionStatus[_0x34e819][_0x3ca5fa(0xec)]));return;}try{squadronEntranceFiringStatus[_0x34e819]?(squadronEntranceFiringStatus[_0x34e819][_0x3ca5fa(0x195)]=Date['now']()+_0x52f905,squadronEntranceFiringStatus[_0x34e819][_0x3ca5fa(0xa6)]=![]):(console[_0x3ca5fa(0x137)]('[scheduleSingleEntranceSquadron]\x20Firing\x20status\x20for\x20squadron\x20'+_0x34e819+_0x3ca5fa(0x12a)),squadronEntranceFiringStatus[_0x34e819]={'hasFired':![],'scheduledStartTime':Date['now']()+_0x52f905});const _0xe0b6e3=ENEMY_SPAWN_DELAY_IN_SQUADRON,_0x6dd024=_0xe0b6e3*0x2,_0x303f7e=0x1;_0x33f0d0[_0x3ca5fa(0x10f)][_0x3ca5fa(0xce)]((_0x11a808,_0x4e6a1a)=>{const _0x5511ed=_0x3ca5fa;if(!_0x11a808||!_0x11a808[_0x5511ed(0x9f)]||typeof _0x11a808[_0x5511ed(0x1c9)]===_0x5511ed(0xf0)||typeof _0x11a808['gridCol']==='undefined'||!_0x11a808['entrancePathId']){console[_0x5511ed(0x95)](_0x5511ed(0x16e)+_0x34e819+_0x5511ed(0x170)+_0x2b6f0f+_0x5511ed(0x15a)+_0x4e6a1a+_0x5511ed(0xe4)),enemiesSpawnedThisWave++;squadronCompletionStatus[_0x34e819]&&squadronCompletionStatus[_0x34e819][_0x5511ed(0x9e)]++;return;}const _0x41933b=_0x13d628[_0x11a808[_0x5511ed(0x182)]];(!_0x41933b||_0x41933b[_0x5511ed(0x100)]===0x0)&&console[_0x5511ed(0x137)](_0x5511ed(0x18e)+_0x11a808[_0x5511ed(0x182)]+'\x22\x20for\x20enemy\x20in\x20squadron\x20'+_0x34e819+',\x20index\x20'+_0x4e6a1a+_0x5511ed(0x1be)+_0x2b6f0f+'\x22.');let _0x21eaef=0x0;const _0x3a69c6=getWaveType(level),_0x4a41da=_0x3a69c6===_0x5511ed(0x157)&&(_0x34e819===0x2||_0x34e819===0x3);if(_0x4a41da){const _0x4d7d0c=Math[_0x5511ed(0x9c)](_0x4e6a1a/0x2);_0x4e6a1a%0x2===0x0?_0x21eaef=_0x4d7d0c*_0x6dd024:_0x21eaef=_0x4d7d0c*_0x6dd024+_0x303f7e;}else _0x21eaef=_0x4e6a1a*ENEMY_SPAWN_DELAY_IN_SQUADRON;const _0x455f36=setTimeout(()=>{const _0x19508b=_0x5511ed,_0x2843ab=enemySpawnTimeouts[_0x19508b(0x91)](_0x455f36);if(_0x2843ab>-0x1)enemySpawnTimeouts[_0x19508b(0x1b0)](_0x2843ab,0x1);let _0x3f1fcf=![];isTwoPlayerMode&&selectedGameMode==='coop'?_0x3f1fcf=player1Lives>0x0&&!isPlayer1ShipCaptured||player2Lives>0x0&&!isPlayer2ShipCaptured:_0x3f1fcf=playerLives>0x0&&!isShipCaptured;if(isPaused||!isInGameState||!isEntrancePhaseActive||isChallengingStage||isWaveTransitioning||!_0x3f1fcf||isFullGridWave){enemiesSpawnedThisWave++;squadronCompletionStatus[_0x34e819]&&squadronCompletionStatus[_0x34e819]['completed']++;return;}try{let _0x19cf87=_0x11a808['type'],_0x1dfb71=_0x19cf87===ENEMY3_TYPE?ENEMY3_MAX_HITS:0x1,_0x54b3fa,_0x426206;if(_0x19cf87===ENEMY1_TYPE)_0x54b3fa=ENEMY1_WIDTH,_0x426206=ENEMY1_HEIGHT;else _0x19cf87===ENEMY3_TYPE?(_0x54b3fa=BOSS_WIDTH,_0x426206=BOSS_HEIGHT):(_0x54b3fa=ENEMY_WIDTH,_0x426206=ENEMY_HEIGHT);let _0x4e0973=0x0,_0x4df54=0x0;if(_0x5ed596&&_0x5ed596[0x0]?.['p0'])_0x4e0973=_0x5ed596[0x0]['p0']['x'],_0x4df54=_0x5ed596[0x0]['p0']['y'];else throw new Error(_0x19508b(0xc9)+_0x2b6f0f);let _0x352a68,_0x8c28f;try{const {x:_0x43ff49,y:_0x36f6c5}=getCurrentGridSlotPosition(_0x11a808[_0x19508b(0x1c9)],_0x11a808[_0x19508b(0x1bf)],_0x54b3fa);_0x352a68=_0x43ff49,_0x8c28f=_0x36f6c5;}catch(_0x5b3aa4){console[_0x19508b(0x95)]('Error\x20getting\x20target\x20grid\x20pos\x20for\x20new\x20enemy\x20'+_0x11a808['type']+'\x20at\x20['+_0x11a808[_0x19508b(0x1c9)]+','+_0x11a808['gridCol']+']',_0x5b3aa4),_0x352a68=gameCanvas?.['width']/0x2||0xc8,_0x8c28f=ENEMY_TOP_MARGIN+_0x11a808[_0x19508b(0x1c9)]*(ENEMY_HEIGHT+ENEMY_V_SPACING);}let _0x3afe37=0x0;const _0x5c0bb1=_0x4a41da,_0x33a671=_0x5c0bb1&&_0x4e6a1a%0x2!==0x0;_0x33a671?_0x3afe37=-ENTRANCE_PAIR_PATH_T_OFFSET:_0x3afe37=-_0x4e6a1a*PATH_T_OFFSET_PER_ENEMY;const _0x313cf4={'x':_0x4e0973,'y':_0x4df54,'width':_0x54b3fa,'height':_0x426206,'targetGridX':_0x352a68,'targetGridY':_0x8c28f,'speed':0x0,'state':_0x19508b(0xd3),'gridRow':_0x11a808[_0x19508b(0x1c9)],'gridCol':_0x11a808[_0x19508b(0x1bf)],'type':_0x19cf87,'health':_0x1dfb71,'isDamaged':![],'velocityX':0x0,'velocityY':0x0,'attackPathStep':0x0,'initialY':0x0,'initialX':0x0,'diveDirection':0x1,'lastFiredTime':0x0,'targetX1':0x0,'targetY1':0x0,'targetX2':0x0,'targetY2':0x0,'targetX3':0x0,'targetY3':0x0,'attackPathSegments':[],'attackPathSegmentIndex':0x0,'attackPathT':0x0,'attackStartTime':0x0,'attackFormationOffsetX':0x0,'attackGroupId':null,'entrancePathId':_0x2b6f0f,'pathSegmentIndex':0x0,'pathT':_0x3afe37,'squadronId':_0x34e819,'squadronEnemyIndex':_0x4e6a1a,'id':_0x19508b(0x1ac)+_0x34e819+'-'+_0x4e6a1a+'-'+Date[_0x19508b(0x1a6)]()+'-'+Math[_0x19508b(0xcb)]()[_0x19508b(0x154)](0x24)['substring'](0x2,0x7),'justReturned':![],'canFireThisDive':![],'attackType':_0x19508b(0x156),'hasCapturedShip':_0x19cf87===ENEMY3_TYPE?![]:undefined,'capturedShipX':undefined,'capturedShipY':undefined,'capturedShipLastFiredTime':_0x19cf87===ENEMY3_TYPE?0x0:undefined,'captureStartTime':0x0,'capturePrepareTimeout':null,'pathSpeedMultiplier':0x1};enemies[_0x19508b(0xd2)](_0x313cf4),enemiesSpawnedThisWave++;squadronCompletionStatus[_0x34e819]&&squadronCompletionStatus[_0x34e819]['completed']++;if(_0x4e6a1a===0x0){let _0x199a34=0x5dc;(_0x34e819===0x0||_0x34e819===0x1)&&(_0x199a34=0xfa);const _0x4e675c=_0x313cf4['id'],_0x1a155a=setTimeout(()=>{const _0xe969e=_0x19508b,_0x2b922f=enemySpawnTimeouts[_0xe969e(0x91)](_0x1a155a);if(_0x2b922f>-0x1)enemySpawnTimeouts[_0xe969e(0x1b0)](_0x2b922f,0x1);let _0x542791=![];isTwoPlayerMode&&selectedGameMode==='coop'?_0x542791=player1Lives>0x0&&!isPlayer1ShipCaptured||player2Lives>0x0&&!isPlayer2ShipCaptured:_0x542791=playerLives>0x0&&!isShipCaptured;if(isPaused||!isInGameState||!_0x542791||isChallengingStage||isWaveTransitioning||isFullGridWave)return;fireFixedEnemyBurst(_0x4e675c,null,0x0,0x3);},_0x199a34);enemySpawnTimeouts['push'](_0x1a155a);}}catch(_0x3c455a){console['error']('Entrance\x20Wave:\x20Error\x20during\x20enemy\x20spawn\x20execution\x20(Sq\x20'+_0x34e819+_0x19508b(0x164)+_0x4e6a1a+_0x19508b(0xc4)+_0x2b6f0f+'):',_0x3c455a),enemiesSpawnedThisWave++,squadronCompletionStatus[_0x34e819]&&squadronCompletionStatus[_0x34e819]['completed']++;}},_0x21eaef);enemySpawnTimeouts[_0x5511ed(0xd2)](_0x455f36);});}catch(_0x17aa92){console[_0x3ca5fa(0x95)]('Entrance\x20Wave:\x20Error\x20processing\x20enemies\x20for\x20squadron\x20'+_0x34e819+_0x3ca5fa(0x170)+_0x2b6f0f+'):',_0x17aa92),_0x33f0d0?.[_0x3ca5fa(0x10f)]?.[_0x3ca5fa(0x100)]>0x0&&(enemiesSpawnedThisWave+=_0x33f0d0[_0x3ca5fa(0x10f)][_0x3ca5fa(0x100)],squadronCompletionStatus[_0x34e819]&&(squadronCompletionStatus[_0x34e819][_0x3ca5fa(0x9e)]=squadronCompletionStatus[_0x34e819][_0x3ca5fa(0xec)]));}},_0x52f905);return enemySpawnTimeouts[_0x5ab51d(0xd2)](_0x4ff396),!![];};function scheduleEntranceFlightWave(){const _0x32d084=_0x571912;if(isFullGridWave||isChallengingStage||!currentWaveDefinition||currentWaveDefinition[_0x32d084(0x100)]===0x0){console['warn'](_0x32d084(0x12b)+level+_0x32d084(0x186)+isFullGridWave+_0x32d084(0x1cb)+isChallengingStage+_0x32d084(0xdb)+currentWaveDefinition?.[_0x32d084(0x100)]),isEntrancePhaseActive=![],isWaveTransitioning=!![],readyForNextWaveReset=!![];return;}enemySpawnTimeouts[_0x32d084(0xce)](clearTimeout),enemySpawnTimeouts=[],totalEnemiesScheduledForWave=0x0,enemiesSpawnedThisWave=0x0,squadronCompletionStatus={},squadronEntranceFiringStatus={};let _0x5d0a1c=0x0,_0x4c225a=0x0;currentWaveDefinition['forEach']((_0x7b11a0,_0x35a6a0)=>{const _0x1e80b4=_0x32d084;_0x7b11a0&&_0x7b11a0['enemies']&&Array[_0x1e80b4(0xd8)](_0x7b11a0[_0x1e80b4(0x10f)])&&_0x7b11a0[_0x1e80b4(0x10f)][_0x1e80b4(0x100)]>0x0?(totalEnemiesScheduledForWave+=_0x7b11a0[_0x1e80b4(0x10f)][_0x1e80b4(0x100)],squadronCompletionStatus[_0x35a6a0]={'completed':0x0,'total':_0x7b11a0['enemies'][_0x1e80b4(0x100)],'hasFiredPostLanding':![]},squadronEntranceFiringStatus[_0x35a6a0]={'hasFired':![],'scheduledStartTime':0x0},scheduleSingleEntranceSquadron(_0x7b11a0,_0x35a6a0,_0x5d0a1c)&&_0x4c225a++,_0x5d0a1c+=NORMAL_WAVE_SQUADRON_INTERVAL):console[_0x1e80b4(0x137)](_0x1e80b4(0x14d)+_0x35a6a0+_0x1e80b4(0xf7));}),_0x4c225a===0x0&&totalEnemiesScheduledForWave===0x0?(console[_0x32d084(0x137)]('Entrance\x20Wave:\x20No\x20squadrons\x20or\x20enemies\x20scheduled\x20for\x20level\x20'+level+_0x32d084(0x142)),isEntrancePhaseActive=![],isWaveTransitioning=!![],readyForNextWaveReset=!![]):isEntrancePhaseActive=!![];}function startChallengingStageSequence(){const _0x46beaa=_0x571912;currentWaveDefinition=[],isEntrancePhaseActive=![],enemySpawnTimeouts['forEach'](clearTimeout),enemySpawnTimeouts=[],totalEnemiesScheduledForWave=0x0,enemiesSpawnedThisWave=0x0,squadronEntranceFiringStatus={};Object[_0x46beaa(0x103)](challengingStagePaths)['length']===0x0&&defineChallengingStagePaths();if(Object[_0x46beaa(0x103)](challengingStagePaths)[_0x46beaa(0x100)]===0x0){console[_0x46beaa(0x95)]('CRITICAL:\x20Failed\x20to\x20define\x20CS\x20paths!'),isWaveTransitioning=!![],setTimeout(()=>{const _0x38a280=_0x46beaa;(isInGameState||!isInGameState&&(isTwoPlayerMode&&selectedGameMode==='coop'&&(player1Lives>0x0||player2Lives>0x0)||!isTwoPlayerMode&&playerLives>0x0))&&typeof resetWave===_0x38a280(0x11f)&&resetWave();},NEXT_WAVE_DELAY_AFTER_MESSAGE);return;}const _0x23eb3d=[_0x46beaa(0x13e),_0x46beaa(0x1b3),_0x46beaa(0x14c),'CS_HorizontalFlyByR'],_0x35da40=['CS_LoopAttack_TL',_0x46beaa(0xae),_0x46beaa(0x14f),_0x46beaa(0xc2)],_0x45eea4=[..._0x23eb3d,..._0x35da40];for(const _0x4ac99f of _0x45eea4){if(!challengingStagePaths[_0x46beaa(0xe3)](_0x4ac99f)){console[_0x46beaa(0x95)](_0x46beaa(0xbb)+_0x4ac99f+'\x22\x20not\x20found!\x20Aborting\x20CS.'),isWaveTransitioning=!![],setTimeout(()=>{const _0x5e510e=_0x46beaa;(isInGameState||!isInGameState&&(isTwoPlayerMode&&selectedGameMode===_0x5e510e(0x99)&&(player1Lives>0x0||player2Lives>0x0)||!isTwoPlayerMode&&playerLives>0x0))&&typeof resetWave===_0x5e510e(0x11f)&&resetWave();},NEXT_WAVE_DELAY_AFTER_MESSAGE);return;}}let _0x389667=[..._0x23eb3d],_0x232202=[..._0x35da40][_0x46beaa(0x1ba)](()=>Math[_0x46beaa(0xcb)]()-0.5);_0x389667['push'](..._0x232202),currentWaveDefinition=[];for(let _0x190a17=0x0;_0x190a17<CHALLENGING_STAGE_SQUADRON_COUNT;_0x190a17++){const _0x1ca192=_0x389667[_0x190a17],_0x631a6e={'pathId':_0x1ca192,'enemies':[]};for(let _0x12463c=0x0;_0x12463c<CHALLENGING_STAGE_SQUADRON_SIZE;_0x12463c++){let _0x52058e=_0x12463c<Math[_0x46beaa(0x9c)](CHALLENGING_STAGE_SQUADRON_SIZE/0x2)?ENEMY1_TYPE:ENEMY2_TYPE;_0x631a6e[_0x46beaa(0x10f)]['push']({'type':_0x52058e,'entrancePathId':_0x1ca192});}currentWaveDefinition[_0x46beaa(0xd2)](_0x631a6e);}challengingStageTotalEnemies=CHALLENGING_STAGE_ENEMY_COUNT,totalEnemiesScheduledForWave=challengingStageTotalEnemies,enemiesSpawnedThisWave=0x0;if(currentWaveDefinition[_0x46beaa(0x100)]>0x0){isEntrancePhaseActive=!![],enemySpawnTimeouts=[];let _0x126664=0x0;const _0x19dabb=-0x1c,_0x294e11=Math['floor'](Math['max'](0x0,level-0x3)/0x4)+0x1,_0x4f0caf=scaleValue(_0x294e11,BASE_CS_SPEED_MULTIPLIER,MAX_CS_SPEED_MULTIPLIER);currentWaveDefinition['forEach']((_0x33cd9b,_0x307547)=>{const _0xc197db=_0x46beaa;let _0x4f555a=0x0;if(_0x307547<=0x1)_0x4f555a=0x0;else _0x307547<=0x3?_0x4f555a=CHALLENGING_STAGE_SQUADRON_INTERVAL:_0x4f555a=(_0x307547-0x2)*CHALLENGING_STAGE_SQUADRON_INTERVAL;let _0x2ffed2=_0x4f0caf;(_0x307547===0x2||_0x307547===0x3)&&(_0x2ffed2*=CS_HORIZONTAL_FLYBY_SPEED_FACTOR);const _0x405aea=setTimeout(()=>{const _0x2ffd4f=_0x377a,_0x4c326d=enemySpawnTimeouts[_0x2ffd4f(0x91)](_0x405aea);if(_0x4c326d>-0x1)enemySpawnTimeouts[_0x2ffd4f(0x1b0)](_0x4c326d,0x1);let _0x1caf4c=![];isTwoPlayerMode&&selectedGameMode===_0x2ffd4f(0x99)?_0x1caf4c=player1Lives>0x0||player2Lives>0x0:_0x1caf4c=playerLives>0x0;if(!isPaused&&isInGameState&&isEntrancePhaseActive&&isChallengingStage&&!isWaveTransitioning&&_0x1caf4c)try{const _0x4f1f3f=_0x33cd9b[_0x2ffd4f(0x1b1)],_0x198b85=challengingStagePaths,_0x5817c0=_0x198b85[_0x4f1f3f];if(!_0x5817c0||_0x5817c0['length']===0x0){console[_0x2ffd4f(0x95)](_0x2ffd4f(0xf9)+_0x4f1f3f+_0x2ffd4f(0xa4)+_0x307547+'\x20invalid!\x20Skipping.'),enemiesSpawnedThisWave+=_0x33cd9b[_0x2ffd4f(0x10f)][_0x2ffd4f(0x100)];return;}let _0x3fbc83=CS_ENEMY_SPAWN_DELAY_IN_SQUADRON;if(_0x307547>=0x2&&_0x307547<=0x3)_0x3fbc83=CS_HORIZONTAL_FLYBY_SPAWN_DELAY;else _0x307547>=0x4&&(_0x3fbc83=CS_LOOP_ATTACK_SPAWN_DELAY);_0x33cd9b[_0x2ffd4f(0x10f)][_0x2ffd4f(0xce)]((_0x5ca0c9,_0x1bb46d)=>{const _0x7ce359=_0x2ffd4f;if(!_0x5ca0c9||!_0x5ca0c9[_0x7ce359(0x9f)]){console[_0x7ce359(0x95)]('CS:\x20Invalid\x20enemy\x20def\x20in\x20squadron\x20'+_0x307547+_0x7ce359(0x8f)+_0x1bb46d+_0x7ce359(0xe4)),enemiesSpawnedThisWave++;return;}const _0xd8b519=_0x1bb46d*_0x3fbc83,_0x5a9077=setTimeout(()=>{const _0x43ba93=_0x7ce359,_0x4f5470=enemySpawnTimeouts[_0x43ba93(0x91)](_0x5a9077);if(_0x4f5470>-0x1)enemySpawnTimeouts[_0x43ba93(0x1b0)](_0x4f5470,0x1);let _0x5beb08=![];isTwoPlayerMode&&selectedGameMode===_0x43ba93(0x99)?_0x5beb08=player1Lives>0x0||player2Lives>0x0:_0x5beb08=playerLives>0x0;if(isPaused||!isInGameState||!isEntrancePhaseActive||!isChallengingStage||isWaveTransitioning||!_0x5beb08){enemiesSpawnedThisWave++;return;}try{let _0xe8bb43=_0x5ca0c9[_0x43ba93(0x9f)],_0x2953c6=_0xe8bb43===ENEMY3_TYPE?ENEMY3_MAX_HITS:0x1,_0x1d23c5,_0x2be362;if(_0xe8bb43===ENEMY1_TYPE)_0x1d23c5=ENEMY1_WIDTH,_0x2be362=ENEMY1_HEIGHT;else _0xe8bb43===ENEMY3_TYPE?(_0x1d23c5=BOSS_WIDTH,_0x2be362=BOSS_HEIGHT):(_0x1d23c5=ENEMY_WIDTH,_0x2be362=ENEMY_HEIGHT);let _0x49a20e=0x0,_0x372848=0x0;if(_0x5817c0[0x0]?.['p0'])_0x49a20e=_0x5817c0[0x0]['p0']['x'],_0x372848=_0x5817c0[0x0]['p0']['y'];else throw new Error(_0x43ba93(0xbd)+_0x4f1f3f);(_0x307547===0x0||_0x307547===0x1)&&(_0x49a20e+=_0x19dabb);const _0x249d46=-_0x1bb46d*PATH_T_OFFSET_PER_ENEMY,_0x3196f2={'x':_0x49a20e,'y':_0x372848,'width':_0x1d23c5,'height':_0x2be362,'targetGridX':0x0,'targetGridY':0x0,'speed':0x0,'state':_0x43ba93(0x18f),'gridRow':-0x1,'gridCol':-0x1,'type':_0xe8bb43,'health':_0x2953c6,'isDamaged':![],'velocityX':0x0,'velocityY':0x0,'attackPathStep':0x0,'initialY':0x0,'initialX':0x0,'diveDirection':0x1,'lastFiredTime':0x0,'targetX1':0x0,'targetY1':0x0,'targetX2':0x0,'targetY2':0x0,'targetX3':0x0,'targetY3':0x0,'attackPathSegments':[],'attackPathSegmentIndex':0x0,'attackPathT':0x0,'attackStartTime':0x0,'attackFormationOffsetX':0x0,'attackGroupId':null,'entrancePathId':_0x4f1f3f,'pathSegmentIndex':0x0,'pathT':_0x249d46,'squadronId':_0x307547,'id':_0x43ba93(0x93)+_0x307547+'-'+_0x1bb46d+'-'+Date[_0x43ba93(0x1a6)]()+'-'+Math[_0x43ba93(0xcb)]()[_0x43ba93(0x154)](0x24)[_0x43ba93(0x1bc)](0x2,0x7),'justReturned':![],'canFireThisDive':![],'attackType':_0x43ba93(0x156),'hasCapturedShip':_0xe8bb43===ENEMY3_TYPE?![]:undefined,'capturedShipX':undefined,'capturedShipY':undefined,'capturedShipLastFiredTime':_0xe8bb43===ENEMY3_TYPE?0x0:undefined,'captureStartTime':0x0,'capturePrepareTimeout':null,'pathSpeedMultiplier':_0x2ffed2};enemies[_0x43ba93(0xd2)](_0x3196f2),enemiesSpawnedThisWave++;}catch(_0xea1eb6){console['error'](_0x43ba93(0x17c)+_0x307547+_0x43ba93(0x164)+_0x1bb46d+_0x43ba93(0xc4)+_0x4f1f3f+'):',_0xea1eb6),enemiesSpawnedThisWave++;}},_0xd8b519);enemySpawnTimeouts[_0x7ce359(0xd2)](_0x5a9077),_0x126664++;});}catch(_0x4d60da){console[_0x2ffd4f(0x95)](_0x2ffd4f(0x1c0)+_0x307547+':',_0x4d60da),enemiesSpawnedThisWave+=_0x33cd9b[_0x2ffd4f(0x10f)]['length'];}else _0x33cd9b?.[_0x2ffd4f(0x10f)]?.['length']>0x0&&(enemiesSpawnedThisWave+=_0x33cd9b[_0x2ffd4f(0x10f)][_0x2ffd4f(0x100)]);},_0x4f555a);enemySpawnTimeouts[_0xc197db(0xd2)](_0x405aea);});}else console[_0x46beaa(0x137)](_0x46beaa(0x15b)),isWaveTransitioning=!![],setTimeout(()=>{const _0x14811a=_0x46beaa;(isInGameState||!isInGameState&&(isTwoPlayerMode&&selectedGameMode==='coop'&&(player1Lives>0x0||player2Lives>0x0)||!isTwoPlayerMode&&playerLives>0x0))&&typeof resetWave===_0x14811a(0x11f)&&resetWave();},NEXT_WAVE_DELAY_AFTER_MESSAGE);}function fireEnemyBurst(_0x20a0a9,_0x148965,_0x1f35ec){const _0x3710d8=_0x571912;let _0xa9aec3=![];isTwoPlayerMode&&selectedGameMode===_0x3710d8(0x99)?_0xa9aec3=player1Lives>0x0&&!isPlayer1ShipCaptured||player2Lives>0x0&&!isPlayer2ShipCaptured:_0xa9aec3=playerLives>0x0&&!isShipCaptured;if(!_0x20a0a9||isPaused||!isInGameState||!_0xa9aec3||isChallengingStage||isWaveTransitioning)return;const _0x430eb8=Math['round'](scaleValue(level,BASE_ENEMY_BULLET_BURST_COUNT,MAX_ENEMY_BULLET_BURST_COUNT));for(let _0xbbedb4=0x0;_0xbbedb4<_0x430eb8;_0xbbedb4++){const _0x5b716d=_0x1f35ec+_0xbbedb4*ENTRANCE_FIRE_BURST_DELAY_MS,_0x934346=setTimeout(()=>{const _0x8e1b5e=_0x3710d8;try{const _0x2e51e0=enemySpawnTimeouts['indexOf'](_0x934346);_0x2e51e0>-0x1&&enemySpawnTimeouts[_0x8e1b5e(0x1b0)](_0x2e51e0,0x1);let _0x51d16f=![];isTwoPlayerMode&&selectedGameMode===_0x8e1b5e(0x99)?_0x51d16f=player1Lives>0x0&&!isPlayer1ShipCaptured||player2Lives>0x0&&!isPlayer2ShipCaptured:_0x51d16f=playerLives>0x0&&!isShipCaptured;if(isPaused||!isInGameState||!_0x51d16f||isChallengingStage||isWaveTransitioning)return;const _0x4c35df=enemies['find'](_0x164b6d=>_0x164b6d&&_0x164b6d['id']===_0x20a0a9);_0x4c35df&&_0x4c35df[_0x8e1b5e(0x106)]===_0x148965&&(createBulletSimple(_0x4c35df)&&(_0xbbedb4===0x0&&playSound('enemyShootSound',![],0.4),_0x4c35df['lastFiredTime']=Date['now']()));}catch(_0x18a081){console[_0x8e1b5e(0x95)](_0x8e1b5e(0x129)+(_0xbbedb4+0x1)+'/'+_0x430eb8+')\x20for\x20'+_0x20a0a9+':',_0x18a081);}},_0x5b716d);enemySpawnTimeouts[_0x3710d8(0xd2)](_0x934346);}}function fireFixedEnemyBurst(_0x5be3e2,_0x590cdb,_0x158d72,_0x3a75ec){const _0x46c3dd=_0x571912;let _0x337c5e=![];isTwoPlayerMode&&selectedGameMode===_0x46c3dd(0x99)?_0x337c5e=player1Lives>0x0&&!isPlayer1ShipCaptured||player2Lives>0x0&&!isPlayer2ShipCaptured:_0x337c5e=playerLives>0x0&&!isShipCaptured;if(!_0x5be3e2||isPaused||!isInGameState||!_0x337c5e||isChallengingStage||isWaveTransitioning||_0x3a75ec<=0x0)return;for(let _0x451ab4=0x0;_0x451ab4<_0x3a75ec;_0x451ab4++){const _0x3925cb=_0x158d72+_0x451ab4*ENTRANCE_FIRE_BURST_DELAY_MS,_0x39268b=setTimeout(()=>{const _0x96c573=_0x46c3dd;try{const _0x5d521b=enemySpawnTimeouts[_0x96c573(0x91)](_0x39268b);_0x5d521b>-0x1&&enemySpawnTimeouts[_0x96c573(0x1b0)](_0x5d521b,0x1);let _0x1ca6f0=![];isTwoPlayerMode&&selectedGameMode===_0x96c573(0x99)?_0x1ca6f0=player1Lives>0x0&&!isPlayer1ShipCaptured||player2Lives>0x0&&!isPlayer2ShipCaptured:_0x1ca6f0=playerLives>0x0&&!isShipCaptured;if(isPaused||!isInGameState||!_0x1ca6f0||isChallengingStage||isWaveTransitioning)return;const _0x3a9684=enemies[_0x96c573(0x19b)](_0x4d2c76=>_0x4d2c76&&_0x4d2c76['id']===_0x5be3e2);if(_0x3a9684)createBulletSimple(_0x3a9684)&&(_0x451ab4===0x0&&playSound(_0x96c573(0xfb),![],0.4),_0x3a9684['lastFiredTime']=Date[_0x96c573(0x1a6)]());else{}}catch(_0x4329ca){console['error'](_0x96c573(0x118)+(_0x451ab4+0x1)+'/'+_0x3a75ec+_0x96c573(0x9a)+_0x5be3e2+':',_0x4329ca);}},_0x3925cb);enemySpawnTimeouts[_0x46c3dd(0xd2)](_0x39268b);}}function startFullGridWave(){const _0x29d74e=_0x571912;if(!currentWaveDefinition||currentWaveDefinition['length']===0x0||!isFullGridWave){console[_0x29d74e(0x95)]('Attempted\x20to\x20start\x20Full\x20Grid\x20wave\x20without\x20valid\x20definition\x20or\x20when\x20not\x20in\x20Full\x20Grid\x20mode.'),isWaveTransitioning=!![],readyForNextWaveReset=!![];return;}playSound(_0x29d74e(0x173),![],0.4),enemySpawnTimeouts['forEach'](clearTimeout),enemySpawnTimeouts=[],totalEnemiesScheduledForWave=0x0,enemiesSpawnedThisWave=0x0,squadronCompletionStatus={},squadronEntranceFiringStatus={};let _0x2d6804=0x0;currentWaveDefinition['forEach']((_0x30a914,_0x1a1289)=>{const _0x4f78a1=_0x29d74e;let _0x18894a=0x0;_0x30a914&&_0x30a914[_0x4f78a1(0x10f)]&&Array[_0x4f78a1(0xd8)](_0x30a914['enemies'])?(_0x18894a=_0x30a914[_0x4f78a1(0x10f)][_0x4f78a1(0x100)],_0x30a914[_0x4f78a1(0x10f)][_0x4f78a1(0xce)]((_0x350b9b,_0x27e77b)=>{const _0x4d4e2c=_0x4f78a1;try{if(!_0x350b9b||!_0x350b9b['type']||typeof _0x350b9b[_0x4d4e2c(0x1c9)]===_0x4d4e2c(0xf0)||typeof _0x350b9b[_0x4d4e2c(0x1bf)]===_0x4d4e2c(0xf0)){console[_0x4d4e2c(0x95)](_0x4d4e2c(0x178)+_0x1a1289+_0x4d4e2c(0x8f)+_0x27e77b+'.\x20Skipping.');return;}let _0x1ba26f=_0x350b9b[_0x4d4e2c(0x9f)],_0x1a8d42=_0x1ba26f===ENEMY3_TYPE?ENEMY3_MAX_HITS:0x1,_0x273db0,_0x27b897;if(_0x1ba26f===ENEMY1_TYPE)_0x273db0=ENEMY1_WIDTH,_0x27b897=ENEMY1_HEIGHT;else _0x1ba26f===ENEMY3_TYPE?(_0x273db0=BOSS_WIDTH,_0x27b897=BOSS_HEIGHT):(_0x273db0=ENEMY_WIDTH,_0x27b897=ENEMY_HEIGHT);let _0x5df2ef,_0x59d710;try{const {x:_0x531ffb,y:_0x2b5828}=getCurrentGridSlotPosition(_0x350b9b[_0x4d4e2c(0x1c9)],_0x350b9b[_0x4d4e2c(0x1bf)],_0x273db0);_0x5df2ef=_0x531ffb,_0x59d710=_0x2b5828;}catch(_0x1215e7){console[_0x4d4e2c(0x95)](_0x4d4e2c(0x117)+_0x350b9b[_0x4d4e2c(0x9f)]+_0x4d4e2c(0xbf)+_0x350b9b['gridRow']+','+_0x350b9b[_0x4d4e2c(0x1bf)]+']',_0x1215e7),_0x5df2ef=gameCanvas?.['width']/0x2||0xc8,_0x59d710=ENEMY_TOP_MARGIN+_0x350b9b[_0x4d4e2c(0x1c9)]*(ENEMY_HEIGHT+ENEMY_V_SPACING);}const _0x122bbd={'x':_0x5df2ef,'y':_0x59d710,'width':_0x273db0,'height':_0x27b897,'targetGridX':_0x5df2ef,'targetGridY':_0x59d710,'speed':0x0,'state':_0x4d4e2c(0x9d),'gridRow':_0x350b9b[_0x4d4e2c(0x1c9)],'gridCol':_0x350b9b['gridCol'],'type':_0x1ba26f,'health':_0x1a8d42,'isDamaged':![],'velocityX':0x0,'velocityY':0x0,'attackPathStep':0x0,'initialY':0x0,'initialX':0x0,'diveDirection':0x1,'lastFiredTime':0x0,'targetX1':0x0,'targetY1':0x0,'targetX2':0x0,'targetY2':0x0,'targetX3':0x0,'targetY3':0x0,'attackPathSegments':[],'attackPathSegmentIndex':0x0,'attackPathT':0x0,'attackStartTime':0x0,'attackFormationOffsetX':0x0,'attackGroupId':null,'entrancePathId':null,'pathSegmentIndex':0x0,'pathT':0x0,'squadronId':_0x1a1289,'squadronEnemyIndex':_0x27e77b,'id':'enemy-grid-'+_0x1a1289+'-'+_0x27e77b+'-'+Date[_0x4d4e2c(0x1a6)]()+'-'+Math[_0x4d4e2c(0xcb)]()['toString'](0x24)['substring'](0x2,0x7),'justReturned':![],'canFireThisDive':![],'attackType':'normal','hasCapturedShip':_0x1ba26f===ENEMY3_TYPE?![]:undefined,'capturedShipX':undefined,'capturedShipY':undefined,'capturedShipLastFiredTime':_0x1ba26f===ENEMY3_TYPE?0x0:undefined,'captureStartTime':0x0,'capturePrepareTimeout':null,'pathSpeedMultiplier':0x1};enemies[_0x4d4e2c(0xd2)](_0x122bbd),_0x2d6804++;}catch(_0x8b4e7){console['error'](_0x4d4e2c(0x122)+_0x1a1289+_0x4d4e2c(0x164)+_0x27e77b+'):',_0x8b4e7);}})):console[_0x4f78a1(0x137)](_0x4f78a1(0x8d)+_0x1a1289+_0x4f78a1(0xb6)),squadronCompletionStatus[_0x1a1289]={'completed':_0x18894a,'total':_0x18894a};}),totalEnemiesScheduledForWave=_0x2d6804,enemiesSpawnedThisWave=_0x2d6804,isEntrancePhaseActive=![],gridJustCompleted=!![],!isGridSoundPlaying&&(isGridSoundPlaying=!![],playSound('gridBackgroundSound',!![],0.1)),GRID_BREATH_ENABLED&&!isGridBreathingActive&&(isGridBreathingActive=!![],gridBreathStartTime=Date['now'](),currentGridBreathFactor=0x0),lastGridFireCheckTime=Date[_0x29d74e(0x1a6)](),firstEnemyLanded=!![];}function renderGame(){const _0x22031d=_0x571912;try{if(!gameCtx||!gameCanvas){if(mainLoopId)cancelAnimationFrame(mainLoopId);mainLoopId=null;return;}gameCtx[_0x22031d(0x143)](0x0,0x0,gameCanvas['width'],gameCanvas[_0x22031d(0x120)]);const _0x1fd32d=Date[_0x22031d(0x1a6)]();gameCtx[_0x22031d(0xd9)]();const _0xf5a1cf='20px\x20\x27Press\x20Start\x202P\x27',_0x49ef1b='red',_0x41b937=_0x22031d(0xa2);let _0x1d57ee,_0x3d6369,_0x35f0ac,_0x5ecec4,_0x580ec5=![],_0x550eb3=![],_0x3a7087=![];if(isShowingResultsScreen){}else{if(gameOverSequenceStartTime>0x0&&!isShowingPlayerGameOverMessage){}else{if(isShowingPlayerGameOverMessage){}else{if(!isInGameState){}else{_0x35f0ac=highScore||0x0;if(!isManualControl){}else{if(isTwoPlayerMode&&selectedGameMode===_0x22031d(0x99)){_0x1d57ee=player1Score,_0x3d6369=player2Score,_0x35f0ac=Math[_0x22031d(0x14a)](highScore,player1Score,player2Score),_0x5ecec4=_0x22031d(0x19c),_0x580ec5=!isShowingIntro&&!isPaused&&player1Lives>0x0&&ship1&&!isPlayer1ShipCaptured&&!isPlayer1WaitingForRespawn,_0x550eb3=!isShowingIntro&&!isPaused&&player2Lives>0x0&&ship2&&!isPlayer2ShipCaptured&&!isPlayer2WaitingForRespawn;if(player1Score>=_0x35f0ac&&player1Score>0x0)_0x3a7087=_0x580ec5;if(player2Score>=_0x35f0ac&&player2Score>0x0&&player2Score>player1Score)_0x3a7087=_0x550eb3;}else isTwoPlayerMode&&selectedGameMode===_0x22031d(0x156)?(_0x1d57ee=currentPlayer===0x1?score:player1Score,_0x3d6369=currentPlayer===0x2?score:player2Score,_0x35f0ac=Math[_0x22031d(0x14a)](highScore,player1Score,player2Score,score),_0x5ecec4=_0x22031d(0x19c),_0x580ec5=!isShowingIntro&&!isPaused&&currentPlayer===0x1&&playerLives>0x0&&!isShipCaptured&&!isWaitingForRespawn,_0x550eb3=!isShowingIntro&&!isPaused&&currentPlayer===0x2&&playerLives>0x0&&!isShipCaptured&&!isWaitingForRespawn,_0x3a7087=!isPaused&&!isShowingIntro&&score>0x0&&_0x35f0ac>0x0&&score>=_0x35f0ac):(_0x1d57ee=score,_0x3d6369=0x0,_0x5ecec4='1UP');}}}}}let _0x204bf6=![];if(_0x3a7087){}typeof MARGIN_SIDE!==_0x22031d(0xf0)&&typeof MARGIN_TOP!==_0x22031d(0xf0)&&typeof SCORE_OFFSET_Y!=='undefined'&&(drawTopUiElement(_0x5ecec4,_0x1d57ee,_0x22031d(0x159),MARGIN_SIDE,_0x580ec5),drawTopUiElement(_0x22031d(0xe5),_0x35f0ac,_0x22031d(0x193),gameCanvas[_0x22031d(0x1c4)]/0x2,_0x204bf6),drawTopUiElement('2UP',_0x3d6369,_0x22031d(0x94),gameCanvas[_0x22031d(0x1c4)]-MARGIN_SIDE,_0x550eb3));if(typeof shipImage!==_0x22031d(0xf0)&&typeof LIFE_ICON_MARGIN_BOTTOM!==_0x22031d(0xf0)&&typeof LIFE_ICON_SIZE!==_0x22031d(0xf0)&&typeof LIFE_ICON_MARGIN_LEFT!=='undefined'&&typeof LIFE_ICON_SPACING!==_0x22031d(0xf0)){if(shipImage['complete']&&shipImage['naturalHeight']!==0x0){const _0x444275=gameCanvas[_0x22031d(0x120)]-LIFE_ICON_MARGIN_BOTTOM-LIFE_ICON_SIZE;let _0x262bc2=0x0,_0x3ad980=0x0;if(isTwoPlayerMode&&selectedGameMode===_0x22031d(0x99)){if(player1Lives>0x0)_0x262bc2=Math['max'](0x0,player1Lives-0x1);if(player2Lives>0x0)_0x3ad980=Math['max'](0x0,player2Lives-0x1);}else{if(playerLives>0x0)_0x262bc2=Math['max'](0x0,playerLives-0x1);}const _0x4c29ed=0x5;for(let _0x289c79=0x0;_0x289c79<Math[_0x22031d(0xf4)](_0x262bc2,_0x4c29ed);_0x289c79++){const _0x427bc1=LIFE_ICON_MARGIN_LEFT+_0x289c79*(LIFE_ICON_SIZE+LIFE_ICON_SPACING);gameCtx[_0x22031d(0x8e)](shipImage,Math[_0x22031d(0x196)](_0x427bc1),Math[_0x22031d(0x196)](_0x444275),LIFE_ICON_SIZE,LIFE_ICON_SIZE);}if(isTwoPlayerMode&&selectedGameMode===_0x22031d(0x99)){const _0x2ffeb1=gameCanvas[_0x22031d(0x1c4)]-LIFE_ICON_MARGIN_RIGHT-Math[_0x22031d(0xf4)](_0x3ad980,_0x4c29ed)*(LIFE_ICON_SIZE+LIFE_ICON_SPACING)+LIFE_ICON_SPACING;for(let _0x2d9ece=0x0;_0x2d9ece<Math['min'](_0x3ad980,_0x4c29ed);_0x2d9ece++){const _0x35614d=_0x2ffeb1+_0x2d9ece*(LIFE_ICON_SIZE+LIFE_ICON_SPACING);gameCtx[_0x22031d(0x8e)](shipImage,Math[_0x22031d(0x196)](_0x35614d),Math[_0x22031d(0x196)](_0x444275),LIFE_ICON_SIZE,LIFE_ICON_SIZE);}}}}gameCtx[_0x22031d(0x151)](),gameCtx[_0x22031d(0xd9)]();if(isTwoPlayerMode&&selectedGameMode===_0x22031d(0x99)){if(ship1&&player1Lives>0x0&&!isPlayer1WaitingForRespawn&&!isPlayer1ShipCaptured){let _0x2db20d=!![];if(isPlayer1Invincible){const _0x7bce5f=INVINCIBILITY_BLINK_ON_MS+INVINCIBILITY_BLINK_OFF_MS;if(_0x1fd32d%_0x7bce5f>=INVINCIBILITY_BLINK_ON_MS)_0x2db20d=![];}if(_0x2db20d){const _0x27d779=ship1['x'],_0x3f1c25=ship1['y'];typeof shipImage!==_0x22031d(0xf0)&&shipImage[_0x22031d(0xe2)]?(gameCtx['drawImage'](shipImage,Math['round'](_0x27d779),Math['round'](_0x3f1c25),ship1['width'],ship1[_0x22031d(0x120)]),player1IsDualShipActive&&gameCtx[_0x22031d(0x8e)](shipImage,Math['round'](_0x27d779+DUAL_SHIP_OFFSET_X),Math[_0x22031d(0x196)](_0x3f1c25),ship1[_0x22031d(0x1c4)],ship1[_0x22031d(0x120)])):(gameCtx[_0x22031d(0x138)]=_0x22031d(0x152),gameCtx['fillRect'](Math[_0x22031d(0x196)](_0x27d779),Math[_0x22031d(0x196)](_0x3f1c25),ship1[_0x22031d(0x1c4)],ship1[_0x22031d(0x120)]));}}if(ship2&&player2Lives>0x0&&!isPlayer2WaitingForRespawn&&!isPlayer2ShipCaptured){let _0x1a9932=!![];if(isPlayer2Invincible){const _0x489de6=INVINCIBILITY_BLINK_ON_MS+INVINCIBILITY_BLINK_OFF_MS;if(_0x1fd32d%_0x489de6>=INVINCIBILITY_BLINK_ON_MS)_0x1a9932=![];}if(_0x1a9932){const _0x356d28=ship2['x'],_0x4c6cc0=ship2['y'];typeof shipImage!==_0x22031d(0xf0)&&shipImage[_0x22031d(0xe2)]?(gameCtx[_0x22031d(0x8e)](shipImage,Math[_0x22031d(0x196)](_0x356d28),Math['round'](_0x4c6cc0),ship2[_0x22031d(0x1c4)],ship2[_0x22031d(0x120)]),player2IsDualShipActive&&gameCtx[_0x22031d(0x8e)](shipImage,Math['round'](_0x356d28+DUAL_SHIP_OFFSET_X),Math[_0x22031d(0x196)](_0x4c6cc0),ship2[_0x22031d(0x1c4)],ship2[_0x22031d(0x120)])):(gameCtx[_0x22031d(0x138)]=_0x22031d(0x189),gameCtx['fillRect'](Math[_0x22031d(0x196)](_0x356d28),Math[_0x22031d(0x196)](_0x4c6cc0),ship2[_0x22031d(0x1c4)],ship2['height']));}}}else{if(ship&&!isShowingCaptureMessage){let _0x493968=!![];if(isInGameState&&!gameOverSequenceStartTime&&!isShowingPlayerGameOverMessage&&isInvincible){const _0x3d54b5=INVINCIBILITY_BLINK_ON_MS+INVINCIBILITY_BLINK_OFF_MS;if(_0x1fd32d%_0x3d54b5>=INVINCIBILITY_BLINK_ON_MS)_0x493968=![];}if(_0x493968){let _0x5c61d3=ship['x'],_0x3ae2b4=(isShowingPlayerGameOverMessage||gameOverSequenceStartTime>0x0||!isInGameState||isShowingScoreScreen||isInGameState&&isShowingIntro&&!isManualControl&&(introStep===0x1||introStep===0x2||introStep===0x3))&&!isDualShipActive;_0x3ae2b4&&(_0x5c61d3=Math[_0x22031d(0x196)](gameCanvas['width']/0x2-ship['width']/0x2));const _0x239911=ship['y'];typeof shipImage!==_0x22031d(0xf0)&&shipImage[_0x22031d(0xe2)]?(gameCtx['drawImage'](shipImage,Math['round'](_0x5c61d3),Math[_0x22031d(0x196)](_0x239911),ship['width'],ship[_0x22031d(0x120)]),isInGameState&&!gameOverSequenceStartTime&&!isShowingPlayerGameOverMessage&&isDualShipActive&&!isShipCaptured&&gameCtx[_0x22031d(0x8e)](shipImage,Math[_0x22031d(0x196)](_0x5c61d3+DUAL_SHIP_OFFSET_X),Math[_0x22031d(0x196)](_0x239911),ship[_0x22031d(0x1c4)],ship[_0x22031d(0x120)])):(gameCtx['fillStyle']=_0x22031d(0x152),gameCtx[_0x22031d(0x128)](Math['round'](_0x5c61d3),Math['round'](_0x239911),ship[_0x22031d(0x1c4)],ship[_0x22031d(0x120)]));}}}if(fallingShips[_0x22031d(0x100)]>0x0&&typeof shipImage!==_0x22031d(0xf0)&&shipImage[_0x22031d(0xe2)]){}gameCtx['restore']();if(!isInGameState){if(isShowingScoreScreen){}else{gameCtx[_0x22031d(0xd9)]();const _0x3a6836=gameCanvas['width'],_0x129d0d=gameCanvas[_0x22031d(0x120)],_0x2a0ed0=_0x3a6836/0x2;selectedButtonIndex===-0x1&&(isPlayerSelectMode||isFiringModeSelectMode||isGameModeSelectMode||!isPlayerSelectMode&&!isFiringModeSelectMode&&!isGameModeSelectMode)&&(selectedButtonIndex=0x0);let _0x24e860=MENU_LOGO_APPROX_HEIGHT,_0x5a7a81=_0x24e860*(logoImage[_0x22031d(0x1a9)]/logoImage[_0x22031d(0x146)]||0x1);typeof logoImage!=='undefined'&&logoImage[_0x22031d(0xe2)]&&logoImage[_0x22031d(0x146)]!==0x0&&(_0x24e860=logoImage['naturalHeight']*LOGO_SCALE_FACTOR,_0x5a7a81=logoImage[_0x22031d(0x1a9)]*LOGO_SCALE_FACTOR);const _0x33ba75=getSubtitleApproxHeight(MENU_SUBTITLE_FONT),_0x2241b3=_0x24e860+MENU_LOGO_BOTTOM_TO_START_GAP+0x2*MENU_BUTTON_HEIGHT+MENU_BUTTON_V_GAP+MENU_BUTTON_SUBTITLE_V_GAP+_0x33ba75;let _0x58dac3=(_0x129d0d-_0x2241b3)/0x2-0x46;_0x58dac3+=MENU_GENERAL_Y_OFFSET;const _0x5fbe1a=_0x2a0ed0-_0x5a7a81/0x2,_0x3381cd=_0x58dac3+MENU_LOGO_EXTRA_Y_OFFSET;typeof logoImage!==_0x22031d(0xf0)&&logoImage[_0x22031d(0xe2)]&&logoImage['naturalHeight']!==0x0?gameCtx[_0x22031d(0x8e)](logoImage,Math[_0x22031d(0x196)](_0x5fbe1a),Math[_0x22031d(0x196)](_0x3381cd),_0x5a7a81,_0x24e860):drawCanvasText(_0x22031d(0x19d),_0x2a0ed0,_0x3381cd+_0x24e860/0x2,_0x22031d(0xb8),'grey');if(isGameModeSelectMode)drawCanvasButton(_0x22031d(0x15c),0x0,selectedButtonIndex===0x0),drawCanvasButton(_0x22031d(0x130),0x1,selectedButtonIndex===0x1);else{if(isFiringModeSelectMode)drawCanvasButton(_0x22031d(0x194),0x0,selectedButtonIndex===0x0),drawCanvasButton(_0x22031d(0x19a),0x1,selectedButtonIndex===0x1);else isPlayerSelectMode?(drawCanvasButton('1\x20PLAYER',0x0,selectedButtonIndex===0x0),drawCanvasButton(_0x22031d(0xe8),0x1,selectedButtonIndex===0x1)):(drawCanvasButton('START\x20GAME',0x0,selectedButtonIndex===0x0),drawCanvasButton(_0x22031d(0xd6),0x1,selectedButtonIndex===0x1));}const _0x512c5a=getMenuButtonRect(0x1);let _0x451d8e;_0x512c5a?_0x451d8e=_0x512c5a['y']+_0x512c5a[_0x22031d(0x120)]+MENU_BUTTON_SUBTITLE_V_GAP+_0x33ba75/0x2:_0x451d8e=_0x58dac3+_0x24e860+MENU_LOGO_BOTTOM_TO_START_GAP+0x2*MENU_BUTTON_HEIGHT+MENU_BUTTON_V_GAP+MENU_BUTTON_SUBTITLE_V_GAP+_0x33ba75/0x2,drawCanvasText(MENU_SUBTITLE_TEXT,_0x2a0ed0-0x1,Math[_0x22031d(0x196)](_0x451d8e),MENU_SUBTITLE_FONT,MENU_SUBTITLE_COLOR,_0x22031d(0x193),'middle',!![]),gameCtx[_0x22031d(0x151)]();}}else{if(gameOverSequenceStartTime===0x0&&!isShowingPlayerGameOverMessage){gameCtx['save']();let _0x3ed7a0=!showReadyMessage&&!showCsHitsMessage&&!showPerfectMessage&&!showCsBonusScoreMessage&&!showCSClearMessage&&!isCsCompletionDelayActive&&!isShowingIntro&&!isShowingCaptureMessage;_0x3ed7a0&&(bullets[_0x22031d(0xce)](_0x896a5d=>{}),enemyBullets[_0x22031d(0xce)](_0x5ec570=>{}));enemies[_0x22031d(0xce)](_0x8db689=>{});if(captureBeamActive&&capturingBossId&&captureBeamProgress>0x0){}renderExplosions(),renderFloatingScores(),renderHitSparks();let _0x3ae9af=![];const _0x54e2a0=gameCanvas[_0x22031d(0x120)]/0x2;if(isPaused){}else{if(isShowingCaptureMessage){}}gameCtx[_0x22031d(0x151)]();}else{if(isShowingPlayerGameOverMessage){}else{if(gameOverSequenceStartTime>0x0){}}}}}catch(_0x2754aa){console['error'](_0x22031d(0xd4),_0x2754aa,_0x2754aa[_0x22031d(0xcd)]);}}function handleEnemyHit(_0x375f60,_0x4bc151=null){const _0x1b487e=_0x571912;if(!_0x375f60)return{'destroyed':![],'pointsAwarded':0x0};const _0x9e101e=Date[_0x1b487e(0x1a6)]();let _0x17c457=0x0,_0x4a29bb=![],_0x5f0007=_0x375f60['isDamaged'],_0x1528f3=null,_0x528552=0x1;const _0x216316=_0x375f60[_0x1b487e(0x9f)]===ENEMY3_TYPE?BOSS_WIDTH:_0x375f60[_0x1b487e(0x9f)]===ENEMY1_TYPE?ENEMY1_WIDTH:ENEMY_WIDTH,_0x1668a7=_0x375f60[_0x1b487e(0x9f)]===ENEMY3_TYPE?BOSS_HEIGHT:_0x375f60[_0x1b487e(0x9f)]===ENEMY1_TYPE?ENEMY1_HEIGHT:ENEMY_HEIGHT,_0x10cade=_0x375f60['type']===ENEMY3_TYPE&&_0x375f60['hasCapturedShip'],_0xc58b0d=_0x375f60[_0x1b487e(0x9f)]===ENEMY3_TYPE&&_0x375f60[_0x1b487e(0x1bd)];let _0xfee490=![],_0x29f784=null;if(_0x10cade){if(isTwoPlayerMode&&selectedGameMode==='coop'){if(isPlayer1ShipCaptured&&capturedBossIdWithMessage===_0x375f60['id'])_0xfee490=!![],_0x29f784=_0x1b487e(0x10c);else isPlayer2ShipCaptured&&capturedBossIdWithMessage===_0x375f60['id']&&(_0xfee490=!![],_0x29f784=_0x1b487e(0xf1));}else!isTwoPlayerMode&&isShipCaptured&&capturedBossIdWithMessage===_0x375f60['id']&&(_0xfee490=!![]);}const _0xf53326=_0x375f60['x']+_0x216316/0x2,_0x428b84=_0x375f60['y']+_0x1668a7*0.2;createHitSparks(_0xf53326,_0x428b84),_0x375f60[_0x1b487e(0x1a2)]--;_0x375f60[_0x1b487e(0x9f)]===ENEMY3_TYPE&&(_0x375f60['isDamaged']=_0x375f60[_0x1b487e(0x1a2)]<ENEMY3_MAX_HITS);if(_0x375f60['health']<=0x0){_0x4a29bb=!![];isChallengingStage&&challengingStageEnemiesHit++;if(_0x10cade&&_0xc58b0d){let _0xb9e3a3=null;if(_0xfee490&&_0x29f784)_0xb9e3a3=_0x29f784;else{let _0x2c0533=![];if(isCoopAIDemoActive){if(_0x4bc151===_0x1b487e(0x10c)&&player1IsDualShipActive)_0xb9e3a3=_0x1b487e(0xf1),_0x2c0533=!![];else _0x4bc151===_0x1b487e(0xf1)&&player2IsDualShipActive&&(_0xb9e3a3=_0x1b487e(0x10c),_0x2c0533=!![]);}else{if(isPlayerTwoAI&&selectedOnePlayerGameVariant===_0x1b487e(0x165)){if(_0x4bc151===_0x1b487e(0xed)&&player2IsDualShipActive)_0xb9e3a3=_0x1b487e(0x10c),_0x2c0533=!![];else _0x4bc151===_0x1b487e(0x10c)&&player1IsDualShipActive&&(_0xb9e3a3=_0x1b487e(0xed),_0x2c0533=!![]);}}!_0x2c0533&&(_0xb9e3a3=_0x4bc151);}_0xb9e3a3===null&&_0x4bc151&&(_0xb9e3a3=_0x4bc151);if(_0x375f60['capturedShipDimensions']){const _0x1f4e61=_0x375f60[_0x1b487e(0x1bd)][_0x1b487e(0x1c4)],_0x29a35c=_0x375f60[_0x1b487e(0x1bd)][_0x1b487e(0x120)],_0x10a7f8=_0x375f60['x']+(_0x216316-_0x1f4e61)/0x2+CAPTURED_SHIP_OFFSET_X,_0x475cff=_0x375f60['y']+CAPTURED_SHIP_OFFSET_Y,_0x4ca89f=fallingShips[_0x1b487e(0xdd)](_0x389d71=>Math[_0x1b487e(0x101)](_0x389d71['x']-_0x10a7f8)<0x1&&Math['abs'](_0x389d71['y']-_0x475cff)<0x1);!_0x4ca89f&&fallingShips[_0x1b487e(0xd2)]({'x':_0x10a7f8,'y':_0x475cff,'width':_0x1f4e61,'height':_0x29a35c,'creationTime':_0x9e101e,'tintProgress':0x1,'rotation':0x0,'rotationDirection':Math['random']()<0.5?-0x1:0x1,'totalRotation':0x0,'rotationCompleted':![],'targetPlayerId':_0xb9e3a3});}else console[_0x1b487e(0x95)](_0x1b487e(0x160));_0x375f60[_0x1b487e(0x1b9)]=![],_0x375f60[_0x1b487e(0x1bd)]=null;}else _0x10cade&&!_0xc58b0d&&(console[_0x1b487e(0x95)](_0x1b487e(0x180)+_0x375f60['id']+_0x1b487e(0x15d)),_0x375f60['hasCapturedShip']=![],_0x375f60[_0x1b487e(0x1bd)]=null);if(isChallengingStage){let _0x4054ba=0x64;const _0x31d9d2=csLastHitTime;csLastHitTime=_0x9e101e,csLastChainHitPosition={'x':_0x375f60['x'],'y':_0x375f60['y']},csCurrentChainHits>0x0&&_0x9e101e-_0x31d9d2<CS_CHAIN_BREAK_TIME_MS?csCurrentChainHits++:(csCurrentChainHits=0x1,csCurrentChainScore=0x0),csCurrentChainHits>=CS_CHAIN_SCORE_THRESHOLD&&(_0x4054ba*=0x2),_0x17c457=_0x4054ba,csCurrentChainScore+=_0x17c457,scoreEarnedThisCS+=_0x17c457,_0x1528f3=_0x1b487e(0x121),_0x528552=0.4;}else{if(_0x375f60[_0x1b487e(0x106)]==='in_grid')_0x17c457=_0x375f60[_0x1b487e(0x9f)]===ENEMY1_TYPE?0x32:_0x375f60[_0x1b487e(0x9f)]===ENEMY2_TYPE?0x50:0x0,_0x375f60['type']===ENEMY3_TYPE&&(_0x17c457=0x96),_0x1528f3=_0x1b487e(0x121),_0x528552=0.4;else{_0x17c457=_0x375f60[_0x1b487e(0x9f)]===ENEMY1_TYPE?0x64:_0x375f60['type']===ENEMY2_TYPE?0xa0:0x0;if(_0x375f60[_0x1b487e(0x9f)]===ENEMY3_TYPE){if(_0x10cade){const _0x238920=[0x3e8,0x5dc,0x7d0,0xbb8];_0x17c457=_0x238920[Math[_0x1b487e(0x9c)](Math[_0x1b487e(0xcb)]()*_0x238920[_0x1b487e(0x100)])],_0x1528f3='bossHit2Sound',_0x528552=0.4;}else _0x5f0007?(_0x17c457=0x190,_0x1528f3=_0x1b487e(0x1b7),_0x528552=0.4):(_0x17c457=0x0,console['warn']('[Destroyed\x20Boss\x20Score\x20-\x20Attack]\x20Boss\x20destroyed\x20on\x20first\x20hit?\x20Awarding\x20'+_0x17c457+_0x1b487e(0x17d)+(_0x375f60[_0x1b487e(0x1a2)]+0x1)),_0x1528f3='explosionSound',_0x528552=0.4);}else _0x1528f3=_0x1b487e(0x121),_0x528552=0.4;if(_0x4a29bb&&_0x17c457>0x0){const _0x1821dc=normalWaveLastHitTime;normalWaveLastHitTime=_0x9e101e,normalWaveLastChainHitPosition={'x':_0x375f60['x'],'y':_0x375f60['y']};normalWaveLastChainHitPosition&&_0x9e101e-_0x1821dc<NORMAL_WAVE_CHAIN_BREAK_TIME_MS?normalWaveCurrentChainHits++:(normalWaveCurrentChainHits=0x1,normalWaveCurrentChainScore=0x0);if(NORMAL_WAVE_CHAIN_BONUS_ENABLED&&normalWaveCurrentChainHits>=NORMAL_WAVE_CHAIN_SCORE_THRESHOLD){const _0x23d1ea=[0x12c,0x258,0x3e8,0x5dc,0x7d0,0xbb8],_0x7e9481=Math[_0x1b487e(0xf4)](_0x23d1ea[_0x1b487e(0x100)]-0x1,normalWaveCurrentChainHits-NORMAL_WAVE_CHAIN_SCORE_THRESHOLD),_0x209dba=_0x23d1ea[_0x7e9481];_0x17c457+=_0x209dba,normalWaveCurrentChainScore+=_0x209dba;}}}}if(_0x17c457>0x0){let _0x1266cb=null;if(isCoopAIDemoActive){if(_0x4bc151==='player1')player1Score+=_0x17c457,_0x1266cb=()=>player1EnemiesHit++,player1Score>highScore&&(highScore=player1Score,!player1TriggeredHighScoreSound&&(player1TriggeredHighScoreSound=!![],playSound(_0x1b487e(0x199),![],0.2))),checkAndAwardExtraLife(0x1);else{if(_0x4bc151==='player2')player2Score+=_0x17c457,_0x1266cb=()=>player2EnemiesHit++,player2Score>highScore&&(highScore=player2Score,!player2TriggeredHighScoreSound&&(player2TriggeredHighScoreSound=!![],playSound(_0x1b487e(0x199),![],0.2))),checkAndAwardExtraLife(0x2);else{player1Score+=_0x17c457,_0x1266cb=()=>player1EnemiesHit++;if(player1Score>highScore)highScore=player1Score;checkAndAwardExtraLife(0x1);}}}else{if(!isManualControl)score+=_0x17c457,player1Score=score,_0x1266cb=()=>player1EnemiesHit++,score>highScore&&(highScore=score,!player1TriggeredHighScoreSound&&(player1TriggeredHighScoreSound=!![],playSound(_0x1b487e(0x199),![],0.2))),checkAndAwardExtraLife(0x1);else{if(isPlayerTwoAI&&selectedOnePlayerGameVariant===_0x1b487e(0x165)){if(_0x4bc151===_0x1b487e(0x10c))player1Score+=_0x17c457,_0x1266cb=()=>player1EnemiesHit++,player1Score>highScore&&(highScore=player1Score,!player1TriggeredHighScoreSound&&(player1TriggeredHighScoreSound=!![],playSound(_0x1b487e(0x199),![],0.2))),checkAndAwardExtraLife(0x1);else{if(_0x4bc151===_0x1b487e(0xed))player2Score+=_0x17c457,_0x1266cb=()=>player2EnemiesHit++,player2Score>highScore&&(highScore=player2Score,!player2TriggeredHighScoreSound&&(player2TriggeredHighScoreSound=!![],playSound(_0x1b487e(0x199),![],0.2))),checkAndAwardExtraLife(0x2);else{player1Score+=_0x17c457,_0x1266cb=()=>player1EnemiesHit++;if(player1Score>highScore)highScore=player1Score;checkAndAwardExtraLife(0x1);}}}else{if(isTwoPlayerMode&&selectedGameMode===_0x1b487e(0x99)){if(_0x4bc151===_0x1b487e(0x10c))player1Score+=_0x17c457,_0x1266cb=()=>player1EnemiesHit++,player1Score>highScore&&(highScore=player1Score,!player1TriggeredHighScoreSound&&(player1TriggeredHighScoreSound=!![],playSound(_0x1b487e(0x199),![],0.2))),checkAndAwardExtraLife(0x1);else _0x4bc151===_0x1b487e(0xf1)?(player2Score+=_0x17c457,_0x1266cb=()=>player2EnemiesHit++,player2Score>highScore&&(highScore=player2Score,!player2TriggeredHighScoreSound&&(player2TriggeredHighScoreSound=!![],playSound('hiScoreSound',![],0.2))),checkAndAwardExtraLife(0x2)):(player1Score+=_0x17c457,_0x1266cb=()=>player1EnemiesHit++,player1Score>highScore&&(highScore=player1Score,!player1TriggeredHighScoreSound&&(player1TriggeredHighScoreSound=!![],playSound(_0x1b487e(0x199),![],0.2))),checkAndAwardExtraLife(0x1));}else{score+=_0x17c457;let _0x4874e3=score,_0x38f473=null,_0xda9edb=currentPlayer;currentPlayer===0x1||!isTwoPlayerMode?(player1Score=score,_0x1266cb=()=>player1EnemiesHit++,_0x38f473=()=>{player1TriggeredHighScoreSound=!![];}):(player2Score=score,_0x1266cb=()=>player2EnemiesHit++,_0x38f473=()=>{player2TriggeredHighScoreSound=!![];});if(_0x4874e3>highScore){highScore=_0x4874e3;const _0x3b8dfb=currentPlayer===0x1||!isTwoPlayerMode?player1TriggeredHighScoreSound:player2TriggeredHighScoreSound;!_0x3b8dfb&&_0x38f473&&(_0x38f473(),playSound(_0x1b487e(0x199),![],0.2));}checkAndAwardExtraLife(_0xda9edb);}}}}_0x1266cb&&!isChallengingStage&&_0x1266cb();const _0x4490d6=_0x375f60[_0x1b487e(0x106)]===_0x1b487e(0x9d)||isChallengingStage?FLOATING_SCORE_COLOR_GRID:FLOATING_SCORE_COLOR_ACTIVE;floatingScores[_0x1b487e(0xd2)]({'text':_0x17c457[_0x1b487e(0x154)](),'x':_0x375f60['x']+_0x216316/0x2,'y':_0x375f60['y'],'color':_0x4490d6,'creationTime':_0x9e101e,'displayStartTime':_0x9e101e+FLOATING_SCORE_APPEAR_DELAY});}createExplosion(_0x375f60['x']+_0x216316/0x2,_0x375f60['y']+_0x1668a7/0x2);_0x375f60['id']===capturingBossId&&stopSound(_0x1b487e(0x1ae));if(_0x375f60[_0x1b487e(0x106)]==='attacking'||_0x375f60[_0x1b487e(0x106)]===_0x1b487e(0xd3)||_0x375f60[_0x1b487e(0x106)]===_0x1b487e(0xd5)||_0x375f60[_0x1b487e(0x106)]===_0x1b487e(0x18f)||_0x375f60[_0x1b487e(0x106)]===_0x1b487e(0x14e)||_0x375f60['state']===_0x1b487e(0x169)){if(_0x375f60[_0x1b487e(0x9f)]===ENEMY3_TYPE)stopSound('bossGalagaDiveSound');else stopSound(_0x1b487e(0x1a3));}}else{_0x4a29bb=![];if(_0x375f60[_0x1b487e(0x9f)]===ENEMY3_TYPE)_0x1528f3='bossHit1Sound',_0x528552=0.6,_0x17c457=0x0;else{_0x17c457=0x0;if(_0x375f60[_0x1b487e(0x9f)]===ENEMY1_TYPE)_0x1528f3=_0x1b487e(0x185),_0x528552=0.3;else _0x375f60[_0x1b487e(0x9f)]===ENEMY2_TYPE&&(_0x1528f3=_0x1b487e(0xea),_0x528552=0.3);}}return _0x1528f3&&playSound(_0x1528f3,![],_0x528552),{'destroyed':_0x4a29bb,'pointsAwarded':_0x17c457};}function createHitSparks(_0x20916a,_0xf69e1f){const _0x3bfc59=_0x571912;if(!gameCtx)return;const _0x2ec2f2=Date[_0x3bfc59(0x1a6)]();for(let _0x5c32a1=0x0;_0x5c32a1<HIT_SPARK_COUNT;_0x5c32a1++){const _0x550fda=Math['random']()*Math['PI']*0x2,_0x4970d0=HIT_SPARK_SPEED*(0.7+Math[_0x3bfc59(0xcb)]()*0.6),_0x163238=HIT_SPARK_LIFETIME*(0.8+Math['random']()*0.4);hitSparks[_0x3bfc59(0xd2)]({'x':_0x20916a,'y':_0xf69e1f,'vx':Math[_0x3bfc59(0xca)](_0x550fda)*_0x4970d0,'vy':Math['sin'](_0x550fda)*_0x4970d0,'creationTime':_0x2ec2f2,'lifetime':_0x163238,'size':HIT_SPARK_SIZE,'color':HIT_SPARK_COLOR});}}function updateHitSparks(){const _0x58c346=_0x571912,_0x3b461c=Date[_0x58c346(0x1a6)]();for(let _0x3d13df=hitSparks['length']-0x1;_0x3d13df>=0x0;_0x3d13df--){const _0x338bd3=hitSparks[_0x3d13df],_0xb1a962=_0x3b461c-_0x338bd3[_0x58c346(0x1b6)];_0xb1a962>=_0x338bd3[_0x58c346(0xe1)]?hitSparks[_0x58c346(0x1b0)](_0x3d13df,0x1):(_0x338bd3['vy']+=HIT_SPARK_GRAVITY,_0x338bd3['x']+=_0x338bd3['vx'],_0x338bd3['y']+=_0x338bd3['vy'],_0x338bd3[_0x58c346(0xa9)]=Math[_0x58c346(0x14a)](0x0,0x1-_0xb1a962*HIT_SPARK_FADE_SPEED));}}function moveEntities(){const _0x5b3af8=_0x571912;try{if(isPaused)return;const _0x1cce47=Date['now']();}catch(_0x3d7ea8){console[_0x5b3af8(0x95)](_0x5b3af8(0x1ca),_0x3d7ea8,_0x3d7ea8[_0x5b3af8(0xcd)]),isGridSoundPlaying=![],stopSound(_0x5b3af8(0x11c)),isEntrancePhaseActive=![],stopSound(_0x5b3af8(0x173)),isShowingPlayerGameOverMessage=![],playerGameOverMessageStartTime=0x0,playerWhoIsGameOver=0x0,nextActionAfterPlayerGameOver='',isShipCaptured=![],captureBeamActive=![],capturingBossId=null,stopSound(_0x5b3af8(0x1ae)),stopSound(_0x5b3af8(0x17b)),isWaitingForRespawn=![],fallingShips=[],isDualShipActive=![],player1IsDualShipActive=![],player2IsDualShipActive=![],isInvincible=![],invincibilityEndTime=0x0,hitSparks=[];if(typeof showMenuState===_0x5b3af8(0x11f))showMenuState();if(mainLoopId)cancelAnimationFrame(mainLoopId);mainLoopId=null,alert(_0x5b3af8(0x11d));}}function switchPlayerTurn(){const _0x171a93=_0x571912;if(!isTwoPlayerMode||selectedGameMode===_0x171a93(0x99))return![];stopSound(_0x171a93(0x199));if(currentPlayer===0x1){player1Score=score,player1IsDualShipActive=isDualShipActive,player1MaxLevelReached=Math[_0x171a93(0x14a)](player1MaxLevelReached,level);if(player1Score>highScore)highScore=player1Score;}else{player2Score=score,player2IsDualShipActive=isDualShipActive,player2MaxLevelReached=Math['max'](player2MaxLevelReached,level);if(player2Score>highScore)highScore=player2Score;}const _0x1cbeba=currentPlayer===0x1?0x2:0x1,_0x4c457a=_0x1cbeba===0x1?player1Lives:player2Lives;if(_0x4c457a<=0x0){const _0xb678cc=currentPlayer===0x1?player1Lives:player2Lives;return _0xb678cc<=0x0?(triggerFinalGameOverSequence(),![]):(forceCenterShipNextReset=![],![]);}return currentPlayer=_0x1cbeba,score=currentPlayer===0x1?player1Score:player2Score,playerLives=currentPlayer===0x1?player1Lives:player2Lives,isDualShipActive=currentPlayer===0x1?player1IsDualShipActive:player2IsDualShipActive,forceCenterShipNextReset=!![],scoreEarnedThisCS=0x0,csCurrentChainHits=0x0,csCurrentChainScore=0x0,csLastHitTime=0x0,csLastChainHitPosition=null,normalWaveCurrentChainHits=0x0,normalWaveCurrentChainScore=0x0,normalWaveLastHitTime=0x0,normalWaveLastHitPosition=null,leftPressed=![],rightPressed=![],shootPressed=![],p2LeftPressed=![],p2RightPressed=![],p2ShootPressed=![],keyboardP1LeftDown=![],keyboardP1RightDown=![],keyboardP1ShootDown=![],keyboardP2LeftDown=![],keyboardP2RightDown=![],keyboardP2ShootDown=![],p1JustFiredSingle=![],p2JustFiredSingle=![],p1FireInputWasDown=![],p2FireInputWasDown=![],isShipCaptured=![],isWaitingForRespawn=![],respawnTime=0x0,isInvincible=![],invincibilityEndTime=0x0,fallingShips=[],hitSparks=[],showExtraLifeMessage=![],extraLifeMessageStartTime=0x0,!![];}function firePlayerBullet(_0x83798a=null,_0x4d4941=![]){const _0x422579=_0x571912,_0xe57ee2=Date['now'](),_0x1bf374=isTwoPlayerMode&&selectedGameMode===_0x422579(0x99)&&level===0x1&&coopPlayersReadyStartTime>0x0&&_0xe57ee2<coopPlayersReadyStartTime+0x1f40;if(_0x1bf374)return![];let _0x29dd64=![],_0x4aca5f=null,_0x583ff9=![],_0x4793e7=0x0,_0x1fd5b8=_0x31325d=>{},_0x1c9c0a=_0x555bb8=>{},_0x5ebe64=![],_0x7cf099=()=>![],_0x1bb89a=_0x5a15c0=>{},_0xe7e714=_0x83798a;const _0xbc15d6=!isPaused&&isInGameState&&gameOverSequenceStartTime===0x0&&!isShowingPlayerGameOverMessage&&!isShowingIntro&&!showReadyMessage&&!isCsCompletionDelayActive&&!showCsHitsMessage&&!showPerfectMessage&&!showCsBonusScoreMessage&&!showCSClearMessage&&!(isTwoPlayerMode&&selectedGameMode===_0x422579(0x99)&&(_0x83798a===_0x422579(0x10c)&&isPlayer1ShowingGameOverMessage||_0x83798a==='player2'&&isPlayer2ShowingGameOverMessage));if(!_0xbc15d6)return![];if(isTwoPlayerMode&&selectedGameMode==='coop'){if(_0x83798a===_0x422579(0x10c)&&ship1&&player1Lives>0x0&&!isPlayer1ShipCaptured&&!player1NeedsRespawnAfterCapture)(!isShowingCaptureMessage||isShowingCaptureMessage&&!isPlayer1ShipCaptured)&&(_0x4aca5f=ship1,_0x583ff9=player1IsDualShipActive,_0x4793e7=player1LastShotTime,_0x1fd5b8=_0x46ceee=>{player1LastShotTime=_0x46ceee;},_0x1c9c0a=_0x11672a=>{player1ShotsFired+=_0x11672a;},_0x5ebe64=selectedFiringMode==='single',_0x7cf099=()=>p1JustFiredSingle,_0x1bb89a=_0x384430=>{p1JustFiredSingle=_0x384430;},_0x29dd64=!![]);else _0x83798a===_0x422579(0xf1)&&ship2&&player2Lives>0x0&&!isPlayer2ShipCaptured&&!player2NeedsRespawnAfterCapture&&((!isShowingCaptureMessage||isShowingCaptureMessage&&!isPlayer2ShipCaptured)&&(_0x4aca5f=ship2,_0x583ff9=player2IsDualShipActive,_0x4793e7=player2LastShotTime,_0x1fd5b8=_0x2b8455=>{player2LastShotTime=_0x2b8455;},_0x1c9c0a=_0x4dc3c5=>{player2ShotsFired+=_0x4dc3c5;},isPlayerTwoAI&&selectedOnePlayerGameVariant===_0x422579(0x165)?_0x5ebe64=![]:(_0x5ebe64=selectedFiringMode==='single',_0x7cf099=()=>p2JustFiredSingle,_0x1bb89a=_0x5671db=>{p2JustFiredSingle=_0x5671db;}),_0x29dd64=!![]));}else{if(ship&&playerLives>0x0&&!isShipCaptured){_0x4aca5f=ship,_0x583ff9=isDualShipActive;if(isTwoPlayerMode&&selectedGameMode===_0x422579(0x156)){if(currentPlayer===0x1){_0x4793e7=player1LastShotTime,_0x1fd5b8=_0x3fee87=>{player1LastShotTime=_0x3fee87;},_0x1c9c0a=_0x48d12d=>{player1ShotsFired+=_0x48d12d;},_0x5ebe64=selectedFiringMode==='single',_0x7cf099=()=>p1JustFiredSingle,_0x1bb89a=_0x727a0f=>{p1JustFiredSingle=_0x727a0f;};if(!_0xe7e714)_0xe7e714='player1';}else{_0x4793e7=player2LastShotTime,_0x1fd5b8=_0x58866f=>{player2LastShotTime=_0x58866f;},_0x1c9c0a=_0x26e7ba=>{player2ShotsFired+=_0x26e7ba;};if(isPlayerTwoAI){_0x5ebe64=![];if(!_0xe7e714)_0xe7e714=_0x422579(0xed);}else{_0x5ebe64=selectedFiringMode===_0x422579(0xa5);connectedGamepadIndexP2===null&&connectedGamepadIndex!==null?(_0x7cf099=()=>p1JustFiredSingle,_0x1bb89a=_0x1cb123=>{p1JustFiredSingle=_0x1cb123;}):(_0x7cf099=()=>p2JustFiredSingle,_0x1bb89a=_0x310004=>{p2JustFiredSingle=_0x310004;});if(!_0xe7e714)_0xe7e714=_0x422579(0xf1);}}}else{_0x4793e7=player1LastShotTime,_0x1fd5b8=_0x5c79a4=>{player1LastShotTime=_0x5c79a4;},_0x1c9c0a=_0xd8ad77=>{player1ShotsFired+=_0xd8ad77;},_0x5ebe64=selectedFiringMode===_0x422579(0xa5),_0x7cf099=()=>p1JustFiredSingle,_0x1bb89a=_0x4fc542=>{p1JustFiredSingle=_0x4fc542;};if(!_0xe7e714)_0xe7e714='player1';}_0x29dd64=!![];}}_0x83798a===null&&!isManualControl&&!isCoopAIDemoActive&&ship&&playerLives>0x0&&!isShipCaptured&&!isShowingCaptureMessage&&(_0x4aca5f=ship,_0x583ff9=isDualShipActive,_0x4793e7=aiLastShotTime,_0x1fd5b8=_0x4cbf67=>{aiLastShotTime=_0x4cbf67;},_0x1c9c0a=_0x4e28e7=>{player1ShotsFired+=_0x4e28e7;},_0x5ebe64=![],_0x29dd64=!![],_0xe7e714='ai');if(!_0x29dd64||!_0x4aca5f)return![];const _0x53ee66=isManualControl||isPlayerTwoAI&&selectedGameMode==='normal'&&currentPlayer===0x2||isPlayerTwoAI&&selectedOnePlayerGameVariant==='1P_VS_AI_COOP'&&_0x83798a==='player1';if(_0x5ebe64){if(_0x4d4941){if(_0xe57ee2-_0x4793e7<SHOOT_COOLDOWN)return![];}else{let _0x119928=![];if(_0xe7e714===_0x422579(0x10c)||!isTwoPlayerMode&&_0xe7e714===_0x422579(0x10c))_0x119928=keyboardP1ShootDown||connectedGamepadIndex!==null&&navigator[_0x422579(0x92)]()?.[connectedGamepadIndex]?.['buttons'][PS5_BUTTON_CROSS]?.[_0x422579(0x1b4)];else{if(_0xe7e714===_0x422579(0xf1)&&!isPlayerTwoAI){if(connectedGamepadIndexP2!==null)_0x119928=keyboardP2ShootDown||connectedGamepadIndexP2!==null&&navigator['getGamepads']()?.[connectedGamepadIndexP2]?.[_0x422579(0x1af)][PS5_BUTTON_CROSS]?.[_0x422579(0x1b4)];else connectedGamepadIndex!==null?_0x119928=keyboardP2ShootDown||connectedGamepadIndex!==null&&navigator[_0x422579(0x92)]()?.[connectedGamepadIndex]?.[_0x422579(0x1af)][PS5_BUTTON_CROSS]?.['pressed']:_0x119928=keyboardP2ShootDown;}}if(_0x7cf099()){if(_0x119928)return![];else _0x1bb89a(![]);}if(_0xe57ee2-_0x4793e7<SHOOT_COOLDOWN)return![];}}else{if(_0xe57ee2-_0x4793e7<SHOOT_COOLDOWN)return![];}try{const _0x34b345=_0x4aca5f['y'];let _0x53b026=0x0;if(_0x583ff9){const _0x305cc9=_0x4aca5f['x']+_0x4aca5f[_0x422579(0x1c4)]/0x2,_0x1aa8e1=_0x4aca5f['x']+DUAL_SHIP_OFFSET_X+_0x4aca5f[_0x422579(0x1c4)]/0x2,_0x3528b4=_0x305cc9-PLAYER_BULLET_WIDTH/0x2,_0xa213e6=_0x1aa8e1-PLAYER_BULLET_WIDTH/0x2;bullets[_0x422579(0xd2)]({'x':_0x3528b4,'y':_0x34b345,'width':PLAYER_BULLET_WIDTH,'height':PLAYER_BULLET_HEIGHT,'speed':PLAYER_BULLET_SPEED,'playerId':_0xe7e714}),bullets[_0x422579(0xd2)]({'x':_0xa213e6,'y':_0x34b345,'width':PLAYER_BULLET_WIDTH,'height':PLAYER_BULLET_HEIGHT,'speed':PLAYER_BULLET_SPEED,'playerId':_0xe7e714}),_0x53b026=0x2;}else{const _0x501b27=_0x4aca5f['x']+_0x4aca5f[_0x422579(0x1c4)]/0x2-PLAYER_BULLET_WIDTH/0x2;bullets[_0x422579(0xd2)]({'x':_0x501b27,'y':_0x34b345,'width':PLAYER_BULLET_WIDTH,'height':PLAYER_BULLET_HEIGHT,'speed':PLAYER_BULLET_SPEED,'playerId':_0xe7e714}),_0x53b026=0x1;}if(_0x5ebe64&&!_0x4d4941)_0x1bb89a(!![]);return playSound(_0x422579(0x10a),![],0.4),_0x1c9c0a(_0x53b026),_0x1fd5b8(_0xe57ee2),!![];}catch(_0x9f5d05){return console['error'](_0x422579(0x166),_0x9f5d05),![];}}function handlePlayerInput(){const _0x1afcb4=_0x571912;try{const _0x4e78bc=Date[_0x1afcb4(0x1a6)](),_0x157e4f=isTwoPlayerMode&&selectedGameMode===_0x1afcb4(0x99)&&level===0x1&&coopPlayersReadyStartTime>0x0&&_0x4e78bc<coopPlayersReadyStartTime+0x1f40;if(isCoopAIDemoActive||isPlayerTwoAI&&selectedGameMode===_0x1afcb4(0x156)&&currentPlayer===0x2&&!isManualControl){isCoopAIDemoActive&&(leftPressed=![],rightPressed=![],shootPressed=![],p2LeftPressed=![],p2RightPressed=![],p2ShootPressed=![]);return;}let _0x18c70c=isPaused||!isManualControl||!gameCanvas||!isInGameState||gameOverSequenceStartTime>0x0||isShowingPlayerGameOverMessage||isTwoPlayerMode&&selectedGameMode===_0x1afcb4(0x99)&&(isPlayer1ShowingGameOverMessage||isPlayer2ShowingGameOverMessage);if(_0x18c70c){keyboardP1LeftDown=![],keyboardP1RightDown=![],keyboardP1ShootDown=![],keyboardP2LeftDown=![],keyboardP2RightDown=![],keyboardP2ShootDown=![],leftPressed=![],rightPressed=![],shootPressed=![],p2LeftPressed=![],p2RightPressed=![],p2ShootPressed=![],p1FireInputWasDown=![],p2FireInputWasDown=![];return;}let _0x10e64a=0x0;if(isTouchActiveGame&&gameCanvas&&gameCanvas[_0x1afcb4(0x1c4)]>0x0){const _0x4fad55=gameCanvas['getBoundingClientRect'](),_0x1bf6f0=gameCanvas[_0x1afcb4(0x1c4)]/_0x4fad55[_0x1afcb4(0x1c4)];_0x10e64a=(touchCurrentX-_0x4fad55['left'])*_0x1bf6f0;}let _0x4c169d=![],_0x104d04=![],_0x41bf4e=![],_0x14bcc3=![],_0x53f916=![],_0xaae7aa=![];if(connectedGamepadIndex!==null){const _0x4348b1=navigator['getGamepads']();if(_0x4348b1?.[connectedGamepadIndex]){const _0x7c97e5=_0x4348b1[connectedGamepadIndex],_0x429983=processSingleController(_0x7c97e5,previousGameButtonStates);_0x4c169d=_0x429983[_0x1afcb4(0x159)],_0x104d04=_0x429983[_0x1afcb4(0x94)],_0x41bf4e=_0x429983['shoot'],previousGameButtonStates=_0x429983[_0x1afcb4(0xfc)]['slice']();if(_0x429983[_0x1afcb4(0xb3)]&&!isShowingCaptureMessage){togglePause();return;}if(_0x429983[_0x1afcb4(0xd7)]&&!isShowingCaptureMessage){stopGameAndShowMenu();return;}}else{if(previousGameButtonStates[_0x1afcb4(0x100)]>0x0)previousGameButtonStates=[];}}else{if(previousGameButtonStates['length']>0x0)previousGameButtonStates=[];}if(!(isPlayerTwoAI&&selectedOnePlayerGameVariant===_0x1afcb4(0x165))){if(isTwoPlayerMode&&connectedGamepadIndexP2!==null&&connectedGamepadIndexP2!==connectedGamepadIndex){const _0x5d3100=navigator[_0x1afcb4(0x92)]();if(_0x5d3100?.[connectedGamepadIndexP2]){const _0x2e0648=_0x5d3100[connectedGamepadIndexP2],_0x225e75=processSingleController(_0x2e0648,previousGameButtonStatesP2);_0x14bcc3=_0x225e75[_0x1afcb4(0x159)],_0x53f916=_0x225e75[_0x1afcb4(0x94)],_0xaae7aa=_0x225e75[_0x1afcb4(0x1a4)],previousGameButtonStatesP2=_0x225e75[_0x1afcb4(0xfc)][_0x1afcb4(0xfe)]();}else{if(previousGameButtonStatesP2[_0x1afcb4(0x100)]>0x0)previousGameButtonStatesP2=[];}}else{if(previousGameButtonStatesP2[_0x1afcb4(0x100)]>0x0)previousGameButtonStatesP2=[];}}const _0x521421=p1FireInputWasDown;p1FireInputWasDown=keyboardP1ShootDown||_0x41bf4e;let _0x28bafe=![];if(!(isPlayerTwoAI&&selectedOnePlayerGameVariant===_0x1afcb4(0x165))){_0x28bafe=p2FireInputWasDown;if(isTwoPlayerMode&&selectedGameMode===_0x1afcb4(0x156)&&currentPlayer===0x2&&!isPlayerTwoAI){if(connectedGamepadIndexP2!==null)p2FireInputWasDown=keyboardP2ShootDown||_0xaae7aa;else connectedGamepadIndex!==null?p2FireInputWasDown=keyboardP2ShootDown||_0x41bf4e:p2FireInputWasDown=keyboardP2ShootDown;}else p2FireInputWasDown=keyboardP2ShootDown||_0xaae7aa;}else p2FireInputWasDown=![];if(selectedFiringMode==='single'){if(isTwoPlayerMode&&selectedGameMode===_0x1afcb4(0x99)){if(!isTouchActiveGame){if(_0x521421&&!p1FireInputWasDown)p1JustFiredSingle=![];if(!isPlayerTwoAI&&_0x28bafe&&!p2FireInputWasDown)p2JustFiredSingle=![];}}else{if(isTwoPlayerMode&&selectedGameMode===_0x1afcb4(0x156)){if(!isTouchActiveGame){if(currentPlayer===0x1&&_0x521421&&!p1FireInputWasDown)p1JustFiredSingle=![];else{if(currentPlayer===0x2&&!isPlayerTwoAI){let _0x55dd1f=connectedGamepadIndexP2===null&&connectedGamepadIndex!==null,_0x13c0d4=connectedGamepadIndexP2===null&&connectedGamepadIndex!==null;_0x55dd1f&&_0x13c0d4?_0x521421&&!p1FireInputWasDown&&(p1JustFiredSingle=![]):_0x28bafe&&!p2FireInputWasDown&&(p2JustFiredSingle=![]);}}}}else{if(!isTouchActiveGame){if(_0x521421&&!p1FireInputWasDown)p1JustFiredSingle=![];}}}}leftPressed=![],rightPressed=![],shootPressed=![],p2LeftPressed=![],p2RightPressed=![],p2ShootPressed=![];let _0x3841f1=![];if(isTouchActiveGame&&gameCanvas){if(isTwoPlayerMode&&selectedGameMode===_0x1afcb4(0x99)){if(ship1&&player1Lives>0x0&&!isPlayer1ShipCaptured&&!isPlayer1WaitingForRespawn&&!isPlayer1ShowingGameOverMessage&&!player1NeedsRespawnAfterCapture){const _0xcd7ce0=ship1['width']+(player1IsDualShipActive?DUAL_SHIP_OFFSET_X:0x0);let _0x4c5cdb=_0x10e64a-_0xcd7ce0/0x2;_0x4c5cdb=Math[_0x1afcb4(0x14a)](0x0,Math[_0x1afcb4(0xf4)](gameCanvas['width']-_0xcd7ce0,_0x4c5cdb)),ship1['x']=_0x4c5cdb,ship1[_0x1afcb4(0x107)]=_0x4c5cdb,_0x3841f1=!![];}}else{if(ship&&playerLives>0x0&&!isShipCaptured&&!isShowingPlayerGameOverMessage&&gameOverSequenceStartTime===0x0&&(!isPlayerTwoAI||isPlayerTwoAI&&currentPlayer===0x1)){const _0x55668e=ship[_0x1afcb4(0x1c4)]+(isDualShipActive?DUAL_SHIP_OFFSET_X:0x0);let _0x3b007=_0x10e64a-_0x55668e/0x2;_0x3b007=Math[_0x1afcb4(0x14a)](0x0,Math[_0x1afcb4(0xf4)](gameCanvas[_0x1afcb4(0x1c4)]-_0x55668e,_0x3b007)),ship['x']=_0x3b007,ship[_0x1afcb4(0x107)]=_0x3b007,_0x3841f1=!![];}}}if(isTwoPlayerMode&&selectedGameMode===_0x1afcb4(0x99)){if(!_0x3841f1){const _0x46d138=ship1&&player1Lives>0x0&&!isPlayer1ShipCaptured&&!isPlayer1WaitingForRespawn&&!isPlayer1ShowingGameOverMessage&&!player1NeedsRespawnAfterCapture;_0x46d138&&(leftPressed=keyboardP1LeftDown||_0x4c169d,rightPressed=keyboardP1RightDown||_0x104d04);}if(!isPlayerTwoAI){const _0x18e5b8=ship2&&player2Lives>0x0&&!isPlayer2ShipCaptured&&!isPlayer2WaitingForRespawn&&!isPlayer2ShowingGameOverMessage&&!player2NeedsRespawnAfterCapture;_0x18e5b8&&(p2LeftPressed=keyboardP2LeftDown||_0x14bcc3,p2RightPressed=keyboardP2RightDown||_0x53f916);}}else{if(!_0x3841f1){const _0x24b34f=ship&&playerLives>0x0&&!isShipCaptured&&!isShowingPlayerGameOverMessage;if(_0x24b34f){if(currentPlayer===0x1||!isTwoPlayerMode)leftPressed=keyboardP1LeftDown||_0x4c169d,rightPressed=keyboardP1RightDown||_0x104d04;else{if(currentPlayer===0x2&&!isPlayerTwoAI&&selectedGameMode===_0x1afcb4(0x156)){if(connectedGamepadIndexP2!==null)leftPressed=keyboardP2LeftDown||_0x14bcc3,rightPressed=keyboardP2RightDown||_0x53f916;else connectedGamepadIndex!==null?(leftPressed=keyboardP2LeftDown||_0x4c169d,rightPressed=keyboardP2RightDown||_0x104d04):(leftPressed=keyboardP2LeftDown,rightPressed=keyboardP2RightDown);}}}}}if(isTwoPlayerMode&&selectedGameMode===_0x1afcb4(0x99)){const _0x37a9c2=ship1&&player1Lives>0x0&&!isPlayer1ShipCaptured&&!isPlayer1WaitingForRespawn&&!isPlayer1ShowingGameOverMessage&&!player1NeedsRespawnAfterCapture&&!_0x157e4f;if(_0x37a9c2){shootPressed=isTouchActiveGame&&selectedFiringMode===_0x1afcb4(0xe0)&&(!isPlayerTwoAI||isPlayerTwoAI&&selectedOnePlayerGameVariant===_0x1afcb4(0x165)&&_0x10e64a<=gameCanvas[_0x1afcb4(0x1c4)]/0x2)||p1FireInputWasDown;if(isShowingCaptureMessage&&isPlayer1ShipCaptured)shootPressed=![];}if(!isPlayerTwoAI){const _0x54bec9=ship2&&player2Lives>0x0&&!isPlayer2ShipCaptured&&!isPlayer2WaitingForRespawn&&!isPlayer2ShowingGameOverMessage&&!player2NeedsRespawnAfterCapture&&!_0x157e4f;if(_0x54bec9){p2ShootPressed=isTouchActiveGame&&selectedFiringMode==='rapid'&&_0x10e64a>gameCanvas[_0x1afcb4(0x1c4)]/0x2||p2FireInputWasDown;if(isShowingCaptureMessage&&isPlayer2ShipCaptured)p2ShootPressed=![];}}}else{const _0x331eae=ship&&playerLives>0x0&&!isShipCaptured&&!isShowingPlayerGameOverMessage&&!isShowingIntro&&!_0x157e4f;if(_0x331eae){let _0x5b5979=![];if(currentPlayer===0x1||!isTwoPlayerMode)_0x5b5979=p1FireInputWasDown;else currentPlayer===0x2&&!isPlayerTwoAI&&selectedGameMode==='normal'&&(_0x5b5979=p2FireInputWasDown);shootPressed=isTouchActiveGame&&selectedFiringMode==='rapid'||_0x5b5979;if(isShowingCaptureMessage&&isShipCaptured)shootPressed=![];}}if(isManualControl){if(isTwoPlayerMode&&selectedGameMode===_0x1afcb4(0x99))shootPressed&&firePlayerBullet(_0x1afcb4(0x10c),![]),!isPlayerTwoAI&&p2ShootPressed&&firePlayerBullet('player2',![]);else{if(shootPressed){if(isPlayerTwoAI&&selectedGameMode==='normal'&&currentPlayer===0x2){}else firePlayerBullet(currentPlayer===0x1||!isTwoPlayerMode?'player1':_0x1afcb4(0xf1),![]);}}}}catch(_0x2a3e67){console[_0x1afcb4(0x95)]('Error\x20handling\x20player\x20input:',_0x2a3e67),leftPressed=![],rightPressed=![],shootPressed=![],p2LeftPressed=![],p2RightPressed=![],p2ShootPressed=![],p1FireInputWasDown=![],p2FireInputWasDown=![],p1JustFiredSingle=![],p2JustFiredSingle=![];}}function _0x377a(_0x21c4e2,_0x186666){const _0x506244=_0x5062();return _0x377a=function(_0x377a0b,_0x534834){_0x377a0b=_0x377a0b-0x8c;let _0x41cff7=_0x506244[_0x377a0b];return _0x41cff7;},_0x377a(_0x21c4e2,_0x186666);}function aiControl(){const _0x582d33=_0x571912;try{if(isCoopAIDemoActive||isPlayerTwoAI&&selectedOnePlayerGameVariant===_0x582d33(0x165))return;let _0x5b2906=null,_0x192bfa=null,_0x57573e=![],_0x313ab7=![],_0x1c8ab9=![],_0x374d10=0x0,_0x510761='ai',_0x3759d6=![],_0x2518c3=![];if(isPlayerTwoAI&&selectedGameMode===_0x582d33(0x156)&&currentPlayer===0x2){if(!ship||playerLives<=0x0||isShipCaptured||isShowingPlayerGameOverMessage){if(ship)ship['targetX']=ship['x'];aiNeedsStabilization=!![],smoothedShipX=ship?ship['x']:gameCanvas?gameCanvas['width']/0x2:0x0;return;}_0x5b2906=ship,_0x192bfa=smoothedShipX,_0x57573e=isDualShipActive,_0x313ab7=isShipCaptured,_0x1c8ab9=isInvincible,_0x374d10=playerLives,_0x510761=_0x582d33(0xed),_0x3759d6=!![],_0x2518c3=playerLives>0x1&&!isDualShipActive;}else{if(!isManualControl&&!isPlayerTwoAI){if(playerLives<=0x0||!ship||!gameCanvas||!isInGameState||gameOverSequenceStartTime>0x0||isShowingPlayerGameOverMessage||isShipCaptured||isShowingCaptureMessage){if(ship)ship[_0x582d33(0x107)]=ship['x'];aiNeedsStabilization=!![],smoothedShipX=ship?ship['x']:gameCanvas?gameCanvas[_0x582d33(0x1c4)]/0x2:0x0;return;}_0x5b2906=ship,_0x192bfa=smoothedShipX,_0x57573e=isDualShipActive,_0x313ab7=isShipCaptured,_0x1c8ab9=isInvincible,_0x374d10=playerLives,_0x2518c3=playerLives>0x1&&!isDualShipActive;}else return;}if(_0x192bfa===undefined&&_0x5b2906)_0x192bfa=_0x5b2906['x'],(_0x3759d6||!isManualControl&&!isPlayerTwoAI)&&(smoothedShipX=_0x192bfa);else{if(_0x192bfa===undefined&&!_0x5b2906){_0x192bfa=gameCanvas?gameCanvas[_0x582d33(0x1c4)]/0x2:0x0;(_0x3759d6||!isManualControl&&!isPlayerTwoAI)&&(smoothedShipX=_0x192bfa);return;}}const _0x53db3f=Date['now'](),_0x523632=gameCanvas['width'],_0x3c548c=gameCanvas[_0x582d33(0x120)];let _0xaf3ff5=_0x5b2906['width'];_0x57573e&&(_0xaf3ff5=DUAL_SHIP_OFFSET_X+_0x5b2906[_0x582d33(0x1c4)]);const _0x1eae28=_0x5b2906['x']+_0xaf3ff5/0x2,_0x47c5fe=_0x5b2906['y'],_0x383a68=_0x523632/0x2,_0x1f621c=_0x383a68-_0xaf3ff5/0x2,_0x4ba322=showReadyMessage||showCSClearMessage||showCsHitsMessage||showPerfectMessage||showCsBonusScoreMessage||showExtraLifeMessage||isCsCompletionDelayActive||isShowingCaptureMessage||isShowingIntro;let _0xb7924c=_0x192bfa,_0x4e7697=![],_0x118eee=![],_0x2ad4ea=_0x192bfa,_0x329dc7=null,_0x4a00f1=![];const _0x41598f=_0x57573e;aiNeedsStabilization&&!_0x4ba322&&(aiStabilizationEndTime=_0x53db3f+AI_STABILIZATION_DURATION,aiNeedsStabilization=![],_0x192bfa=_0x5b2906['x'],(_0x3759d6||!isManualControl&&!isPlayerTwoAI)&&(smoothedShipX=_0x192bfa));if(_0x53db3f<aiStabilizationEndTime&&!_0x4ba322)_0xb7924c=_0x1f621c;else{if(!_0x4ba322){_0x118eee=![],_0x2ad4ea=_0x192bfa;if(!_0x1c8ab9){let _0x1bdb37=[];const _0x53461d=isChallengingStage?FINAL_DODGE_LOOKAHEAD*0.9:isEntrancePhaseActive?ENTRANCE_BULLET_DODGE_LOOKAHEAD*1.1:FINAL_DODGE_LOOKAHEAD*1.2,_0xeab756=isChallengingStage?FINAL_DODGE_BUFFER_BASE*0.9:isEntrancePhaseActive?ENTRANCE_BULLET_DODGE_BUFFER*1.1:FINAL_DODGE_BUFFER_BASE*1.2,_0x32adfe={'x':_0x5b2906['x']-_0xeab756,'y':_0x5b2906['y']-_0x53461d,'width':_0xaf3ff5+_0xeab756*0x2,'height':_0x53461d+_0x5b2906[_0x582d33(0x120)]};for(const _0x5d8577 of enemyBullets){if(_0x5d8577&&_0x5d8577['y']+_0x5d8577['height']>_0x5b2906['y']-_0x5b2906['height']*0x2&&_0x5d8577['y']<_0x3c548c){const _0x59d21b={'x':_0x5d8577['x'],'y':_0x5d8577['y'],'width':_0x5d8577[_0x582d33(0x1c4)],'height':_0x5d8577['height']};checkCollision(_0x32adfe,_0x59d21b)&&_0x1bdb37['push'](_0x5d8577);}}if(_0x1bdb37[_0x582d33(0x100)]>0x0){_0x118eee=!![];let _0x1df9bc=_0x192bfa,_0x32ed94=-Infinity;for(let _0x260f7f=-0x1;_0x260f7f<=0x1;_0x260f7f+=0x2){const _0x106d04=_0xaf3ff5*(0x2+Math[_0x582d33(0xcb)]()*0.5)+(_0x1bdb37[_0x582d33(0x100)]>0x1?_0xaf3ff5*0.5:0x0);let _0x285afa=_0x192bfa+_0x260f7f*_0x106d04;_0x285afa=Math[_0x582d33(0x14a)](AI_ANTI_CORNER_BUFFER,Math[_0x582d33(0xf4)](_0x523632-_0xaf3ff5-AI_ANTI_CORNER_BUFFER,_0x285afa));let _0x24c8b5=0x0;const _0x59dabf={'x':_0x285afa-_0xeab756/0x2,'y':_0x5b2906['y']-_0x53461d,'width':_0xaf3ff5+_0xeab756,'height':_0x53461d+_0x5b2906[_0x582d33(0x120)]};for(const _0x4ee1af of _0x1bdb37){checkCollision(_0x59dabf,{'x':_0x4ee1af['x'],'y':_0x4ee1af['y'],'width':_0x4ee1af[_0x582d33(0x1c4)],'height':_0x4ee1af[_0x582d33(0x120)]})&&_0x24c8b5++;}let _0x560648=-_0x24c8b5;if(Math[_0x582d33(0x101)](_0x285afa-_0x192bfa)<_0xaf3ff5*0.5)_0x560648-=0xa;_0x560648>_0x32ed94&&(_0x32ed94=_0x560648,_0x1df9bc=_0x285afa);}_0x2ad4ea=_0x1df9bc;}if(!_0x118eee){const _0xa46354=AI_COLLISION_LOOKAHEAD*1.5,_0x4ea6ec=FINAL_DODGE_BUFFER_BASE*1.5;for(const _0x276d95 of enemies){if(_0x276d95&&(_0x276d95[_0x582d33(0x106)]===_0x582d33(0xeb)||_0x276d95[_0x582d33(0x106)]===_0x582d33(0xd5)||_0x276d95['state']===_0x582d33(0xd3)||_0x276d95[_0x582d33(0x106)]===_0x582d33(0x18f))&&_0x276d95['y']+_0x276d95[_0x582d33(0x120)]>_0x5b2906['y']-_0xa46354/0x2&&_0x276d95['y']<_0x5b2906['y']+_0x5b2906[_0x582d33(0x120)]){const _0x3cb6df={'x':_0x5b2906['x']-_0x4ea6ec,'y':_0x5b2906['y']-_0xa46354,'width':_0xaf3ff5+_0x4ea6ec*0x2,'height':_0xa46354+_0x5b2906[_0x582d33(0x120)]},_0x59d101={'x':_0x276d95['x'],'y':_0x276d95['y'],'width':_0x276d95[_0x582d33(0x1c4)],'height':_0x276d95[_0x582d33(0x120)]};if(checkCollision(_0x3cb6df,_0x59d101)){_0x118eee=!![];const _0x2a6150=_0x276d95['x']+_0x276d95[_0x582d33(0x1c4)]/0x2,_0x482bd4=_0x1eae28<_0x2a6150?-0x1:0x1,_0x1e19d1=_0xaf3ff5*(2.2+Math[_0x582d33(0xcb)]()*0.6);_0x2ad4ea=_0x192bfa+_0x482bd4*_0x1e19d1;break;}}}}}if(_0x118eee)_0xb7924c=Math[_0x582d33(0x14a)](AI_ANTI_CORNER_BUFFER,Math[_0x582d33(0xf4)](_0x523632-_0xaf3ff5-AI_ANTI_CORNER_BUFFER,_0x2ad4ea)),_0x329dc7=null,_0x4e7697=![];else{if(fallingShips[_0x582d33(0x100)]>0x0&&!_0x313ab7&&!isWaitingForRespawn&&!_0x57573e){let _0x559478=null,_0x30d10e=Infinity;for(const _0x260a0f of fallingShips){if(_0x260a0f&&!_0x260a0f[_0x582d33(0x18a)]){const _0x300d63=Math[_0x582d33(0x101)](_0x260a0f['x']+_0x260a0f[_0x582d33(0x1c4)]/0x2-_0x1eae28)+Math[_0x582d33(0x101)](_0x260a0f['y']-_0x5b2906['y']);_0x300d63<_0x30d10e&&(_0x30d10e=_0x300d63,_0x559478=_0x260a0f);}}_0x559478&&(_0xb7924c=_0x559478['x']+_0x559478[_0x582d33(0x1c4)]/0x2-_0xaf3ff5/0x2,_0x4e7697=![],_0x329dc7=null);}else{_0x4a00f1=![];if(_0x2518c3&&captureBeamActive&&capturingBossId&&!_0x313ab7&&!isWaitingForRespawn){const _0x5c9619=enemies[_0x582d33(0x19b)](_0xce38b0=>_0xce38b0['id']===capturingBossId&&_0xce38b0['type']===ENEMY3_TYPE&&_0xce38b0[_0x582d33(0x106)]===_0x582d33(0x113));if(_0x5c9619){const _0x158a4e=_0x5c9619['x']+(_0x5c9619['type']===ENEMY3_TYPE?BOSS_WIDTH:ENEMY_WIDTH)/0x2,_0x5d64da=Math['abs'](_0x1eae28-_0x158a4e);_0x5d64da<_0xaf3ff5*0.8&&_0x53db3f-(_0x5c9619['captureStartTime']||0x0)>=AI_CAPTURE_BEAM_APPROACH_DELAY_MS&&(_0xb7924c=_0x158a4e-_0xaf3ff5/0x2,_0x4e7697=![],_0x329dc7=null,_0x4a00f1=!![]);}}if(!_0x4a00f1){_0x329dc7=null;let _0x59a28c=-Infinity;for(const _0xf3f57e of enemies){if(!_0xf3f57e)continue;let _0x4e7442=0x0;const _0xb60a6=_0xf3f57e['x']+_0xf3f57e[_0x582d33(0x1c4)]/0x2,_0x5d0fde=_0xb60a6-_0x1eae28,_0x68a5b0=_0x47c5fe-(_0xf3f57e['y']+_0xf3f57e['height']);if(_0x68a5b0<0x0&&_0xf3f57e['state']!==_0x582d33(0xeb)&&_0xf3f57e[_0x582d33(0x106)]!==_0x582d33(0xd5)&&_0xf3f57e[_0x582d33(0x106)]!==_0x582d33(0x18f))continue;_0x4e7442=(_0x3c548c-_0xf3f57e['y'])*0x2-Math[_0x582d33(0x101)](_0x5d0fde)*0x3-_0x68a5b0;if(_0xf3f57e[_0x582d33(0x106)]===_0x582d33(0xeb)||_0xf3f57e[_0x582d33(0x106)]===_0x582d33(0xd5))_0x4e7442+=0xbb8;if(_0xf3f57e[_0x582d33(0x9f)]===ENEMY3_TYPE&&!_0xf3f57e[_0x582d33(0x1a1)])_0x4e7442+=0x7d0;if(_0xf3f57e[_0x582d33(0x9f)]===ENEMY3_TYPE&&_0xf3f57e['isDamaged'])_0x4e7442+=0xfa0;if(_0xf3f57e[_0x582d33(0x9f)]===ENEMY3_TYPE&&_0xf3f57e['hasCapturedShip'])_0x4e7442+=0x1388;_0x4e7442>_0x59a28c&&(_0x59a28c=_0x4e7442,_0x329dc7=_0xf3f57e);}if(_0x329dc7){const _0x1e7837=_0x329dc7['x']+_0x329dc7[_0x582d33(0x1c4)]/0x2;_0xb7924c=_0x1e7837-_0xaf3ff5/0x2;const _0x4b09e4=1.8;let _0x3342af;if(isChallengingStage)_0x3342af=_0xaf3ff5*2.5;else _0x329dc7[_0x582d33(0x106)]===_0x582d33(0x9d)||_0x329dc7[_0x582d33(0x106)]==='preparing_capture'?_0x3342af=_0xaf3ff5*(GRID_SHOOT_ALIGNMENT_FACTOR*_0x4b09e4):_0x3342af=_0xaf3ff5*(FINAL_SHOOT_ALIGNMENT_THRESHOLD*_0x4b09e4);const _0x5f3e11=Math[_0x582d33(0x101)](_0x1eae28-_0x1e7837);if(_0x5f3e11<_0x3342af){let _0x4a509e=![];_0x2518c3&&_0x329dc7[_0x582d33(0x9f)]===ENEMY3_TYPE&&!_0x329dc7[_0x582d33(0x1b9)]&&!captureAttemptMadeThisLevel&&!isFullGridWave&&(_0x329dc7[_0x582d33(0x106)]===_0x582d33(0x9d)||_0x329dc7['state']===_0x582d33(0x13d)||_0x329dc7['state']===_0x582d33(0xd5))&&(_0x4a509e=!![]),!_0x4a509e&&(_0x4e7697=!![]);}}else _0xb7924c=_0x1f621c,_0x4e7697=![];}}}}}if(_0x5b2906){_0x192bfa+=(_0xb7924c-_0x192bfa)*AI_SMOOTHING_FACTOR_MOVE,_0x5b2906[_0x582d33(0x107)]=_0x192bfa;if(_0x3759d6)smoothedShipX=_0x192bfa;else!isManualControl&&!isPlayerTwoAI&&(smoothedShipX=_0x192bfa);}if(_0x4e7697&&!_0x118eee&&!_0x4a00f1&&!_0x4ba322){let _0x4024c4=![];_0x3759d6?_0x4024c4=!![]:_0x53db3f>=aiCanShootTime&&(_0x4024c4=!![]),_0x4024c4&&!isShowingIntro&&(firePlayerBullet(_0x510761,![])&&(!_0x3759d6&&(aiCanShootTime=_0x53db3f+SHOOT_COOLDOWN)));}}catch(_0xec3735){console['error']('Error\x20in\x20aiControl:',_0xec3735,_0xec3735['stack']),ship&&(ship[_0x582d33(0x107)]=ship['x']),aiNeedsStabilization=!![],smoothedShipX=ship?ship['x']:gameCanvas?gameCanvas[_0x582d33(0x1c4)]/0x2:0x0;}}function aiControlCoop(){const _0x138889=_0x571912;if(!(isCoopAIDemoActive||isPlayerTwoAI&&selectedOnePlayerGameVariant==='1P_VS_AI_COOP')||isPaused||!gameCanvas||!isInGameState||gameOverSequenceStartTime>0x0){if(ship1)ship1['targetX']=ship1['x'];if(ship2)ship2['targetX']=ship2['x'];return;}const _0x318da5=Date['now'](),_0x1d4cf1=gameCanvas[_0x138889(0x1c4)],_0x5d43a9=isPlayerTwoAI&&selectedOnePlayerGameVariant===_0x138889(0x165),_0x1529f8=ship1&&player1Lives>0x0&&!isPlayer1ShipCaptured&&!isPlayer1WaitingForRespawn&&!isPlayer1ShowingGameOverMessage&&!player1NeedsRespawnAfterCapture,_0x3da088=ship2&&player2Lives>0x0&&!isPlayer2ShipCaptured&&!isPlayer2WaitingForRespawn&&!isPlayer2ShowingGameOverMessage&&!player2NeedsRespawnAfterCapture,_0x2bdd65=_0x2bc91c=>{const _0x578815=_0x138889,_0x31a183=_0x2bc91c==='p1'&&isPlayer1ShowingGameOverMessage||_0x2bc91c==='p2'&&isPlayer2ShowingGameOverMessage;return _0x31a183||showReadyMessage||isCsCompletionDelayActive||isShowingIntro&&!(level===0x1&&coopPlayersReadyStartTime>0x0&&(isCoopAIDemoActive||isPlayerTwoAI&&selectedOnePlayerGameVariant===_0x578815(0x165)));};let _0xe0ef5e=!![],_0x12114b=!![];if(coopAICaptureDiveAnticipationActive&&_0x318da5<coopAICaptureDiveAnticipationEndTime){if(!_0x5d43a9)_0xe0ef5e=![];_0x12114b=![];}else coopAICaptureDiveAnticipationActive&&(coopAICaptureDiveAnticipationActive=![],coopAICaptureDiveAnticipationEndTime=0x0);if(_0x1529f8&&ship1&&!_0x5d43a9){if(smoothedShip1X===undefined)smoothedShip1X=ship1['x'];const _0x320f47=_0x2bdd65('p1');let {desiredTargetX:_0x33af63,shouldTryShoot:_0x46c8a5,targetEnemyForAI:_0x3f302d}=calculateAIDesiredState(ship1,smoothedShip1X,player1IsDualShipActive,enemies,enemyBullets,fallingShips,isPlayer1Invincible,isPlayer1ShipCaptured,isPlayer1WaitingForRespawn,_0x318da5,_0x1d4cf1,_0x320f47,'p1');aiShip1TargetEnemy=_0x3f302d,smoothedShip1X+=(_0x33af63-smoothedShip1X)*AI_SMOOTHING_FACTOR_MOVE,ship1[_0x138889(0x107)]=smoothedShip1X;const _0x68ece=_0x3f302d&&_0x3f302d['type']===ENEMY3_TYPE&&_0x3f302d[_0x138889(0x1b9)]&&_0x3f302d['id']===capturedBossIdWithMessage&&isPlayer2ShipCaptured;if(_0x46c8a5&&_0xe0ef5e&&!(isShowingCaptureMessage&&isPlayer1ShipCaptured)){if(_0x68ece||_0x318da5>=aiShip1CanShootTime){fireCoopAIBullet(ship1,player1IsDualShipActive,'player1');if(!_0x68ece)aiShip1CanShootTime=_0x318da5+SHOOT_COOLDOWN;else aiShip1CanShootTime=_0x318da5+SHOOT_COOLDOWN/0x2;}}}if(_0x3da088&&ship2){if(smoothedShip2X===undefined)smoothedShip2X=ship2['x'];const _0x813e7a=_0x2bdd65('p2');let {desiredTargetX:_0xc02db3,shouldTryShoot:_0xb7c518,targetEnemyForAI:_0x41e370}=calculateAIDesiredState(ship2,smoothedShip2X,player2IsDualShipActive,enemies,enemyBullets,fallingShips,isPlayer2Invincible,isPlayer2ShipCaptured,isPlayer2WaitingForRespawn,_0x318da5,_0x1d4cf1,_0x813e7a,'p2');aiShip2TargetEnemy=_0x41e370,smoothedShip2X+=(_0xc02db3-smoothedShip2X)*AI_SMOOTHING_FACTOR_MOVE,ship2[_0x138889(0x107)]=smoothedShip2X;const _0x1feb6c=_0x41e370&&_0x41e370[_0x138889(0x9f)]===ENEMY3_TYPE&&_0x41e370[_0x138889(0x1b9)]&&_0x41e370['id']===capturedBossIdWithMessage&&isPlayer1ShipCaptured;if(_0xb7c518&&_0x12114b&&!(isShowingCaptureMessage&&isPlayer2ShipCaptured)){if(_0x1feb6c||_0x318da5>=aiShip2CanShootTime){fireCoopAIBullet(ship2,player2IsDualShipActive,isCoopAIDemoActive?_0x138889(0xf1):'ai_p2');if(!_0x1feb6c)aiShip2CanShootTime=_0x318da5+SHOOT_COOLDOWN;else aiShip2CanShootTime=_0x318da5+SHOOT_COOLDOWN/0x2;}}}}function fireCoopAIBullet(_0x4a6e13,_0x7b4579,_0xfff224){const _0x5eb011=_0x571912;if(!_0x4a6e13)return![];const _0x5c9265=Date['now']();let _0xe6afa7=![];if(_0xfff224===_0x5eb011(0x10c)&&isPlayer1ShowingGameOverMessage)_0xe6afa7=!![];if((_0xfff224===_0x5eb011(0xf1)||_0xfff224==='ai_p2')&&isPlayer2ShowingGameOverMessage)_0xe6afa7=!![];let _0x5c1bf3=isPaused||!isInGameState||gameOverSequenceStartTime>0x0||_0xe6afa7;if(_0x5c1bf3)return![];if(_0xfff224===_0x5eb011(0x10c)&&isPlayer1ShipCaptured)return![];if((_0xfff224===_0x5eb011(0xf1)||_0xfff224==='ai_p2')&&isPlayer2ShipCaptured)return![];try{const _0x508c05=_0x4a6e13['y'];let _0x4a8212=0x0;const _0xec4e21=_0xfff224;if(_0x7b4579){const _0x687974=_0x4a6e13['x']+_0x4a6e13[_0x5eb011(0x1c4)]/0x2,_0x24a677=_0x4a6e13['x']+DUAL_SHIP_OFFSET_X+_0x4a6e13[_0x5eb011(0x1c4)]/0x2,_0x34f022=_0x687974-PLAYER_BULLET_WIDTH/0x2,_0xaafffc=_0x24a677-PLAYER_BULLET_WIDTH/0x2;bullets['push']({'x':_0x34f022,'y':_0x508c05,'width':PLAYER_BULLET_WIDTH,'height':PLAYER_BULLET_HEIGHT,'speed':PLAYER_BULLET_SPEED,'playerId':_0xec4e21}),bullets[_0x5eb011(0xd2)]({'x':_0xaafffc,'y':_0x508c05,'width':PLAYER_BULLET_WIDTH,'height':PLAYER_BULLET_HEIGHT,'speed':PLAYER_BULLET_SPEED,'playerId':_0xec4e21}),_0x4a8212=0x2;}else{const _0x15c792=_0x4a6e13['x']+_0x4a6e13['width']/0x2-PLAYER_BULLET_WIDTH/0x2;bullets[_0x5eb011(0xd2)]({'x':_0x15c792,'y':_0x508c05,'width':PLAYER_BULLET_WIDTH,'height':PLAYER_BULLET_HEIGHT,'speed':PLAYER_BULLET_SPEED,'playerId':_0xec4e21}),_0x4a8212=0x1;}playSound(_0x5eb011(0x10a),![],0.4);if(_0xfff224===_0x5eb011(0x10c))player1ShotsFired+=_0x4a8212,player1LastShotTime=_0x5c9265,aiShip1LastShotTime=_0x5c9265;else(_0xfff224===_0x5eb011(0xf1)||_0xfff224===_0x5eb011(0xed))&&(player2ShotsFired+=_0x4a8212,player2LastShotTime=_0x5c9265,aiShip2LastShotTime=_0x5c9265);return!![];}catch(_0xe62259){return console[_0x5eb011(0x95)](_0x5eb011(0x1b5)+_0xfff224+':',_0xe62259),![];}}function calculateAIDesiredState(_0x1364cd,_0x4111f4,_0x3981b5,_0x2dc4a1,_0x1eab66,_0x532a86,_0x47780a,_0x21d342,_0xf7d7ac,_0x299997,_0x5e44b7,_0x14d1f4,_0x385119){const _0x5cb21d=_0x571912;let _0x93b38f=_0x4111f4,_0x95e446=![],_0x1417bd=null,_0x4f8f09=![],_0x5d40ee=![],_0x3d54fd=![],_0x443aff=![];const _0x502815=gameCanvas[_0x5cb21d(0x120)],_0x41addc=_0x1364cd[_0x5cb21d(0x1c4)]+(_0x3981b5?DUAL_SHIP_OFFSET_X:0x0),_0x5607ce=_0x1364cd['x']+_0x41addc/0x2,_0x827401=_0x1364cd['y'],_0x1b64a0=_0x385119==='p1'?player1Lives:_0x385119===_0x5cb21d(0xed)||_0x385119==='p2'?player2Lives:0x0,_0x286d8c=_0x1b64a0>0x1&&!_0x3981b5;let _0x4c34ac=_0x5e44b7/0x2;const _0x4ff556=isShowingIntro||isShowingCoopPlayersReady,_0x351349=isCoopAIDemoActive&&_0x4ff556&&!(isChallengingStage&&isEntrancePhaseActive),_0x56c767=isCoopAIDemoActive&&(_0x385119==='p1'&&player1Lives>0x0&&player2Lives<=0x0||(_0x385119==='p2'||_0x385119===_0x5cb21d(0xed))&&player2Lives>0x0&&player1Lives<=0x0);if(_0x351349&&_0x56c767)_0x4c34ac=_0x5e44b7/0x2;else{if(_0x385119==='p1')_0x4c34ac=_0x5e44b7*0.25+Math['sin'](_0x299997/(AI_WIGGLE_PERIOD*1.1))*(AI_WIGGLE_AMPLITUDE*0.8);else(_0x385119==='p2'||_0x385119===_0x5cb21d(0xed))&&(_0x4c34ac=_0x5e44b7*0.75+Math[_0x5cb21d(0xca)](_0x299997/(AI_WIGGLE_PERIOD*0.9))*(AI_WIGGLE_AMPLITUDE*0.8));}let _0xbce104=_0x4c34ac-_0x41addc/0x2;if(_0x14d1f4||_0x21d342||_0xf7d7ac||_0x385119==='p1'&&player1NeedsRespawnAfterCapture||(_0x385119==='p2'||_0x385119===_0x5cb21d(0xed))&&player2NeedsRespawnAfterCapture)return _0x351349&&_0x56c767?_0x93b38f=_0xbce104:_0x93b38f=_0xbce104,(_0x21d342||_0xf7d7ac||_0x385119==='p1'&&player1NeedsRespawnAfterCapture||(_0x385119==='p2'||_0x385119==='ai_p2')&&player2NeedsRespawnAfterCapture)&&(_0x93b38f=_0x1364cd['x']),{'desiredTargetX':_0x93b38f,'shouldTryShoot':![],'targetEnemyForAI':null};const _0x28c349=_0x385119==='p1'?'p2':'p1',_0x674c2f=_0x28c349==='p1'&&isPlayer1ShipCaptured||_0x28c349==='p2'&&isPlayer2ShipCaptured,_0x3cd3a1=_0x28c349==='p1'&&isPlayer1ShowingGameOverMessage||_0x28c349==='p2'&&isPlayer2ShowingGameOverMessage;let _0x5358d3=null,_0x5e0428=!![];if(isCoopAIDemoActive||isPlayerTwoAI&&selectedOnePlayerGameVariant===_0x5cb21d(0x165)){if(_0x674c2f&&!_0x3cd3a1&&capturedBossIdWithMessage){const _0x281f0a=_0x28c349==='p1'?coopPartner1CapturedTime:coopPartner2CapturedTime;_0x281f0a>0x0&&_0x299997-_0x281f0a<COOP_AI_SAVE_PARTNER_DELAY_MS&&(_0x5e0428=![]),_0x5358d3=_0x2dc4a1[_0x5cb21d(0x19b)](_0x5bf448=>_0x5bf448['id']===capturedBossIdWithMessage&&_0x5bf448[_0x5cb21d(0x9f)]===ENEMY3_TYPE&&_0x5bf448[_0x5cb21d(0x1b9)]);}}if(_0x5358d3&&!_0x3981b5&&_0x5e0428){_0x3d54fd=!![],_0x1417bd=_0x5358d3;const _0x1b587e=_0x5358d3['x']+_0x5358d3[_0x5cb21d(0x1c4)]/0x2;_0x93b38f=_0x1b587e-_0x41addc/0x2,_0x95e446=!![],_0x4f8f09=![];if(!_0x47780a){let _0x1ab7db=[];const _0xafef57=FINAL_DODGE_LOOKAHEAD*0.4,_0x5db226=FINAL_DODGE_BUFFER_BASE*0.3,_0x593b0b={'x':Math[_0x5cb21d(0xf4)](_0x5607ce,_0x1b587e)-_0x5db226,'y':_0x1364cd['y']-_0xafef57,'width':Math['abs'](_0x5607ce-_0x1b587e)+_0x41addc+_0x5db226*0x2,'height':_0xafef57+_0x1364cd[_0x5cb21d(0x120)]};for(const _0x56f185 of _0x1eab66){if(_0x56f185&&_0x56f185['y']+_0x56f185[_0x5cb21d(0x120)]>_0x1364cd['y']-_0x1364cd[_0x5cb21d(0x120)]&&_0x56f185['y']<_0x502815){const _0x3f5e33={'x':_0x56f185['x'],'y':_0x56f185['y'],'width':_0x56f185[_0x5cb21d(0x1c4)],'height':_0x56f185[_0x5cb21d(0x120)]};checkCollision(_0x593b0b,_0x3f5e33)&&_0x1ab7db[_0x5cb21d(0xd2)](_0x56f185);}}if(_0x1ab7db[_0x5cb21d(0x100)]>0x0){_0x4f8f09=!![];const _0x4153a1=_0x4111f4<_0x5e44b7/0x2?-0x1:0x1;_0x93b38f=_0x4111f4+_0x4153a1*(_0x41addc*0.6),_0x95e446=![];}}return _0x93b38f=Math[_0x5cb21d(0x14a)](AI_EDGE_BUFFER,Math['min'](_0x5e44b7-_0x41addc-AI_EDGE_BUFFER,_0x93b38f)),{'desiredTargetX':_0x93b38f,'shouldTryShoot':_0x95e446,'targetEnemyForAI':_0x1417bd};}if(!_0x47780a){let _0x4cf4f1=[];const _0x4edd48=FINAL_DODGE_LOOKAHEAD*(isCoopAIDemoActive||isPlayerTwoAI&&selectedOnePlayerGameVariant===_0x5cb21d(0x165)?1.6:0.8),_0x30daa9=FINAL_DODGE_BUFFER_BASE*(isCoopAIDemoActive||isPlayerTwoAI&&selectedOnePlayerGameVariant===_0x5cb21d(0x165)?1.7:0.8),_0x5f0671={'x':_0x1364cd['x']-_0x30daa9,'y':_0x1364cd['y']-_0x4edd48,'width':_0x41addc+_0x30daa9*0x2,'height':_0x4edd48+_0x1364cd[_0x5cb21d(0x120)]};for(const _0x20df4c of _0x1eab66){if(_0x20df4c&&_0x20df4c['y']+_0x20df4c[_0x5cb21d(0x120)]>_0x1364cd['y']-_0x1364cd[_0x5cb21d(0x120)]*1.5&&_0x20df4c['y']<_0x502815){const _0x2fd9fe={'x':_0x20df4c['x'],'y':_0x20df4c['y'],'width':_0x20df4c[_0x5cb21d(0x1c4)],'height':_0x20df4c['height']};checkCollision(_0x5f0671,_0x2fd9fe)&&_0x4cf4f1[_0x5cb21d(0xd2)](_0x20df4c);}}if(_0x4cf4f1[_0x5cb21d(0x100)]>0x0){_0x4f8f09=!![];let _0x275f35=_0x4111f4;const _0x5b5d7d=_0x41addc*(isCoopAIDemoActive||isPlayerTwoAI&&selectedOnePlayerGameVariant===_0x5cb21d(0x165)?0x3:0x2);let _0x189454=0x0,_0x14834e=0x0,_0x2082a7=0x0;const _0xd77b86=_0x1364cd['x']+_0x41addc/0x2;for(const _0x5aa8a3 of _0x4cf4f1){if(_0x5aa8a3['x']<_0xd77b86-_0x41addc*0.5)_0x14834e++;else{if(_0x5aa8a3['x']>_0xd77b86+_0x41addc*0.5)_0x2082a7++;else _0x189454++;}}if(_0x14834e<=_0x2082a7&&_0x14834e<=_0x189454)_0x275f35=_0x4111f4-_0x5b5d7d-Math['random']()*_0x41addc*0.4;else{if(_0x2082a7<=_0x14834e&&_0x2082a7<=_0x189454)_0x275f35=_0x4111f4+_0x5b5d7d+Math[_0x5cb21d(0xcb)]()*_0x41addc*0.4;else{if(_0x4111f4<_0x4c34ac)_0x275f35=_0x4c34ac+_0x5b5d7d+Math[_0x5cb21d(0xcb)]()*_0x41addc*0.7;else _0x275f35=_0x4c34ac-_0x5b5d7d-Math[_0x5cb21d(0xcb)]()*_0x41addc*0.7;}}_0x93b38f=_0x275f35;}if(!_0x4f8f09){const _0x4a8581=AI_COLLISION_LOOKAHEAD*(isCoopAIDemoActive||isPlayerTwoAI&&selectedOnePlayerGameVariant===_0x5cb21d(0x165)?0x1:0.75),_0x430e11=AI_COLLISION_BUFFER*(isCoopAIDemoActive||isPlayerTwoAI&&selectedOnePlayerGameVariant===_0x5cb21d(0x165)?0x1:0.8);for(const _0x496160 of _0x2dc4a1){if(!_0x496160)continue;if(!_0x5e0428&&_0x5358d3&&_0x496160['id']===_0x5358d3['id'])continue;if((_0x496160['state']==='attacking'||_0x496160[_0x5cb21d(0x106)]===_0x5cb21d(0xd5))&&_0x496160['y']+_0x496160[_0x5cb21d(0x120)]>_0x827401-_0x4a8581&&_0x496160['y']<_0x827401+_0x1364cd[_0x5cb21d(0x120)]*1.5){const _0x5a1b0b={'x':_0x1364cd['x']-_0x430e11,'y':_0x1364cd['y']-_0x4a8581,'width':_0x41addc+_0x430e11*0x2,'height':_0x4a8581+_0x1364cd[_0x5cb21d(0x120)]},_0x2d687f={'x':_0x496160['x'],'y':_0x496160['y'],'width':_0x496160[_0x5cb21d(0x1c4)],'height':_0x496160['height']};if(checkCollision(_0x5a1b0b,_0x2d687f)){_0x4f8f09=!![],_0x1417bd=null,_0x95e446=![];const _0xbe920=_0x496160['x']+_0x496160['width']/0x2;_0x93b38f=_0x4111f4+(_0x5607ce<_0xbe920?-0x1:0x1)*(_0x41addc*(isCoopAIDemoActive||isPlayerTwoAI&&selectedOnePlayerGameVariant==='1P_VS_AI_COOP'?2.2:1.9));break;}}}}}if(!_0x4f8f09&&_0x286d8c&&captureBeamActive&&capturingBossId&&!_0x21d342){if(aiPlayerActivelySeekingCaptureById===null||aiPlayerActivelySeekingCaptureById===_0x385119){const _0x43c38b=_0x2dc4a1[_0x5cb21d(0x19b)](_0x369bb1=>_0x369bb1['id']===capturingBossId);if(_0x43c38b&&_0x43c38b[_0x5cb21d(0x106)]===_0x5cb21d(0x113)){aiPlayerActivelySeekingCaptureById===null&&(aiPlayerActivelySeekingCaptureById=_0x385119);if(aiPlayerActivelySeekingCaptureById===_0x385119){if(_0x299997-(_0x43c38b[_0x5cb21d(0x1c3)]||0x0)>=AI_CAPTURE_BEAM_APPROACH_DELAY_MS){_0x443aff=!![];const _0xa0c7c9=_0x43c38b['x']+(_0x43c38b[_0x5cb21d(0x9f)]===ENEMY3_TYPE?BOSS_WIDTH:ENEMY_WIDTH)/0x2;_0x93b38f=_0xa0c7c9-_0x41addc/0x2,_0x95e446=![],_0x1417bd=null;}else _0x93b38f=_0xbce104,_0x95e446=![],_0x1417bd=null;}}else aiPlayerActivelySeekingCaptureById===_0x385119&&(aiPlayerActivelySeekingCaptureById=null);}}else aiPlayerActivelySeekingCaptureById===_0x385119&&!(_0x286d8c&&captureBeamActive&&capturingBossId&&!_0x21d342)&&(aiPlayerActivelySeekingCaptureById=null);if(!_0x4f8f09&&!_0x443aff&&!_0x3981b5){const _0x107e6b=_0x532a86[_0x5cb21d(0x19b)](_0x281f93=>_0x281f93[_0x5cb21d(0xaf)]===_0x385119&&!_0x281f93['landed']);_0x107e6b&&(_0x5d40ee=!![],_0x93b38f=_0x107e6b['x']+_0x107e6b[_0x5cb21d(0x1c4)]/0x2-_0x41addc/0x2,_0x95e446=![],_0x1417bd=null);}if(!_0x4f8f09&&!_0x443aff&&!_0x5d40ee&&!_0x3d54fd){let _0x2482a9=-Infinity,_0x4e90e9=![],_0x2b536d=null;for(const _0x502aa7 of _0x2dc4a1){if(!_0x502aa7)continue;if(!_0x5e0428&&_0x5358d3&&_0x502aa7['id']===_0x5358d3['id'])continue;let _0x534925=![];if(_0x502aa7['type']===ENEMY3_TYPE&&_0x502aa7['hasCapturedShip']&&_0x1b64a0<=0x1){const _0x2c64c0=(isCoopAIDemoActive||isPlayerTwoAI&&selectedOnePlayerGameVariant===_0x5cb21d(0x165))&&_0x502aa7['id']===capturedBossIdWithMessage&&_0x674c2f;!_0x2c64c0&&(_0x534925=!![]);}let _0x25460b=0x0;const _0x1db2b3=_0x502aa7['x']+_0x502aa7[_0x5cb21d(0x1c4)]/0x2,_0x531227=_0x1db2b3-_0x5607ce,_0x3fa0fd=_0x827401-(_0x502aa7['y']+_0x502aa7[_0x5cb21d(0x120)]);if(_0x3fa0fd<0x0&&_0x502aa7[_0x5cb21d(0x106)]!==_0x5cb21d(0xeb)&&_0x502aa7[_0x5cb21d(0x106)]!==_0x5cb21d(0xd5)&&_0x502aa7[_0x5cb21d(0x106)]!==_0x5cb21d(0x18f))continue;let _0x4cb376=0x0;if(isCoopAIDemoActive||isPlayerTwoAI&&selectedOnePlayerGameVariant===_0x5cb21d(0x165)){if(_0x385119==='p1'&&_0x1db2b3<_0x5e44b7/0x2)_0x4cb376=0x1388;else{if((_0x385119==='p2'||_0x385119===_0x5cb21d(0xed))&&_0x1db2b3>=_0x5e44b7/0x2)_0x4cb376=0x1388;}}_0x25460b=_0x4cb376+(_0x502815-_0x502aa7['y'])*0x2-Math['abs'](_0x531227)*0x3-_0x3fa0fd;if(_0x502aa7[_0x5cb21d(0x106)]==='attacking'||_0x502aa7[_0x5cb21d(0x106)]==='diving_to_capture_position')_0x25460b+=0xbb8;if(_0x502aa7[_0x5cb21d(0x9f)]===ENEMY3_TYPE&&!_0x502aa7[_0x5cb21d(0x1a1)])_0x25460b+=0x7d0;if(_0x502aa7[_0x5cb21d(0x9f)]===ENEMY3_TYPE&&_0x502aa7[_0x5cb21d(0x1a1)])_0x25460b+=0xfa0;_0x502aa7[_0x5cb21d(0x9f)]===ENEMY3_TYPE&&_0x502aa7[_0x5cb21d(0x1b9)]&&(!_0x534925?_0x25460b+=0x1388:_0x25460b-=0x2710);if(_0x25460b>_0x2482a9){_0x2482a9=_0x25460b,_0x2b536d=_0x502aa7;let _0x5b2507=![];if(_0x2b536d[_0x5cb21d(0x9f)]===ENEMY3_TYPE&&!_0x2b536d['hasCapturedShip']&&!isFullGridWave){_0x286d8c&&!captureAttemptMadeThisLevel&&(_0x2b536d[_0x5cb21d(0x106)]==='in_grid'||_0x2b536d['state']===_0x5cb21d(0x13d)||_0x2b536d['state']===_0x5cb21d(0xd5))&&(_0x5b2507=!![]);if(_0x3981b5){const _0xfa771b=_0x385119==='p1'?'p2':'p1';let _0x2809ae=![];_0xfa771b==='p1'?ship1&&player1Lives>0x0&&!isPlayer1ShipCaptured&&!isPlayer1WaitingForRespawn&&!isPlayer1ShowingGameOverMessage&&!player1NeedsRespawnAfterCapture&&!player1IsDualShipActive&&(_0x2809ae=!![]):ship2&&player2Lives>0x0&&!isPlayer2ShipCaptured&&!isPlayer2WaitingForRespawn&&!isPlayer2ShowingGameOverMessage&&!player2NeedsRespawnAfterCapture&&!player2IsDualShipActive&&(_0x2809ae=!![]),_0x2809ae&&(_0x5b2507=!![]);}}if(_0x534925&&_0x2b536d===_0x502aa7)Math['abs'](_0x5607ce-(_0x2b536d['x']+_0x2b536d[_0x5cb21d(0x1c4)]/0x2))<_0x41addc*1.1?_0x4e90e9=!![]:_0x4e90e9=![];else{if(_0x5b2507)_0x4e90e9=![];else Math[_0x5cb21d(0x101)](_0x5607ce-(_0x2b536d['x']+_0x2b536d[_0x5cb21d(0x1c4)]/0x2))<_0x41addc*0.9?_0x4e90e9=!![]:_0x4e90e9=![];}}}_0x1417bd=_0x2b536d,_0x95e446=_0x4e90e9;if(_0x1417bd){let _0x224100=![];if(_0x1417bd[_0x5cb21d(0x9f)]===ENEMY3_TYPE&&_0x1417bd['hasCapturedShip']&&_0x1b64a0<=0x1){const _0x5d70e5=(isCoopAIDemoActive||isPlayerTwoAI&&selectedOnePlayerGameVariant===_0x5cb21d(0x165))&&_0x1417bd['id']===capturedBossIdWithMessage&&_0x674c2f;!_0x5d70e5&&(_0x224100=!![]);}if(_0x224100)_0x93b38f=_0xbce104;else{const _0x26e31a=_0x1417bd['x']+_0x1417bd[_0x5cb21d(0x1c4)]/0x2;_0x93b38f=_0x26e31a-_0x41addc/0x2;}}else _0x93b38f=_0xbce104,_0x95e446=![];}return _0x93b38f=Math[_0x5cb21d(0x14a)](AI_EDGE_BUFFER,Math[_0x5cb21d(0xf4)](_0x5e44b7-_0x41addc-AI_EDGE_BUFFER,_0x93b38f)),{'desiredTargetX':_0x93b38f,'shouldTryShoot':_0x95e446,'targetEnemyForAI':_0x1417bd};}function findAndDetachEnemy(){const _0x530097=_0x571912;try{let _0x4f4e7c=![];isTwoPlayerMode&&selectedGameMode==='coop'?_0x4f4e7c=isPlayer1ShipCaptured||isPlayer2ShipCaptured:_0x4f4e7c=isShipCaptured;if(!isFullGridWave&&_0x4f4e7c){const _0x315dfa=enemies[_0x530097(0x19b)](_0xbf4601=>_0xbf4601&&_0xbf4601['type']===ENEMY3_TYPE&&_0xbf4601[_0x530097(0x1b9)]&&_0xbf4601[_0x530097(0x106)]===_0x530097(0x9d));if(_0x315dfa){_0x315dfa['justReturned']=!![],_0x315dfa['attackType']=_0x530097(0x156);const _0x1eddf5=new Set([_0x315dfa['id']]);return resetJustReturnedFlags(_0x1eddf5),[_0x315dfa];}}if(isEntrancePhaseActive)return null;let _0x2595ac=enemies[_0x530097(0x19e)](_0x302243=>_0x302243&&_0x302243[_0x530097(0x106)]===_0x530097(0x9d)&&!_0x302243[_0x530097(0xf8)]);if(_0x2595ac['length']===0x0){_0x2595ac=enemies['filter'](_0x2e95d2=>_0x2e95d2&&_0x2e95d2[_0x530097(0x106)]==='in_grid');if(_0x2595ac['length']===0x0)return null;}if(_0x2595ac['length']===0x0)return null;_0x2595ac[_0x530097(0x1ba)]((_0x11a837,_0x189f12)=>(_0x189f12[_0x530097(0x1c9)]||0x0)-(_0x11a837[_0x530097(0x1c9)]||0x0));const _0x5b7100=_0x2595ac[_0x530097(0x100)]<=0x3;let _0x28d74f=[];const _0x343317=_0x530097(0x156);gridJustCompleted&&(gridJustCompleted=![]);let _0x9ea51=![];if(level>0x1&&!_0x5b7100&&_0x2595ac[_0x530097(0x100)]>=0x3){const _0x9cbea5=_0x2595ac[_0x530097(0x19e)](_0x548c01=>_0x548c01[_0x530097(0x9f)]===ENEMY3_TYPE&&!_0x548c01[_0x530097(0x1b9)]);for(const _0x439c35 of _0x9cbea5){const _0x155c53=_0x2595ac[_0x530097(0x19b)](_0x5464f1=>_0x5464f1[_0x530097(0x9f)]===ENEMY2_TYPE&&_0x5464f1[_0x530097(0x1c9)]===_0x439c35['gridRow']&&_0x5464f1['gridCol']===_0x439c35['gridCol']-0x1),_0x28ac66=_0x2595ac[_0x530097(0x19b)](_0x36ca32=>_0x36ca32[_0x530097(0x9f)]===ENEMY2_TYPE&&_0x36ca32[_0x530097(0x1c9)]===_0x439c35['gridRow']&&_0x36ca32[_0x530097(0x1bf)]===_0x439c35[_0x530097(0x1bf)]+0x1);if(_0x155c53&&_0x28ac66){_0x28d74f=[_0x439c35,_0x155c53,_0x28ac66],_0x9ea51=!![];break;}}}if(!_0x9ea51&&!_0x5b7100){const _0x32e429=_0x2595ac[_0x530097(0x19e)](_0x3a9575=>_0x3a9575['type']===ENEMY1_TYPE),_0xba35c4=scaleValue(level,BASE_BEE_GROUP_ATTACK_PROBABILITY,MAX_BEE_GROUP_ATTACK_PROBABILITY)*1.2;if(_0x32e429[_0x530097(0x100)]>=0x2&&Math[_0x530097(0xcb)]()<_0xba35c4){const _0x557f2c=scaleValue(level,BASE_BEE_TRIPLE_ATTACK_PROBABILITY,MAX_BEE_TRIPLE_ATTACK_PROBABILITY)*1.1,_0x41ca69=_0x32e429[_0x530097(0x100)]>=0x3&&Math[_0x530097(0xcb)]()<_0x557f2c?0x3:0x2;let _0x4b2fc4=![];_0x32e429[_0x530097(0x1ba)](()=>Math[_0x530097(0xcb)]()-0.5);for(let _0x8d286c=0x0;_0x8d286c<_0x32e429[_0x530097(0x100)];_0x8d286c++){const _0x49d5c7=_0x32e429[_0x8d286c];let _0x432945=[_0x49d5c7];const _0x1adde5=_0x32e429[_0x530097(0x19e)](_0xc1a62a=>_0xc1a62a['id']!==_0x49d5c7['id']&&_0xc1a62a[_0x530097(0x1c9)]===_0x49d5c7['gridRow']);_0x1adde5[_0x530097(0x1ba)]((_0x3df6bc,_0x3e508e)=>Math[_0x530097(0x101)](_0x3df6bc[_0x530097(0x1bf)]-_0x49d5c7[_0x530097(0x1bf)])-Math[_0x530097(0x101)](_0x3e508e[_0x530097(0x1bf)]-_0x49d5c7['gridCol']));for(let _0xce14f5=0x0;_0xce14f5<_0x1adde5[_0x530097(0x100)]&&_0x432945['length']<_0x41ca69;_0xce14f5++){_0x432945[_0x530097(0xd2)](_0x1adde5[_0xce14f5]);}if(_0x432945['length']===_0x41ca69){_0x28d74f=_0x432945,_0x9ea51=!![],_0x4b2fc4=!![];break;}}!_0x4b2fc4&&_0x32e429[_0x530097(0x100)]>=_0x41ca69&&(_0x28d74f=_0x32e429[_0x530097(0xfe)](0x0,_0x41ca69),_0x9ea51=!![]);}}if(!_0x9ea51&&!_0x5b7100){const _0x17e1e4=_0x2595ac[_0x530097(0x19e)](_0xf8bfd4=>_0xf8bfd4['type']===ENEMY2_TYPE),_0x15609=0.2;if(_0x17e1e4[_0x530097(0x100)]>=0x2&&Math['random']()<_0x15609){const _0x24b06f=0x2;let _0x36b148=![];_0x17e1e4['sort'](()=>Math[_0x530097(0xcb)]()-0.5);for(let _0x1d262b=0x0;_0x1d262b<_0x17e1e4['length'];_0x1d262b++){const _0xf460be=_0x17e1e4[_0x1d262b];let _0x4b6612=[_0xf460be];const _0xa98d1b=_0x17e1e4[_0x530097(0x19e)](_0x544578=>_0x544578['id']!==_0xf460be['id']&&_0x544578[_0x530097(0x1c9)]===_0xf460be[_0x530097(0x1c9)]);_0xa98d1b['sort']((_0x3b04f6,_0x1dcf72)=>Math['abs'](_0x3b04f6[_0x530097(0x1bf)]-_0xf460be['gridCol'])-Math[_0x530097(0x101)](_0x1dcf72[_0x530097(0x1bf)]-_0xf460be[_0x530097(0x1bf)]));for(let _0xb1bd6e=0x0;_0xb1bd6e<_0xa98d1b['length']&&_0x4b6612[_0x530097(0x100)]<_0x24b06f;_0xb1bd6e++){_0x4b6612[_0x530097(0xd2)](_0xa98d1b[_0xb1bd6e]);}if(_0x4b6612[_0x530097(0x100)]===_0x24b06f){_0x28d74f=_0x4b6612,_0x9ea51=!![],_0x36b148=!![];break;}}!_0x36b148&&_0x17e1e4[_0x530097(0x100)]>=_0x24b06f&&(_0x28d74f=_0x17e1e4[_0x530097(0xfe)](0x0,_0x24b06f),_0x9ea51=!![]);}}if(!_0x9ea51&&_0x2595ac['length']>0x0){const _0x6ff559=_0x2595ac[0x0];_0x28d74f[_0x530097(0xd2)](_0x6ff559);if(_0x2595ac['length']>0x1&&!_0x5b7100&&Math['random']()<0.2){const _0x40c72a=_0x2595ac['find'](_0x48aa3e=>_0x48aa3e['id']!==_0x6ff559['id']&&_0x48aa3e[_0x530097(0x1c9)]===_0x6ff559[_0x530097(0x1c9)]&&_0x48aa3e[_0x530097(0x1bf)]===_0x6ff559[_0x530097(0x1bf)]-0x1),_0x3d8393=_0x2595ac[_0x530097(0x19b)](_0xbe7c3c=>_0xbe7c3c['id']!==_0x6ff559['id']&&_0xbe7c3c['gridRow']===_0x6ff559[_0x530097(0x1c9)]&&_0xbe7c3c[_0x530097(0x1bf)]===_0x6ff559[_0x530097(0x1bf)]+0x1),_0x31de02=_0x40c72a||_0x3d8393;if(_0x31de02){const _0xb75c25=_0x6ff559['type']===ENEMY3_TYPE&&_0x31de02[_0x530097(0x9f)]===ENEMY3_TYPE;!_0xb75c25&&_0x28d74f['push'](_0x31de02);}}_0x9ea51=!![];}if(_0x28d74f[_0x530097(0x100)]>0x0){_0x28d74f=_0x28d74f[_0x530097(0x19e)](_0x1a594c=>_0x1a594c);if(_0x28d74f[_0x530097(0x100)]===0x0)return null;_0x28d74f[_0x530097(0xce)](_0x1ffb2b=>{const _0x51fc6a=_0x530097;_0x1ffb2b&&(_0x1ffb2b[_0x51fc6a(0xf8)]=!![],_0x1ffb2b[_0x51fc6a(0x13f)]=_0x343317);});const _0x374fbb=new Set(_0x28d74f['map'](_0x43e525=>_0x43e525['id']));return resetJustReturnedFlags(_0x374fbb),_0x28d74f;}return null;}catch(_0x33b602){return console[_0x530097(0x95)]('Error\x20in\x20findAndDetachEnemy:',_0x33b602),null;}}function triggerImmediateCaptureDive(){const _0x4bd521=_0x571912;try{let _0x2dd2fb=![],_0x510175=null;if(isTwoPlayerMode&&selectedGameMode==='coop'){const _0x462ca7=ship1&&player1Lives>0x1&&!isPlayer1ShipCaptured&&!isPlayer1WaitingForRespawn,_0x26a042=ship2&&player2Lives>0x1&&!isPlayer2ShipCaptured&&!isPlayer2WaitingForRespawn;if((_0x462ca7||_0x26a042)&&!captureAttemptMadeThisLevel){_0x2dd2fb=!![];if(_0x462ca7&&_0x26a042)_0x510175=Math[_0x4bd521(0xcb)]()<0.5?ship1:ship2;else{if(_0x462ca7)_0x510175=ship1;else _0x26a042&&(_0x510175=ship2);}}}else playerLives>0x1&&ship&&!isShipCaptured&&!isWaitingForRespawn&&!captureAttemptMadeThisLevel&&(_0x2dd2fb=!![],_0x510175=ship);if(isChallengingStage||!_0x2dd2fb||!_0x510175)return;const _0x23ce14=enemies[_0x4bd521(0x19e)](_0x4b8be5=>_0x4b8be5&&_0x4b8be5[_0x4bd521(0x106)]===_0x4bd521(0x9d)&&_0x4b8be5[_0x4bd521(0x9f)]===ENEMY3_TYPE&&!_0x4b8be5[_0x4bd521(0x1b9)]&&!_0x4b8be5[_0x4bd521(0x184)]);if(_0x23ce14[_0x4bd521(0x100)]>0x0){const _0x10d30c=_0x23ce14[Math[_0x4bd521(0x9c)](Math[_0x4bd521(0xcb)]()*_0x23ce14[_0x4bd521(0x100)])],_0xbb9ce7=Date[_0x4bd521(0x1a6)]();_0x10d30c[_0x4bd521(0x184)]=!![],_0x10d30c[_0x4bd521(0xf8)]=!![];const _0x1d8059=new Set([_0x10d30c['id']]);resetJustReturnedFlags(_0x1d8059);const _0x1e4df4=_0x510175['x']+_0x510175[_0x4bd521(0x1c4)]/0x2,_0x32a8c1=_0x1e4df4<gameCanvas[_0x4bd521(0x1c4)]/0x2?_0x4bd521(0x94):'left',_0x2df996=_0x32a8c1===_0x4bd521(0x159)?gameCanvas[_0x4bd521(0x1c4)]*CAPTURE_DIVE_SIDE_MARGIN_FACTOR:gameCanvas[_0x4bd521(0x1c4)]*(0x1-CAPTURE_DIVE_SIDE_MARGIN_FACTOR)-BOSS_WIDTH,_0x441e8f=gameCanvas[_0x4bd521(0x120)]*CAPTURE_DIVE_BOTTOM_HOVER_Y_FACTOR;_0x10d30c[_0x4bd521(0x106)]=_0x4bd521(0x13d),_0x10d30c[_0x4bd521(0x107)]=_0x2df996,_0x10d30c['targetY']=_0x441e8f,_0x10d30c[_0x4bd521(0x127)]=_0xbb9ce7,playSound(_0x4bd521(0x11e),![],0.2);const _0x36877f=_0x10d30c['id'];_0x10d30c[_0x4bd521(0x123)]=setTimeout(()=>{const _0x2a0d2c=_0x4bd521,_0x20c88a=enemies['find'](_0x313ce5=>_0x313ce5?.['id']===_0x36877f);_0x20c88a&&_0x20c88a['state']==='preparing_capture'&&(_0x20c88a[_0x2a0d2c(0x106)]=_0x2a0d2c(0xd5));if(_0x20c88a)_0x20c88a['capturePrepareTimeout']=null;const _0x118b57=enemySpawnTimeouts[_0x2a0d2c(0x1c2)](_0x19c153=>_0x19c153===_0x10d30c['capturePrepareTimeout']);if(_0x118b57>-0x1)enemySpawnTimeouts[_0x2a0d2c(0x1b0)](_0x118b57,0x1);},0x12c),enemySpawnTimeouts[_0x4bd521(0xd2)](_0x10d30c[_0x4bd521(0x123)]);}}catch(_0x1a1b8d){console[_0x4bd521(0x95)](_0x4bd521(0xfd),_0x1a1b8d);}}function resetJustReturnedFlags(_0x5e2114){const _0x768ac8=_0x571912;enemies[_0x768ac8(0xce)](_0x17ea55=>{const _0x51df26=_0x768ac8;let _0x147d6e=![];if(_0x5e2114 instanceof Set)_0x147d6e=_0x5e2114[_0x51df26(0x10d)](_0x17ea55['id']);else typeof _0x5e2114===_0x51df26(0x132)&&(_0x147d6e=_0x17ea55['id']===_0x5e2114);_0x17ea55&&_0x17ea55[_0x51df26(0x106)]===_0x51df26(0x9d)&&_0x17ea55[_0x51df26(0xf8)]&&!_0x147d6e&&(_0x17ea55[_0x51df26(0xf8)]=![]);});}function updateFloatingScores(){const _0x41bf48=_0x571912;if(isPaused)return;try{const _0x14b3ce=Date[_0x41bf48(0x1a6)]();floatingScores=floatingScores[_0x41bf48(0x19e)](_0x35e059=>_0x14b3ce-_0x35e059[_0x41bf48(0x1b6)]<FLOATING_SCORE_DURATION+FLOATING_SCORE_APPEAR_DELAY);}catch(_0x32d34b){console[_0x41bf48(0x95)](_0x41bf48(0x12f),_0x32d34b),floatingScores=[];}}function updateExplosions(){const _0x10035d=_0x571912;if(isPaused)return;try{const _0x3ea3cf=Date[_0x10035d(0x1a6)]();for(let _0x33de9a=explosions[_0x10035d(0x100)]-0x1;_0x33de9a>=0x0;_0x33de9a--){const _0x122280=explosions[_0x33de9a],_0x5af62c=_0x3ea3cf-_0x122280['creationTime'];if(_0x5af62c>_0x122280[_0x10035d(0xc1)]){explosions[_0x10035d(0x1b0)](_0x33de9a,0x1);continue;}_0x122280['particles'][_0x10035d(0xce)](_0x523674=>{const _0x3b09f6=_0x10035d;_0x523674['x']+=_0x523674['vx'],_0x523674['y']+=_0x523674['vy'],_0x523674[_0x3b09f6(0xa9)]=Math['max'](0x0,0x1-_0x5af62c/_0x122280['duration']*EXPLOSION_FADE_SPEED);});}}catch(_0x369404){console['error'](_0x10035d(0x17a),_0x369404),explosions=[];}}function moveEntities(_0x43511d=null,_0x2cc490=null){const _0x426382=_0x571912;if(isPaused)return;try{const _0x2a69df=Date[_0x426382(0x1a6)](),_0x33e79d=gameCanvas?gameCanvas['height']-SHIP_HEIGHT-SHIP_BOTTOM_MARGIN:0x1f4;if(gameCanvas&&!isTouchActiveGame){if(isManualControl){if(isTwoPlayerMode&&selectedGameMode===_0x426382(0x99)){if(ship1&&player1Lives>0x0&&!isPlayer1ShipCaptured&&!isPlayer1WaitingForRespawn&&!isPlayer1ShowingGameOverMessage&&!player1NeedsRespawnAfterCapture){const _0x380095=ship1['width']+(player1IsDualShipActive?DUAL_SHIP_OFFSET_X:0x0);if(leftPressed)ship1['x']-=ship1[_0x426382(0x17f)];if(rightPressed)ship1['x']+=ship1[_0x426382(0x17f)];ship1['x']=Math[_0x426382(0x14a)](0x0,Math['min'](gameCanvas[_0x426382(0x1c4)]-_0x380095,ship1['x'])),ship1[_0x426382(0x107)]=ship1['x'];}if(!isPlayerTwoAI&&ship2&&player2Lives>0x0&&!isPlayer2ShipCaptured&&!isPlayer2WaitingForRespawn&&!isPlayer2ShowingGameOverMessage&&!player2NeedsRespawnAfterCapture){const _0x1503fe=ship2[_0x426382(0x1c4)]+(player2IsDualShipActive?DUAL_SHIP_OFFSET_X:0x0);if(p2LeftPressed)ship2['x']-=ship2[_0x426382(0x17f)];if(p2RightPressed)ship2['x']+=ship2['speed'];ship2['x']=Math[_0x426382(0x14a)](0x0,Math[_0x426382(0xf4)](gameCanvas[_0x426382(0x1c4)]-_0x1503fe,ship2['x'])),ship2[_0x426382(0x107)]=ship2['x'];}}else{if(ship&&playerLives>0x0&&!isShipCaptured&&!isShowingPlayerGameOverMessage&&gameOverSequenceStartTime===0x0){if(!isPlayerTwoAI||isPlayerTwoAI&&currentPlayer===0x1){const _0x11a8d1=ship[_0x426382(0x1c4)]+(isDualShipActive?DUAL_SHIP_OFFSET_X:0x0);let _0x30d5d5=![],_0x29589c=![];if(isManualControl&&isPlayerTwoAI&&selectedOnePlayerGameVariant==='1P_VS_AI_NORMAL'&&currentPlayer===0x1&&isShowingIntro){if(_0x43511d!==null)_0x30d5d5=_0x43511d;if(_0x2cc490!==null)_0x29589c=_0x2cc490;}if(_0x30d5d5||leftPressed)ship['x']-=ship[_0x426382(0x17f)];if(_0x29589c||rightPressed)ship['x']+=ship[_0x426382(0x17f)];ship['x']=Math[_0x426382(0x14a)](0x0,Math[_0x426382(0xf4)](gameCanvas[_0x426382(0x1c4)]-_0x11a8d1,ship['x'])),ship[_0x426382(0x107)]=ship['x'];}}}}}if(!isManualControl||isPlayerTwoAI&&selectedGameMode===_0x426382(0x156)&&currentPlayer===0x2||isCoopAIDemoActive||isPlayerTwoAI&&selectedOnePlayerGameVariant===_0x426382(0x165)){if(isCoopAIDemoActive||isPlayerTwoAI&&selectedOnePlayerGameVariant===_0x426382(0x165)){if(ship1&&player1Lives>0x0&&!isPlayer1ShipCaptured&&!isPlayer1WaitingForRespawn&&!isPlayer1ShowingGameOverMessage&&!player1NeedsRespawnAfterCapture){const _0x38fa61=ship1['targetX']-ship1['x'];let _0x44dd71=ship1['speed']*AI_POSITION_MOVE_SPEED_FACTOR;if(Math[_0x426382(0x101)](_0x38fa61)>AI_MOVEMENT_DEADZONE)ship1['x']+=Math[_0x426382(0x110)](_0x38fa61)*Math[_0x426382(0xf4)](Math['abs'](_0x38fa61),_0x44dd71);const _0x276a3a=ship1['width']+(player1IsDualShipActive?DUAL_SHIP_OFFSET_X:0x0);ship1['x']=Math['max'](0x0,Math[_0x426382(0xf4)](gameCanvas[_0x426382(0x1c4)]-_0x276a3a,ship1['x']));}if(ship2&&player2Lives>0x0&&!isPlayer2ShipCaptured&&!isPlayer2WaitingForRespawn&&!isPlayer2ShowingGameOverMessage&&!player2NeedsRespawnAfterCapture){const _0x3d1992=ship2[_0x426382(0x107)]-ship2['x'];let _0x3fbce5=ship2[_0x426382(0x17f)]*AI_POSITION_MOVE_SPEED_FACTOR;if(Math[_0x426382(0x101)](_0x3d1992)>AI_MOVEMENT_DEADZONE)ship2['x']+=Math[_0x426382(0x110)](_0x3d1992)*Math[_0x426382(0xf4)](Math[_0x426382(0x101)](_0x3d1992),_0x3fbce5);const _0x35790e=ship2[_0x426382(0x1c4)]+(player2IsDualShipActive?DUAL_SHIP_OFFSET_X:0x0);ship2['x']=Math[_0x426382(0x14a)](0x0,Math['min'](gameCanvas[_0x426382(0x1c4)]-_0x35790e,ship2['x']));}}else{if(ship){if(playerLives>0x0&&!isShipCaptured&&!isShowingPlayerGameOverMessage&&gameOverSequenceStartTime===0x0){const _0x466799=ship['targetX']-ship['x'];let _0x598a1b=ship['speed']*AI_POSITION_MOVE_SPEED_FACTOR;isPlayerTwoAI&&selectedGameMode===_0x426382(0x156)&&currentPlayer===0x2&&(_0x598a1b=ship[_0x426382(0x17f)]*(AI_POSITION_MOVE_SPEED_FACTOR*1.15));Math['abs'](_0x466799)>AI_MOVEMENT_DEADZONE&&(ship['x']+=Math[_0x426382(0x110)](_0x466799)*Math['min'](Math[_0x426382(0x101)](_0x466799),_0x598a1b));const _0x4dd1ed=ship['width']+(isDualShipActive?DUAL_SHIP_OFFSET_X:0x0);ship['x']=Math[_0x426382(0x14a)](0x0,Math[_0x426382(0xf4)](gameCanvas[_0x426382(0x1c4)]-_0x4dd1ed,ship['x']));}}}}if(isTwoPlayerMode&&selectedGameMode===_0x426382(0x99)){if(isPlayer1WaitingForRespawn&&_0x2a69df>=player1RespawnTime)isPlayer1WaitingForRespawn=![];if(isPlayer1Invincible&&_0x2a69df>=player1InvincibilityEndTime)isPlayer1Invincible=![];if(isPlayer2WaitingForRespawn&&_0x2a69df>=player2RespawnTime)isPlayer2WaitingForRespawn=![];if(isPlayer2Invincible&&_0x2a69df>=player2InvincibilityEndTime)isPlayer2Invincible=![];}else{if(isWaitingForRespawn&&_0x2a69df>=respawnTime)isWaitingForRespawn=![];if(isInvincible&&_0x2a69df>=invincibilityEndTime)isInvincible=![];}for(let _0x6e561e=bullets[_0x426382(0x100)]-0x1;_0x6e561e>=0x0;_0x6e561e--){const _0x4b36f9=bullets[_0x6e561e];if(!_0x4b36f9){bullets[_0x426382(0x1b0)](_0x6e561e,0x1);continue;}_0x4b36f9['y']-=_0x4b36f9[_0x426382(0x17f)];if(_0x4b36f9['y']+PLAYER_BULLET_HEIGHT<0x0){bullets['splice'](_0x6e561e,0x1);continue;}for(let _0x3ed768=enemies['length']-0x1;_0x3ed768>=0x0;_0x3ed768--){const _0x3e5462=enemies[_0x3ed768];if(!_0x3e5462){enemies[_0x426382(0x1b0)](_0x3ed768,0x1);continue;}const _0x396189={'x':_0x3e5462['x'],'y':_0x3e5462['y'],'width':_0x3e5462[_0x426382(0x9f)]===ENEMY3_TYPE?BOSS_WIDTH:_0x3e5462[_0x426382(0x9f)]===ENEMY1_TYPE?ENEMY1_WIDTH:ENEMY_WIDTH,'height':_0x3e5462['type']===ENEMY3_TYPE?BOSS_HEIGHT:_0x3e5462[_0x426382(0x9f)]===ENEMY1_TYPE?ENEMY1_HEIGHT:ENEMY_HEIGHT},_0x81a8a8={'x':_0x4b36f9['x'],'y':_0x4b36f9['y'],'width':_0x4b36f9['width'],'height':_0x4b36f9[_0x426382(0x120)]};if(checkCollision(_0x81a8a8,_0x396189)){bullets['splice'](_0x6e561e,0x1);const _0x2ec2ee=handleEnemyHit(_0x3e5462,_0x4b36f9[_0x426382(0x172)]);if(_0x2ec2ee[_0x426382(0x14b)])enemies[_0x426382(0x1b0)](_0x3ed768,0x1);break;}}}for(let _0x9372dd=enemyBullets['length']-0x1;_0x9372dd>=0x0;_0x9372dd--){const _0x15b8d6=enemyBullets[_0x9372dd];if(!_0x15b8d6){enemyBullets['splice'](_0x9372dd,0x1);continue;}_0x15b8d6['x']+=_0x15b8d6['vx'],_0x15b8d6['y']+=_0x15b8d6['vy'],(_0x15b8d6['y']>gameCanvas[_0x426382(0x120)]||_0x15b8d6['y']<-ENEMY_BULLET_HEIGHT||_0x15b8d6['x']<-ENEMY_BULLET_WIDTH||_0x15b8d6['x']>gameCanvas['width'])&&enemyBullets[_0x426382(0x1b0)](_0x9372dd,0x1);}const _0x5adcea=gameCanvas?gameCanvas[_0x426382(0x120)]-SHIP_HEIGHT-SHIP_BOTTOM_MARGIN:0x1f4,_0x39cdca=0x2;for(let _0x5f2ebd=fallingShips[_0x426382(0x100)]-0x1;_0x5f2ebd>=0x0;_0x5f2ebd--){const _0xec54c6=fallingShips[_0x5f2ebd];if(!_0xec54c6){fallingShips[_0x426382(0x1b0)](_0x5f2ebd,0x1);continue;}let _0x5423b1=![];if(!_0xec54c6['landed']){_0xec54c6['y']+=FALLING_SHIP_SPEED;if(_0xec54c6['y']>=_0x5adcea){_0xec54c6['y']=_0x5adcea,_0xec54c6[_0x426382(0x18a)]=!![],_0xec54c6[_0x426382(0xab)]=_0x2a69df;!_0xec54c6[_0x426382(0x168)]&&(_0xec54c6[_0x426382(0x131)]=0x0,_0xec54c6[_0x426382(0x168)]=!![]);let _0x342005=null,_0x2ae805=()=>{},_0x4285b1=![],_0x53f86e=![],_0x5eb3af=![],_0x1ae3ee=null;if(isCoopAIDemoActive||isPlayerTwoAI&&selectedOnePlayerGameVariant===_0x426382(0x165)){if(_0xec54c6[_0x426382(0xaf)]==='player1'&&ship1&&player1Lives>0x0)_0x342005=ship1,_0x4285b1=player1IsDualShipActive,_0x2ae805=()=>{player1IsDualShipActive=!![];},_0x5eb3af=!![],_0x1ae3ee=_0x426382(0x10c);else(_0xec54c6[_0x426382(0xaf)]===_0x426382(0xf1)||_0xec54c6[_0x426382(0xaf)]===_0x426382(0xed))&&ship2&&player2Lives>0x0&&(_0x342005=ship2,_0x4285b1=player2IsDualShipActive,_0x2ae805=()=>{player2IsDualShipActive=!![];},_0x5eb3af=!![],_0x1ae3ee=isPlayerTwoAI&&selectedOnePlayerGameVariant===_0x426382(0x165)?_0x426382(0xed):_0x426382(0xf1));}else{if(isTwoPlayerMode&&selectedGameMode===_0x426382(0x99)){if(_0xec54c6[_0x426382(0xaf)]==='player1'&&ship1&&player1Lives>0x0)_0x342005=ship1,_0x4285b1=player1IsDualShipActive,_0x53f86e=isPlayer1ShipCaptured,_0x2ae805=()=>{player1IsDualShipActive=!![],isPlayer1ShipCaptured=![];},_0x5eb3af=!![],_0x1ae3ee='player1';else _0xec54c6[_0x426382(0xaf)]===_0x426382(0xf1)&&ship2&&player2Lives>0x0&&(_0x342005=ship2,_0x4285b1=player2IsDualShipActive,_0x53f86e=isPlayer2ShipCaptured,_0x2ae805=()=>{player2IsDualShipActive=!![],isPlayer2ShipCaptured=![];},_0x5eb3af=!![],_0x1ae3ee=_0x426382(0xf1));}else ship&&playerLives>0x0&&(_0x342005=ship,_0x4285b1=isDualShipActive,_0x53f86e=isShipCaptured,_0x2ae805=()=>{const _0x260575=_0x426382;isDualShipActive=!![];if(isTwoPlayerMode&&selectedGameMode===_0x260575(0x156)){if(currentPlayer===0x1)player1IsDualShipActive=!![];else player2IsDualShipActive=!![];}else{if(!isTwoPlayerMode)player1IsDualShipActive=!![];}isShipCaptured=![];},_0x5eb3af=!![],_0x1ae3ee=isTwoPlayerMode&&selectedGameMode===_0x426382(0x156)?String(currentPlayer):_0x426382(0x10c));}if(_0x5eb3af&&!_0x4285b1){_0x2ae805(),playSound('dualShipSound',![],0.4);if(_0x53f86e&&!(isCoopAIDemoActive||isPlayerTwoAI&&selectedOnePlayerGameVariant===_0x426382(0x165))){if(_0x1ae3ee==='player1'&&ship1)isPlayer1Invincible=!![],player1InvincibilityEndTime=_0x2a69df+INVINCIBILITY_DURATION_MS;else{if(_0x1ae3ee===_0x426382(0xf1)&&ship2)isPlayer2Invincible=!![],player2InvincibilityEndTime=_0x2a69df+INVINCIBILITY_DURATION_MS;else ship&&(isInvincible=!![],invincibilityEndTime=_0x2a69df+INVINCIBILITY_DURATION_MS);}}fallingShips[_0x426382(0x1b0)](_0x5f2ebd,0x1),_0x5423b1=!![];continue;}else{if(_0x5eb3af&&_0x4285b1){fallingShips[_0x426382(0x1b0)](_0x5f2ebd,0x1),_0x5423b1=!![];continue;}else{fallingShips['splice'](_0x5f2ebd,0x1),_0x5423b1=!![];continue;}}}}if(_0x5423b1)continue;const _0x2d5362=_0x2a69df-_0xec54c6[_0x426382(0x1b6)];if(_0x2d5362<FALLING_SHIP_FADE_DURATION_MS)_0xec54c6[_0x426382(0xb4)]=Math['max'](0x0,0x1-_0x2d5362/FALLING_SHIP_FADE_DURATION_MS);else _0xec54c6[_0x426382(0xb4)]=0x0;if(_0xec54c6[_0x426382(0x168)])_0xec54c6[_0x426382(0x131)]=0x0;else{if(!_0xec54c6['landed']&&typeof _0xec54c6[_0x426382(0x9b)]===_0x426382(0x112)&&typeof FALLING_SHIP_ROTATION_SPEED==='number'&&FALLING_SHIP_ROTATION_SPEED>0x0){const _0x4bc3ae=FALLING_SHIP_ROTATION_SPEED*_0xec54c6['rotationDirection'];_0xec54c6['rotation']+=_0x4bc3ae,_0xec54c6[_0x426382(0x140)]+=Math[_0x426382(0x101)](_0x4bc3ae);if(_0xec54c6[_0x426382(0x140)]>=_0x39cdca*0x2*Math['PI'])_0xec54c6[_0x426382(0x131)]=0x0,_0xec54c6[_0x426382(0x168)]=!![];else{if(_0xec54c6[_0x426382(0x131)]>Math['PI']*0x2)_0xec54c6[_0x426382(0x131)]-=Math['PI']*0x2;if(_0xec54c6['rotation']<0x0)_0xec54c6[_0x426382(0x131)]+=Math['PI']*0x2;}}else _0xec54c6['rotation']=_0xec54c6[_0x426382(0x131)]||0x0;}if(!_0xec54c6[_0x426382(0x18a)]){let _0x3c1c19=null,_0xb27571=()=>{},_0x280f4e=0x0,_0x2ffada=![],_0x5a9e41=![];if(isCoopAIDemoActive||isPlayerTwoAI&&selectedOnePlayerGameVariant===_0x426382(0x165)){if(_0xec54c6[_0x426382(0xaf)]===_0x426382(0x10c)&&ship1&&player1Lives>0x0)_0x3c1c19=ship1,_0x5a9e41=player1IsDualShipActive,_0xb27571=()=>{if(!_0x5a9e41)player1IsDualShipActive=!![];},_0x280f4e=0x1;else(_0xec54c6[_0x426382(0xaf)]==='player2'||_0xec54c6[_0x426382(0xaf)]==='ai_p2')&&ship2&&player2Lives>0x0&&(_0x3c1c19=ship2,_0x5a9e41=player2IsDualShipActive,_0xb27571=()=>{if(!_0x5a9e41)player2IsDualShipActive=!![];},_0x280f4e=0x2);}else{if(isTwoPlayerMode&&selectedGameMode===_0x426382(0x99)){if(_0xec54c6[_0x426382(0xaf)]===_0x426382(0x10c)&&ship1&&player1Lives>0x0)_0x3c1c19=ship1,_0x2ffada=isPlayer1ShipCaptured,_0x5a9e41=player1IsDualShipActive,_0xb27571=()=>{if(!_0x5a9e41)player1IsDualShipActive=!![];isPlayer1ShipCaptured=![];},_0x280f4e=0x1;else _0xec54c6[_0x426382(0xaf)]===_0x426382(0xf1)&&ship2&&player2Lives>0x0&&(_0x3c1c19=ship2,_0x2ffada=isPlayer2ShipCaptured,_0x5a9e41=player2IsDualShipActive,_0xb27571=()=>{if(!_0x5a9e41)player2IsDualShipActive=!![];isPlayer2ShipCaptured=![];},_0x280f4e=0x2);}else ship&&playerLives>0x0&&(_0x3c1c19=ship,_0x2ffada=isShipCaptured,_0x5a9e41=isDualShipActive,_0xb27571=()=>{const _0x3007e8=_0x426382;if(!_0x5a9e41){isDualShipActive=!![];if(isTwoPlayerMode&&selectedGameMode===_0x3007e8(0x156)){if(currentPlayer===0x1)player1IsDualShipActive=!![];else player2IsDualShipActive=!![];}else{if(!isTwoPlayerMode)player1IsDualShipActive=!![];}}isShipCaptured=![];},_0x280f4e=isTwoPlayerMode&&selectedGameMode===_0x426382(0x156)?currentPlayer:0x1);}if(_0x3c1c19&&!_0x5a9e41){const _0x6284e2={'x':_0xec54c6['x'],'y':_0xec54c6['y'],'width':_0xec54c6['width'],'height':_0xec54c6[_0x426382(0x120)]},_0x48125a={'x':_0x3c1c19['x'],'y':_0x3c1c19['y'],'width':_0x3c1c19['width'],'height':_0x3c1c19[_0x426382(0x120)]};if(checkCollision(_0x6284e2,_0x48125a)){_0xb27571();if(_0x2ffada&&!(isCoopAIDemoActive||isPlayerTwoAI&&selectedOnePlayerGameVariant===_0x426382(0x165))){playSound(_0x426382(0x104),![],0.4);if(_0x280f4e===0x1&&ship1)isPlayer1Invincible=!![],player1InvincibilityEndTime=_0x2a69df+INVINCIBILITY_DURATION_MS;else{if(_0x280f4e===0x2&&ship2)isPlayer2Invincible=!![],player2InvincibilityEndTime=_0x2a69df+INVINCIBILITY_DURATION_MS;else _0x280f4e!==0x0&&ship&&(isInvincible=!![],invincibilityEndTime=_0x2a69df+INVINCIBILITY_DURATION_MS);}}else playSound(_0x426382(0x104),![],0.4);fallingShips[_0x426382(0x1b0)](_0x5f2ebd,0x1);continue;}}}if(!_0xec54c6[_0x426382(0x18a)]&&_0xec54c6['y']>=gameCanvas['height'])fallingShips[_0x426382(0x1b0)](_0x5f2ebd,0x1);}let _0x188ae7=0x0;const _0x424f69=enemies[_0x426382(0xdd)](_0x251fc8=>_0x251fc8?.['state']===_0x426382(0x9d)),_0x3be742=!isChallengingStage&&!isWaveTransitioning&&_0x424f69&&!isShowingPlayerGameOverMessage&&!(isTwoPlayerMode&&selectedGameMode==='coop'&&(isPlayer1ShowingGameOverMessage||isPlayer2ShowingGameOverMessage));if(_0x3be742){!isGridSoundPlaying&&(isGridSoundPlaying=!![],playSound(_0x426382(0x11c),!![],0.1));const _0x534c9c=enemies[_0x426382(0x19e)](_0xfb62a8=>_0xfb62a8?.[_0x426382(0x106)]===_0x426382(0x9d));if(_0x534c9c[_0x426382(0x100)]>0x0){let _0x5aaefb=gameCanvas[_0x426382(0x1c4)],_0x5a2b78=0x0;_0x534c9c[_0x426382(0xce)](_0xe416b6=>{const _0x182d2f=_0x426382;_0xe416b6&&(_0x5aaefb=Math[_0x182d2f(0xf4)](_0x5aaefb,_0xe416b6['x']),_0x5a2b78=Math[_0x182d2f(0x14a)](_0x5a2b78,_0xe416b6['x']+_0xe416b6[_0x182d2f(0x1c4)]));});const _0x54642e=gameCanvas[_0x426382(0x1c4)]*GRID_HORIZONTAL_MARGIN_PERCENT,_0x40b663=gameCanvas[_0x426382(0x1c4)]*(0x1-GRID_HORIZONTAL_MARGIN_PERCENT);if(gridMoveDirection===0x1&&_0x5a2b78>=_0x40b663)gridMoveDirection=-0x1;else{if(gridMoveDirection===-0x1&&_0x5aaefb<=_0x54642e)gridMoveDirection=0x1;}const _0x4041d5=scaleValue(level,BASE_GRID_MOVE_SPEED,MAX_GRID_MOVE_SPEED);_0x188ae7=_0x4041d5*gridMoveDirection,currentGridOffsetX+=_0x188ae7,enemies[_0x426382(0xce)](_0x597b31=>{const _0x28e640=_0x426382;if(_0x597b31&&(_0x597b31[_0x28e640(0x106)]===_0x28e640(0x14e)||_0x597b31[_0x28e640(0x106)]===_0x28e640(0x9d)||_0x597b31['state']===_0x28e640(0x15f)))try{const _0x552d20=_0x597b31[_0x28e640(0x9f)]===ENEMY3_TYPE?BOSS_WIDTH:_0x597b31[_0x28e640(0x9f)]===ENEMY1_TYPE?ENEMY1_WIDTH:ENEMY_WIDTH,{x:_0x5b9c9e,y:_0x4fe8e5}=getCurrentGridSlotPosition(_0x597b31[_0x28e640(0x1c9)],_0x597b31[_0x28e640(0x1bf)],_0x552d20);_0x597b31[_0x28e640(0xbe)]=_0x5b9c9e,_0x597b31[_0x28e640(0x191)]=_0x4fe8e5;}catch(_0x279e71){console[_0x28e640(0x95)](_0x28e640(0x141)+_0x597b31?.['id']+_0x28e640(0x144)+_0x597b31?.[_0x28e640(0x106)]+_0x28e640(0xff),_0x279e71);}});}}else isGridSoundPlaying&&(stopSound('gridBackgroundSound'),isGridSoundPlaying=![]),_0x188ae7=0x0;for(let _0x436f09=enemies[_0x426382(0x100)]-0x1;_0x436f09>=0x0;_0x436f09--){let _0x585de9=enemies[_0x436f09];if(!_0x585de9){enemies['splice'](_0x436f09,0x1);continue;}const _0x2a8d85=_0x585de9['id'];if(_0x585de9[_0x426382(0x123)]&&_0x585de9[_0x426382(0x106)]!==_0x426382(0x13d)){clearTimeout(_0x585de9[_0x426382(0x123)]);const _0x9f3889=enemySpawnTimeouts['indexOf'](_0x585de9[_0x426382(0x123)]);if(_0x9f3889>-0x1)enemySpawnTimeouts['splice'](_0x9f3889,0x1);_0x585de9[_0x426382(0x123)]=null;}const _0x255d5a=_0x585de9['type']===ENEMY3_TYPE?BOSS_WIDTH:_0x585de9['type']===ENEMY1_TYPE?ENEMY1_WIDTH:ENEMY_WIDTH,_0x127035=_0x585de9['type']===ENEMY3_TYPE?BOSS_HEIGHT:_0x585de9[_0x426382(0x9f)]===ENEMY1_TYPE?ENEMY1_HEIGHT:ENEMY_HEIGHT;switch(_0x585de9[_0x426382(0x106)]){case _0x426382(0x18f):{let _0x17e516=CS_ENTRANCE_PATH_SPEED;const _0x279ee4=_0x585de9[_0x426382(0x96)]||0x1;_0x17e516*=_0x279ee4;if(!isChallengingStage){enemies['splice'](_0x436f09,0x1),_0x585de9=null;break;}let _0x1dc4ef=challengingStagePaths,_0x55f2b2=_0x1dc4ef[_0x585de9[_0x426382(0x182)]];if(!_0x55f2b2||_0x585de9['pathSegmentIndex']>=_0x55f2b2['length']){enemies[_0x426382(0x1b0)](_0x436f09,0x1),_0x585de9=null;break;}const _0xd4a6f6=_0x55f2b2[_0x585de9[_0x426382(0x198)]];if(!_0xd4a6f6||!_0xd4a6f6['p0']||!_0xd4a6f6['p1']||!_0xd4a6f6['p2']||!_0xd4a6f6['p3']){console['error']('Invalid\x20CS\x20Bezier\x20segment\x20'+_0x585de9[_0x426382(0x198)]+_0x426382(0x1a5)+_0x585de9[_0x426382(0x182)]+_0x426382(0x125)+_0x585de9['id']),enemies[_0x426382(0x1b0)](_0x436f09,0x1),_0x585de9=null;break;}_0x585de9[_0x426382(0xe6)]+=_0x17e516;let _0x2453ef,_0x5085a6,_0x3fa5cb=_0x585de9['x'],_0x2bfb6f=_0x585de9['y'];if(_0x585de9[_0x426382(0xe6)]>=0x1){_0x585de9['pathT']=0x0,_0x585de9[_0x426382(0x198)]++;if(_0x585de9[_0x426382(0x198)]>=_0x55f2b2[_0x426382(0x100)])enemies[_0x426382(0x1b0)](_0x436f09,0x1),_0x585de9=null;else{const _0x28507e=_0x55f2b2[_0x585de9[_0x426382(0x198)]];_0x28507e?.['p0']?(_0x2453ef=_0x28507e['p0']['x'],_0x5085a6=_0x28507e['p0']['y']):(console[_0x426382(0x95)](_0x426382(0x19f)+_0x585de9['pathSegmentIndex']+_0x426382(0x1a5)+_0x585de9['entrancePathId']+_0x426382(0x125)+_0x2a8d85),enemies[_0x426382(0x1b0)](_0x436f09,0x1),_0x585de9=null);}}else try{_0x2453ef=calculateBezierPoint(_0x585de9[_0x426382(0xe6)],_0xd4a6f6['p0']['x'],_0xd4a6f6['p1']['x'],_0xd4a6f6['p2']['x'],_0xd4a6f6['p3']['x']),_0x5085a6=calculateBezierPoint(_0x585de9[_0x426382(0xe6)],_0xd4a6f6['p0']['y'],_0xd4a6f6['p1']['y'],_0xd4a6f6['p2']['y'],_0xd4a6f6['p3']['y']);}catch(_0x2d751f){console[_0x426382(0x95)](_0x426382(0x18b)+_0x2a8d85+':',_0x2d751f),enemies[_0x426382(0x1b0)](_0x436f09,0x1),_0x585de9=null;}_0x585de9&&(isNaN(_0x2453ef)||isNaN(_0x5085a6)?(console['error'](_0x426382(0x10e)+_0x2a8d85+_0x426382(0x134)),enemies[_0x426382(0x1b0)](_0x436f09,0x1),_0x585de9=null):(_0x585de9[_0x426382(0x12e)]=_0x2453ef-_0x3fa5cb,_0x585de9['velocityY']=_0x5085a6-_0x2bfb6f,_0x585de9['x']=_0x2453ef,_0x585de9['y']=_0x5085a6));break;}case _0x426382(0xd3):{if(isChallengingStage){enemies[_0x426382(0x1b0)](_0x436f09,0x1),_0x585de9=null;break;}let _0x382d67=normalWaveEntrancePaths,_0x3d14ce=_0x382d67[_0x585de9[_0x426382(0x182)]],_0x5387f8;_0x585de9[_0x426382(0x182)]===_0x426382(0x177)||_0x585de9[_0x426382(0x182)]==='boss_loop_right'?_0x5387f8=BOSS_LOOP_ENTRANCE_PATH_SPEED:_0x5387f8=NORMAL_ENTRANCE_PATH_SPEED;if(!_0x3d14ce){console[_0x426382(0x137)](_0x426382(0xa7)+_0x2a8d85+_0x426382(0x155)+_0x585de9[_0x426382(0x182)]+'.\x20Switching\x20to\x20moving_to_grid.');try{_0x585de9[_0x426382(0xbe)]=_0x585de9['targetGridX']??gameCanvas[_0x426382(0x1c4)]/0x2,_0x585de9['targetGridY']=_0x585de9[_0x426382(0x191)]??ENEMY_TOP_MARGIN;}catch(_0x4878af){console[_0x426382(0x95)]('Error\x20getting\x20grid\x20pos\x20for\x20'+_0x2a8d85+_0x426382(0x108),_0x4878af),_0x585de9[_0x426382(0xbe)]=gameCanvas['width']/0x2,_0x585de9['targetGridY']=ENEMY_TOP_MARGIN;}_0x585de9[_0x426382(0x106)]=_0x426382(0x15f),_0x585de9[_0x426382(0xe6)]=0x0,_0x585de9['pathSegmentIndex']=0x0,_0x585de9[_0x426382(0x12e)]=0x0,_0x585de9[_0x426382(0x174)]=0x0;_0x585de9[_0x426382(0x163)]!==undefined&&squadronCompletionStatus[_0x585de9[_0x426382(0x163)]]&&squadronCompletionStatus[_0x585de9[_0x426382(0x163)]][_0x426382(0x9e)]++;break;}if(_0x585de9[_0x426382(0x198)]>=_0x3d14ce[_0x426382(0x100)]){console[_0x426382(0x137)](_0x426382(0xa7)+_0x2a8d85+_0x426382(0x162)+_0x585de9[_0x426382(0x198)]+_0x426382(0x1b8)+_0x585de9[_0x426382(0x182)]+_0x426382(0xba));try{_0x585de9[_0x426382(0xbe)]=_0x585de9[_0x426382(0xbe)]??gameCanvas[_0x426382(0x1c4)]/0x2,_0x585de9[_0x426382(0x191)]=_0x585de9[_0x426382(0x191)]??ENEMY_TOP_MARGIN;}catch(_0x335026){console[_0x426382(0x95)](_0x426382(0xdc)+_0x2a8d85+_0x426382(0x102),_0x335026),_0x585de9['targetGridX']=gameCanvas[_0x426382(0x1c4)]/0x2,_0x585de9[_0x426382(0x191)]=ENEMY_TOP_MARGIN;}_0x585de9['state']=_0x426382(0x15f),_0x585de9[_0x426382(0xe6)]=0x0,_0x585de9[_0x426382(0x198)]=0x0,_0x585de9[_0x426382(0x12e)]=0x0,_0x585de9[_0x426382(0x174)]=0x0;_0x585de9[_0x426382(0x163)]!==undefined&&squadronCompletionStatus[_0x585de9['squadronId']]&&squadronCompletionStatus[_0x585de9[_0x426382(0x163)]]['completed']++;break;}const _0x560de2=_0x3d14ce[_0x585de9[_0x426382(0x198)]];if(!_0x560de2||!_0x560de2['p0']||!_0x560de2['p1']||!_0x560de2['p2']||!_0x560de2['p3']){console[_0x426382(0x95)](_0x426382(0x16a)+_0x585de9[_0x426382(0x198)]+'\x20for\x20SHARED\x20path\x20'+_0x585de9[_0x426382(0x182)]+_0x426382(0x125)+_0x2a8d85+_0x426382(0xba));try{_0x585de9[_0x426382(0xbe)]=_0x585de9[_0x426382(0xbe)]??gameCanvas[_0x426382(0x1c4)]/0x2,_0x585de9['targetGridY']=_0x585de9[_0x426382(0x191)]??ENEMY_TOP_MARGIN+_0x585de9[_0x426382(0x1c9)]*(ENEMY_HEIGHT+ENEMY_V_SPACING);}catch(_0x13e7e1){console[_0x426382(0x95)](_0x426382(0xdc)+_0x2a8d85+_0x426382(0xcc),_0x13e7e1),_0x585de9[_0x426382(0xbe)]=gameCanvas['width']/0x2,_0x585de9['targetGridY']=ENEMY_TOP_MARGIN;}_0x585de9[_0x426382(0x106)]=_0x426382(0x15f),_0x585de9['pathT']=0x0,_0x585de9[_0x426382(0x198)]=0x0,_0x585de9[_0x426382(0x12e)]=0x0,_0x585de9[_0x426382(0x174)]=0x0;_0x585de9[_0x426382(0x163)]!==undefined&&squadronCompletionStatus[_0x585de9[_0x426382(0x163)]]&&squadronCompletionStatus[_0x585de9[_0x426382(0x163)]][_0x426382(0x9e)]++;break;}_0x585de9[_0x426382(0xe6)]+=_0x5387f8;let _0x3885be,_0x44b56a,_0x1cc31c=_0x585de9['x'],_0x5d57f9=_0x585de9['y'];if(_0x585de9['pathT']>=0x1){_0x585de9[_0x426382(0xe6)]=0x0,_0x585de9[_0x426382(0x198)]++;if(_0x585de9[_0x426382(0x198)]>=_0x3d14ce[_0x426382(0x100)]){let _0x1a8fa3,_0x5868dd;try{_0x1a8fa3=calculateBezierPoint(0x1,_0x560de2['p0']['x'],_0x560de2['p1']['x'],_0x560de2['p2']['x'],_0x560de2['p3']['x']),_0x5868dd=calculateBezierPoint(0x1,_0x560de2['p0']['y'],_0x560de2['p1']['y'],_0x560de2['p2']['y'],_0x560de2['p3']['y']);}catch(_0x31ce92){console['error']('Error\x20calculating\x20final\x20bezier\x20point\x20for\x20'+_0x2a8d85+_0x426382(0x176)+_0x585de9[_0x426382(0x182)],_0x31ce92),_0x1a8fa3=_0x560de2['p3']['x'],_0x5868dd=_0x560de2['p3']['y'];}_0x585de9['x']=_0x1a8fa3,_0x585de9['y']=_0x5868dd;try{_0x585de9[_0x426382(0xbe)]=_0x585de9[_0x426382(0xbe)]??gameCanvas[_0x426382(0x1c4)]/0x2,_0x585de9[_0x426382(0x191)]=_0x585de9[_0x426382(0x191)]??ENEMY_TOP_MARGIN;}catch(_0x56932b){console[_0x426382(0x95)](_0x426382(0x1c6)+_0x2a8d85+'\x20at\x20end\x20of\x20normal\x20path\x20'+_0x585de9[_0x426382(0x182)],_0x56932b),_0x585de9[_0x426382(0xbe)]=_0x585de9['x'],_0x585de9[_0x426382(0x191)]=ENEMY_TOP_MARGIN+_0x585de9['gridRow']*(ENEMY_HEIGHT+ENEMY_V_SPACING);}const _0x2b4d75=_0x585de9[_0x426382(0x106)];_0x585de9[_0x426382(0x106)]=_0x426382(0x15f),_0x585de9[_0x426382(0x12e)]=0x0,_0x585de9[_0x426382(0x174)]=0x0,_0x585de9[_0x426382(0x198)]=0x0;_0x2b4d75===_0x426382(0xd3)&&_0x585de9['squadronId']!==undefined&&squadronCompletionStatus[_0x585de9[_0x426382(0x163)]]&&squadronCompletionStatus[_0x585de9['squadronId']][_0x426382(0x9e)]++;break;}else{const _0x77b961=_0x3d14ce[_0x585de9[_0x426382(0x198)]];if(_0x77b961?.['p0'])_0x3885be=_0x77b961['p0']['x'],_0x44b56a=_0x77b961['p0']['y'];else{console[_0x426382(0x95)](_0x426382(0x179)+_0x585de9[_0x426382(0x198)]+'\x20for\x20SHARED\x20path\x20'+_0x585de9[_0x426382(0x182)]+_0x426382(0x125)+_0x2a8d85+_0x426382(0xba));try{_0x585de9[_0x426382(0xbe)]=_0x585de9[_0x426382(0xbe)]??gameCanvas[_0x426382(0x1c4)]/0x2,_0x585de9[_0x426382(0x191)]=_0x585de9[_0x426382(0x191)]??ENEMY_TOP_MARGIN;}catch(_0x33d2d3){console[_0x426382(0x95)](_0x426382(0xdc)+_0x2a8d85+_0x426382(0x136),_0x33d2d3),_0x585de9[_0x426382(0xbe)]=gameCanvas[_0x426382(0x1c4)]/0x2,_0x585de9[_0x426382(0x191)]=ENEMY_TOP_MARGIN;}_0x585de9['state']=_0x426382(0x15f),_0x585de9['pathT']=0x0,_0x585de9[_0x426382(0x198)]=0x0,_0x585de9[_0x426382(0x12e)]=0x0,_0x585de9[_0x426382(0x174)]=0x0;_0x585de9[_0x426382(0x163)]!==undefined&&squadronCompletionStatus[_0x585de9[_0x426382(0x163)]]&&squadronCompletionStatus[_0x585de9[_0x426382(0x163)]][_0x426382(0x9e)]++;break;}}}else try{_0x3885be=calculateBezierPoint(_0x585de9[_0x426382(0xe6)],_0x560de2['p0']['x'],_0x560de2['p1']['x'],_0x560de2['p2']['x'],_0x560de2['p3']['x']),_0x44b56a=calculateBezierPoint(_0x585de9[_0x426382(0xe6)],_0x560de2['p0']['y'],_0x560de2['p1']['y'],_0x560de2['p2']['y'],_0x560de2['p3']['y']);}catch(_0x5da8c0){console['error'](_0x426382(0x12c)+_0x2a8d85+':',_0x5da8c0);try{_0x585de9[_0x426382(0xbe)]=_0x585de9[_0x426382(0xbe)]??gameCanvas[_0x426382(0x1c4)]/0x2,_0x585de9[_0x426382(0x191)]=_0x585de9[_0x426382(0x191)]??ENEMY_TOP_MARGIN;}catch(_0x3764eb){console[_0x426382(0x95)](_0x426382(0xdc)+_0x2a8d85+_0x426382(0x158),_0x3764eb),_0x585de9[_0x426382(0xbe)]=gameCanvas[_0x426382(0x1c4)]/0x2,_0x585de9[_0x426382(0x191)]=ENEMY_TOP_MARGIN;}_0x585de9['state']='moving_to_grid',_0x585de9[_0x426382(0xe6)]=0x0,_0x585de9['pathSegmentIndex']=0x0,_0x585de9[_0x426382(0x12e)]=0x0,_0x585de9[_0x426382(0x174)]=0x0;_0x585de9[_0x426382(0x163)]!==undefined&&squadronCompletionStatus[_0x585de9[_0x426382(0x163)]]&&squadronCompletionStatus[_0x585de9[_0x426382(0x163)]][_0x426382(0x9e)]++;break;}if(_0x585de9&&_0x585de9[_0x426382(0x106)]===_0x426382(0xd3)){if(isNaN(_0x3885be)||isNaN(_0x44b56a)){console[_0x426382(0x95)](_0x426382(0x11a)+_0x2a8d85+_0x426382(0xba));try{_0x585de9[_0x426382(0xbe)]=_0x585de9['targetGridX']??gameCanvas[_0x426382(0x1c4)]/0x2,_0x585de9[_0x426382(0x191)]=_0x585de9[_0x426382(0x191)]??ENEMY_TOP_MARGIN;}catch(_0x53dff1){console[_0x426382(0x95)](_0x426382(0xdc)+_0x2a8d85+'\x20after\x20NaN',_0x53dff1),_0x585de9[_0x426382(0xbe)]=gameCanvas['width']/0x2,_0x585de9['targetGridY']=ENEMY_TOP_MARGIN;}_0x585de9[_0x426382(0x106)]=_0x426382(0x15f),_0x585de9[_0x426382(0xe6)]=0x0,_0x585de9[_0x426382(0x198)]=0x0,_0x585de9[_0x426382(0x12e)]=0x0,_0x585de9[_0x426382(0x174)]=0x0,_0x585de9['squadronId']!==undefined&&squadronCompletionStatus[_0x585de9[_0x426382(0x163)]]&&squadronCompletionStatus[_0x585de9[_0x426382(0x163)]][_0x426382(0x9e)]++;}else{let _0x5a3115=_0x3885be;const _0x5c9057=currentWavePatternIndex===0x1&&(_0x585de9['squadronId']===0x2||_0x585de9[_0x426382(0x163)]===0x3),_0x308d85=typeof _0x585de9[_0x426382(0x1c1)]===_0x426382(0x112)&&_0x585de9[_0x426382(0x1c1)]%0x2!==0x0;if(_0x5c9057&&_0x308d85){const _0x51904c=_0x255d5a+ENTRANCE_PAIR_HORIZONTAL_GAP;_0x5a3115=_0x3885be+_0x51904c;}_0x585de9[_0x426382(0x12e)]=_0x5a3115-_0x1cc31c,_0x585de9['velocityY']=_0x44b56a-_0x5d57f9,_0x585de9['x']=_0x5a3115,_0x585de9['y']=_0x44b56a;}}break;}case'moving_to_grid':{if(_0x585de9[_0x426382(0xbe)]==null||_0x585de9['targetGridY']==null){console[_0x426382(0x137)](_0x426382(0xa7)+_0x2a8d85+_0x426382(0x1a8));try{const {x:_0x372322,y:_0x309c89}=getCurrentGridSlotPosition(_0x585de9['gridRow'],_0x585de9['gridCol'],_0x255d5a);_0x585de9[_0x426382(0xbe)]=_0x372322,_0x585de9['targetGridY']=_0x309c89;}catch(_0x46aaa4){console[_0x426382(0x95)](_0x426382(0xdc)+_0x2a8d85+_0x426382(0xc3),_0x46aaa4),_0x585de9[_0x426382(0x106)]=_0x426382(0x9d),_0x585de9['x']=gameCanvas['width']/0x2,_0x585de9['y']=ENEMY_TOP_MARGIN;break;}}const _0x154d6a=_0x585de9['targetGridX'],_0x135a27=_0x585de9[_0x426382(0x191)],_0x4b3e6f=_0x154d6a-_0x585de9['x'],_0x1e8812=_0x135a27-_0x585de9['y'],_0x260f7b=Math[_0x426382(0x1b2)](_0x4b3e6f*_0x4b3e6f+_0x1e8812*_0x1e8812),_0x35134b=ENTRANCE_SPEED*1.2,_0x5a0e5f=_0x35134b*0.5;if(_0x260f7b>_0x5a0e5f)_0x585de9[_0x426382(0x12e)]=_0x4b3e6f/_0x260f7b*_0x35134b,_0x585de9[_0x426382(0x174)]=_0x1e8812/_0x260f7b*_0x35134b,_0x585de9['x']+=_0x585de9['velocityX'],_0x585de9['y']+=_0x585de9[_0x426382(0x174)];else{_0x585de9['x']=_0x154d6a,_0x585de9['y']=_0x135a27,_0x585de9[_0x426382(0x12e)]=0x0,_0x585de9['velocityY']=0x0;const _0x13fbe8=_0x585de9[_0x426382(0x106)];_0x585de9[_0x426382(0x106)]=_0x426382(0x9d),_0x585de9['justReturned']=![];!isGridSoundPlaying&&!isChallengingStage&&(isGridSoundPlaying=!![],playSound(_0x426382(0x11c),!![],0.1));GRID_BREATH_ENABLED&&!isGridBreathingActive&&!isChallengingStage&&(isGridBreathingActive=!![],gridBreathStartTime=_0x2a69df,currentGridBreathFactor=0x0);!firstEnemyLanded&&!isFullGridWave&&!isChallengingStage&&(lastGridFireCheckTime=Date[_0x426382(0x1a6)](),firstEnemyLanded=!![]);if(_0x13fbe8===_0x426382(0x15f)&&!isChallengingStage&&!isFullGridWave&&_0x585de9[_0x426382(0x163)]!==undefined){const _0x5d2668=_0x585de9[_0x426382(0x163)],_0x2d10e6=squadronCompletionStatus[_0x5d2668];if(_0x2d10e6&&!_0x2d10e6[_0x426382(0x1c7)]){const _0x355e5e=enemies['every'](_0x1eac03=>{const _0x52bb32=_0x426382;if(_0x1eac03&&_0x1eac03[_0x52bb32(0x163)]===_0x5d2668)return _0x1eac03[_0x52bb32(0x106)]===_0x52bb32(0x9d)||!enemies[_0x52bb32(0xdd)](_0x57e28a=>_0x57e28a['id']===_0x1eac03['id']);return!![];});if(_0x355e5e){_0x2d10e6[_0x426382(0x1c7)]=!![];const _0x170d26=enemies[_0x426382(0x19e)](_0x1f4a8a=>_0x1f4a8a&&_0x1f4a8a[_0x426382(0x163)]===_0x5d2668&&_0x1f4a8a[_0x426382(0x106)]===_0x426382(0x9d)&&(_0x1f4a8a['type']===ENEMY2_TYPE||_0x1f4a8a[_0x426382(0x9f)]===ENEMY3_TYPE)&&!(_0x1f4a8a[_0x426382(0x9f)]===ENEMY3_TYPE&&_0x1f4a8a['hasCapturedShip']));if(_0x170d26[_0x426382(0x100)]>0x0){const _0x5001b9=_0x170d26[Math[_0x426382(0x9c)](Math['random']()*_0x170d26[_0x426382(0x100)])],_0x3eeba6=_0x5001b9['id'],_0x28d928=0xc8+Math['random']()*0x190,_0x48ec89=setTimeout(()=>{const _0x41c2fd=_0x426382;try{const _0x56e71a=enemySpawnTimeouts[_0x41c2fd(0x91)](_0x48ec89);if(_0x56e71a>-0x1)enemySpawnTimeouts[_0x41c2fd(0x1b0)](_0x56e71a,0x1);if(isPaused||!isInGameState||playerLives<=0x0&&(!isTwoPlayerMode||player1Lives<=0x0&&player2Lives<=0x0)||isChallengingStage||isWaveTransitioning||isShipCaptured)return;const _0x2a0791=enemies['find'](_0x261cc9=>_0x261cc9&&_0x261cc9['id']===_0x3eeba6);_0x2a0791&&_0x2a0791[_0x41c2fd(0x106)]===_0x41c2fd(0x9d)&&(createBulletSimple(_0x2a0791)&&(playSound(_0x41c2fd(0xfb),![],0.4),_0x2a0791[_0x41c2fd(0xa8)]=Date[_0x41c2fd(0x1a6)]()));}catch(_0x3ef809){console[_0x41c2fd(0x95)]('Error\x20during\x20post-landing\x20fire\x20for\x20'+_0x3eeba6+':',_0x3ef809);}},_0x28d928);enemySpawnTimeouts[_0x426382(0xd2)](_0x48ec89);}}}}}break;}case _0x426382(0x9d):{try{const _0x189d69=_0x585de9[_0x426382(0x9f)]===ENEMY3_TYPE?BOSS_WIDTH:_0x585de9[_0x426382(0x9f)]===ENEMY1_TYPE?ENEMY1_WIDTH:ENEMY_WIDTH,{x:_0x5194a8,y:_0x2e4f8f}=getCurrentGridSlotPosition(_0x585de9['gridRow'],_0x585de9[_0x426382(0x1bf)],_0x189d69);typeof _0x5194a8===_0x426382(0x112)&&!isNaN(_0x5194a8)&&(_0x585de9['x']=_0x5194a8),typeof _0x2e4f8f===_0x426382(0x112)&&!isNaN(_0x2e4f8f)&&(_0x585de9['y']=_0x2e4f8f),_0x585de9[_0x426382(0xbe)]=_0x5194a8,_0x585de9['targetGridY']=_0x2e4f8f;}catch(_0x4be50b){console[_0x426382(0x95)](_0x426382(0x153)+_0x585de9['id']+':',_0x4be50b);}_0x585de9[_0x426382(0x12e)]=_0x3be742?_0x188ae7:0x0,_0x585de9[_0x426382(0x174)]=0x0;_0x585de9[_0x426382(0x9f)]===ENEMY3_TYPE&&_0x585de9[_0x426382(0x1b9)]&&_0x585de9[_0x426382(0x1bd)]&&(_0x585de9[_0x426382(0x183)]=_0x585de9['x']+CAPTURED_SHIP_OFFSET_X,_0x585de9[_0x426382(0x98)]=_0x585de9['y']+CAPTURED_SHIP_OFFSET_Y);break;}case _0x426382(0x147):{_0x585de9[_0x426382(0x12e)]=0x0,_0x585de9[_0x426382(0x174)]=0x0;break;}case _0x426382(0x13d):{_0x585de9[_0x426382(0x12e)]=0x0,_0x585de9[_0x426382(0x174)]=0x0;break;}case _0x426382(0xd5):{let _0x1d4781=isTwoPlayerMode&&selectedGameMode===_0x426382(0x99)?isPlayer1ShipCaptured||isPlayer2ShipCaptured:isShipCaptured;if(_0x1d4781){_0x585de9['state']=_0x426382(0x14e);try{const {x:_0x4b650d,y:_0x56218f}=getCurrentGridSlotPosition(_0x585de9['gridRow'],_0x585de9[_0x426382(0x1bf)],_0x255d5a);_0x585de9['targetGridX']=_0x4b650d,_0x585de9['targetGridY']=_0x56218f;}catch(_0xf1f2f){console['error']('Error\x20getting\x20grid\x20pos\x20for\x20returning\x20boss\x20'+_0x585de9['id']+':',_0xf1f2f),_0x585de9[_0x426382(0xbe)]=gameCanvas[_0x426382(0x1c4)]/0x2,_0x585de9[_0x426382(0x191)]=ENEMY_TOP_MARGIN;}break;}const _0xba7a70=_0x585de9['targetX'],_0x4ed384=_0x585de9[_0x426382(0xc6)];if(_0xba7a70==null||_0x4ed384==null){console[_0x426382(0x95)](_0x426382(0x188)+_0x585de9['id']+_0x426382(0x145)),_0x585de9[_0x426382(0x106)]=_0x426382(0x14e);try{const {x:_0x21a78a,y:_0x347ca0}=getCurrentGridSlotPosition(_0x585de9[_0x426382(0x1c9)],_0x585de9['gridCol'],_0x255d5a);_0x585de9[_0x426382(0xbe)]=_0x21a78a,_0x585de9[_0x426382(0x191)]=_0x347ca0;}catch(_0x2e8b3b){console[_0x426382(0x95)](_0x426382(0xcf)+_0x585de9['id']+':',_0x2e8b3b),_0x585de9[_0x426382(0xbe)]=gameCanvas['width']/0x2,_0x585de9[_0x426382(0x191)]=ENEMY_TOP_MARGIN;}break;}const _0x47ed6d=_0xba7a70-_0x585de9['x'],_0x16ec6d=_0x4ed384-_0x585de9['y'],_0x3a6f1a=Math[_0x426382(0x1b2)](_0x47ed6d*_0x47ed6d+_0x16ec6d*_0x16ec6d),_0x440d3a=BOSS_CAPTURE_DIVE_SPEED_FACTOR*BASE_ENEMY_ATTACK_SPEED,_0x4ad8c4=_0x440d3a*0.6;_0x3a6f1a>_0x4ad8c4?(_0x585de9['velocityX']=_0x47ed6d/_0x3a6f1a*_0x440d3a,_0x585de9['velocityY']=_0x16ec6d/_0x3a6f1a*_0x440d3a,_0x585de9['x']+=_0x585de9[_0x426382(0x12e)],_0x585de9['y']+=_0x585de9[_0x426382(0x174)]):(_0x585de9['x']=_0xba7a70,_0x585de9['y']=_0x4ed384,_0x585de9[_0x426382(0x12e)]=0x0,_0x585de9[_0x426382(0x174)]=0x0,_0x585de9[_0x426382(0x106)]='capturing',_0x585de9['captureStartTime']=_0x2a69df,capturingBossId=_0x585de9['id'],captureBeamActive=!![],captureBeamSource={'x':_0x585de9['x']+_0x255d5a/0x2,'y':_0x585de9['y']+_0x127035},captureBeamTargetY=_0x585de9['y'],captureBeamProgress=0x0,playSound(_0x426382(0x1ae),![],0.6),_0x585de9[_0x426382(0x184)]&&(captureAttemptMadeThisLevel=!![],delete _0x585de9[_0x426382(0x184)]));break;}case _0x426382(0x113):{_0x585de9[_0x426382(0x12e)]=0x0,_0x585de9[_0x426382(0x174)]=0x0;_0x585de9['isPreparingForImmediateCapture']&&!captureAttemptMadeThisLevel&&(captureAttemptMadeThisLevel=!![],delete _0x585de9[_0x426382(0x184)]);let _0x5d4ced=![];isTwoPlayerMode&&selectedGameMode===_0x426382(0x99)?_0x5d4ced=isPlayer1ShipCaptured&&capturedBossIdWithMessage===_0x585de9['id']||isPlayer2ShipCaptured&&capturedBossIdWithMessage===_0x585de9['id']:_0x5d4ced=isShipCaptured&&capturedBossIdWithMessage===_0x585de9['id'];if(_0x5d4ced){captureBeamActive=![];if(capturingBossId===_0x585de9['id'])capturingBossId=null;_0x585de9['state']=_0x426382(0x14e),stopSound(_0x426382(0x1ae));break;}const _0x8990f1=_0x2a69df-_0x585de9['captureStartTime'],_0x375fd9=CAPTURE_BEAM_ANIMATION_DURATION_MS/0x2,_0x13068f=CAPTURE_BEAM_DURATION_MS;if(_0x8990f1<_0x375fd9)captureBeamProgress=_0x8990f1/_0x375fd9;else{if(_0x8990f1<_0x13068f-_0x375fd9)captureBeamProgress=0x1;else{if(_0x8990f1<_0x13068f)captureBeamProgress=0x1-(_0x8990f1-(_0x13068f-_0x375fd9))/_0x375fd9;else{captureBeamProgress=0x0,captureBeamActive=![],capturingBossId=null,stopSound('captureSound'),_0x585de9['state']=_0x426382(0xeb),_0x585de9[_0x426382(0x16c)]=generateAttackPathInternal(_0x585de9),_0x585de9[_0x426382(0x119)]=0x0,_0x585de9['attackPathT']=0x0,_0x585de9[_0x426382(0x17f)]=BASE_ENEMY_ATTACK_SPEED*ENEMY3_ATTACK_SPEED_FACTOR,_0x585de9[_0x426382(0xa8)]=0x0,_0x585de9[_0x426382(0x135)]=!![],_0x585de9[_0x426382(0xda)]=0x0,_0x585de9['attackGroupId']=null;break;}}}captureBeamProgress=Math[_0x426382(0x14a)](0x0,Math[_0x426382(0xf4)](0x1,captureBeamProgress));if(captureBeamActive&&captureBeamProgress>=0.95){const _0x393495=BOSS_WIDTH*CAPTURE_BEAM_WIDTH_TOP_FACTOR,_0x2770d0=SHIP_WIDTH*CAPTURE_BEAM_WIDTH_BOTTOM_FACTOR,_0x1aefc2=_0x585de9['x']+_0x255d5a/0x2,_0x9bed6d=_0x585de9['y']+_0x127035,_0x5eec60=gameCanvas[_0x426382(0x120)]-LIFE_ICON_MARGIN_BOTTOM-LIFE_ICON_SIZE-0xa,_0x238baf=Math['max'](_0x393495,_0x2770d0),_0x27254d=_0x1aefc2-_0x238baf/0x2,_0x27b02c=_0x9bed6d,_0xb034f3=_0x5eec60-_0x9bed6d;if(_0xb034f3>0x0){const _0x17b093={'x':_0x27254d,'y':_0x27b02c,'width':_0x238baf,'height':_0xb034f3};let _0x4d63da=null,_0x284939=0x0;if(isTwoPlayerMode&&selectedGameMode===_0x426382(0x99)){if(ship1&&player1Lives>0x0&&!isPlayer1ShipCaptured&&checkCollision(ship1,_0x17b093))_0x4d63da=ship1,_0x284939=0x1;else ship2&&player2Lives>0x0&&!isPlayer2ShipCaptured&&checkCollision(ship2,_0x17b093)&&(_0x4d63da=ship2,_0x284939=0x2);}else ship&&playerLives>0x0&&!isShipCaptured&&checkCollision(ship,_0x17b093)&&(_0x4d63da=ship,_0x284939=currentPlayer);if(_0x4d63da){_0x585de9['capturedShipDimensions']={'width':_0x4d63da[_0x426382(0x1c4)],'height':_0x4d63da[_0x426382(0x120)]},_0x585de9[_0x426382(0x1b9)]=!![],stopSound(_0x426382(0x1ae)),_0x585de9[_0x426382(0x106)]=_0x426382(0x169),_0x585de9['targetGridX']=null,_0x585de9[_0x426382(0x191)]=null,_0x585de9[_0x426382(0x175)]=_0x4d63da['y'],_0x585de9['captureAnimationRotation']=0x0,isShowingCaptureMessage=!![],captureMessageStartTime=_0x2a69df,capturedBossIdWithMessage=_0x585de9['id'],playSound(_0x426382(0x17b),![],0.3),csCurrentChainHits=0x0,csCurrentChainScore=0x0,csLastHitTime=0x0,csLastChainHitPosition=null,normalWaveCurrentChainHits=0x0,normalWaveCurrentChainScore=0x0,normalWaveLastHitTime=0x0,normalWaveLastHitPosition=null,handlePlayerShipCollision(_0x284939,![],_0x2a69df,!![]);if((isCoopAIDemoActive||isPlayerTwoAI&&selectedOnePlayerGameVariant===_0x426382(0x165))&&aiPlayerActivelySeekingCaptureById)aiPlayerActivelySeekingCaptureById=null;break;}}}break;}case'showing_capture_message':{_0x585de9[_0x426382(0x12e)]=0x0,_0x585de9[_0x426382(0x174)]=0x0;if(_0x585de9[_0x426382(0x1b9)]&&_0x585de9[_0x426382(0x1bd)]&&typeof _0x585de9[_0x426382(0x175)]===_0x426382(0x112)){const _0x363983=_0x2a69df-captureMessageStartTime,_0x40a69c=Math['min'](0x1,_0x363983/CAPTURE_MESSAGE_DURATION),_0x490d3e=_0x585de9['y']+CAPTURED_SHIP_OFFSET_Y,_0x564110=_0x585de9['initialCaptureAnimationY'];_0x585de9[_0x426382(0x98)]=_0x564110+(_0x490d3e-_0x564110)*_0x40a69c,_0x585de9[_0x426382(0x183)]=_0x585de9['x']+CAPTURED_SHIP_OFFSET_X;}else _0x585de9[_0x426382(0x183)]=_0x585de9['x']+CAPTURED_SHIP_OFFSET_X,_0x585de9[_0x426382(0x98)]=_0x585de9['y']+CAPTURED_SHIP_OFFSET_Y;break;}case'attacking':{if(isEntrancePhaseActive)break;const _0x91b5ce=_0x585de9[_0x426382(0x16c)],_0x4e0f89=3.8;if(!_0x91b5ce||_0x91b5ce[_0x426382(0x100)]===0x0){console[_0x426382(0x95)](_0x426382(0xa7)+_0x2a8d85+_0x426382(0xa0)),_0x585de9[_0x426382(0x106)]='returning';try{const {x:_0x5bae8f,y:_0x4940d6}=getCurrentGridSlotPosition(_0x585de9[_0x426382(0x1c9)],_0x585de9[_0x426382(0x1bf)],_0x255d5a);_0x585de9[_0x426382(0xbe)]=_0x5bae8f,_0x585de9[_0x426382(0x191)]=_0x4940d6;}catch(_0x1118d4){console[_0x426382(0x95)](_0x426382(0xb5)+_0x2a8d85+_0x426382(0xb2),_0x1118d4),_0x585de9[_0x426382(0xbe)]=gameCanvas['width']/0x2,_0x585de9['targetGridY']=ENEMY_TOP_MARGIN;}break;}if(_0x585de9[_0x426382(0x119)]>=_0x91b5ce[_0x426382(0x100)]){console[_0x426382(0x137)](_0x426382(0xa7)+_0x2a8d85+_0x426382(0x12d)+_0x585de9[_0x426382(0x119)]+'\x20out\x20of\x20bounds\x20('+_0x91b5ce['length']+_0x426382(0xfa)),_0x585de9[_0x426382(0x106)]=_0x426382(0x14e);try{const {x:_0x2905ad,y:_0x528d31}=getCurrentGridSlotPosition(_0x585de9['gridRow'],_0x585de9[_0x426382(0x1bf)],_0x255d5a);_0x585de9[_0x426382(0xbe)]=_0x2905ad,_0x585de9[_0x426382(0x191)]=_0x528d31;}catch(_0x45be02){console[_0x426382(0x95)]('Error\x20getting\x20grid\x20pos\x20for\x20returning\x20enemy\x20'+_0x2a8d85+_0x426382(0xaa),_0x45be02),_0x585de9[_0x426382(0xbe)]=gameCanvas[_0x426382(0x1c4)]/0x2,_0x585de9[_0x426382(0x191)]=ENEMY_TOP_MARGIN;}break;}const _0x55458f=_0x91b5ce[_0x585de9[_0x426382(0x119)]];if(!_0x55458f||!_0x55458f['p0']||!_0x55458f['p1']||!_0x55458f['p2']||!_0x55458f['p3']){console[_0x426382(0x95)](_0x426382(0xa7)+_0x2a8d85+_0x426382(0xf5)+_0x585de9[_0x426382(0x119)]+_0x426382(0xbc)),_0x585de9[_0x426382(0x106)]=_0x426382(0x14e);try{const {x:_0x41fe7c,y:_0x3cd8b5}=getCurrentGridSlotPosition(_0x585de9[_0x426382(0x1c9)],_0x585de9['gridCol'],_0x255d5a);_0x585de9['targetGridX']=_0x41fe7c,_0x585de9[_0x426382(0x191)]=_0x3cd8b5;}catch(_0x1d25fa){console[_0x426382(0x95)](_0x426382(0xb5)+_0x2a8d85+_0x426382(0x16b),_0x1d25fa),_0x585de9[_0x426382(0xbe)]=gameCanvas[_0x426382(0x1c4)]/0x2,_0x585de9[_0x426382(0x191)]=ENEMY_TOP_MARGIN;}break;}const _0x59917a=_0x585de9['speed']/0x3e8*_0x4e0f89;_0x585de9[_0x426382(0x1ab)]+=_0x59917a;let _0x449b32,_0x437762;const _0x3d393d=_0x585de9['x'],_0x47dc27=_0x585de9['y'];if(_0x585de9[_0x426382(0x1ab)]>=0x1){try{_0x449b32=calculateBezierPoint(0x1,_0x55458f['p0']['x'],_0x55458f['p1']['x'],_0x55458f['p2']['x'],_0x55458f['p3']['x']),_0x437762=calculateBezierPoint(0x1,_0x55458f['p0']['y'],_0x55458f['p1']['y'],_0x55458f['p2']['y'],_0x55458f['p3']['y']);}catch(_0x5565b4){console[_0x426382(0x95)](_0x426382(0x111)+_0x585de9['id']+':',_0x5565b4),_0x449b32=_0x585de9['x'],_0x437762=_0x585de9['y'],_0x585de9[_0x426382(0x106)]='returning';try{const {x:_0xaab5d1,y:_0x14c126}=getCurrentGridSlotPosition(_0x585de9[_0x426382(0x1c9)],_0x585de9['gridCol'],_0x255d5a);_0x585de9[_0x426382(0xbe)]=_0xaab5d1,_0x585de9['targetGridY']=_0x14c126;}catch(_0x548e6f){console[_0x426382(0x95)]('Error\x20getting\x20grid\x20pos\x20after\x20FINAL\x20bezier\x20error\x20for\x20'+_0x585de9['id']+':',_0x548e6f),_0x585de9[_0x426382(0xbe)]=gameCanvas['width']/0x2,_0x585de9[_0x426382(0x191)]=ENEMY_TOP_MARGIN;}break;}_0x585de9[_0x426382(0x1ab)]=0x0,_0x585de9[_0x426382(0x119)]++;if(_0x585de9[_0x426382(0x119)]>=_0x91b5ce[_0x426382(0x100)]){_0x585de9[_0x426382(0x106)]=_0x426382(0x14e),_0x585de9['lastFiredTime']=0x0,_0x585de9['attackFormationOffsetX']=0x0,_0x585de9['attackGroupId']=null;try{const {x:_0x145de7,y:_0x450d1b}=getCurrentGridSlotPosition(_0x585de9['gridRow'],_0x585de9['gridCol'],_0x255d5a);_0x585de9[_0x426382(0xbe)]=_0x145de7,_0x585de9[_0x426382(0x191)]=_0x450d1b;}catch(_0x4c2a4a){console[_0x426382(0x95)](_0x426382(0xb5)+_0x2a8d85+'\x20after\x20attack:',_0x4c2a4a),_0x585de9[_0x426382(0xbe)]=gameCanvas['width']/0x2,_0x585de9['targetGridY']=ENEMY_TOP_MARGIN;}}else{const _0xf165da=_0x91b5ce[_0x585de9[_0x426382(0x119)]];if(!_0xf165da?.['p0']){console[_0x426382(0x95)](_0x426382(0xa7)+_0x2a8d85+_0x426382(0x126)+_0x585de9[_0x426382(0x119)]+'!\x20Returning.'),_0x449b32=_0x585de9['x'],_0x437762=_0x585de9['y'],_0x585de9['state']='returning';try{const {x:_0x43b6e3,y:_0x38a219}=getCurrentGridSlotPosition(_0x585de9[_0x426382(0x1c9)],_0x585de9['gridCol'],_0x255d5a);_0x585de9[_0x426382(0xbe)]=_0x43b6e3,_0x585de9[_0x426382(0x191)]=_0x38a219;}catch(_0x4760a3){console[_0x426382(0x95)](_0x426382(0x1a0)+_0x585de9['id']+':',_0x4760a3),_0x585de9[_0x426382(0xbe)]=gameCanvas[_0x426382(0x1c4)]/0x2,_0x585de9[_0x426382(0x191)]=ENEMY_TOP_MARGIN;}break;}}}else try{_0x449b32=calculateBezierPoint(_0x585de9['attackPathT'],_0x55458f['p0']['x'],_0x55458f['p1']['x'],_0x55458f['p2']['x'],_0x55458f['p3']['x']),_0x437762=calculateBezierPoint(_0x585de9[_0x426382(0x1ab)],_0x55458f['p0']['y'],_0x55458f['p1']['y'],_0x55458f['p2']['y'],_0x55458f['p3']['y']);}catch(_0x5b98ab){console[_0x426382(0x95)](_0x426382(0x115)+_0x585de9['id']+':',_0x5b98ab),_0x449b32=_0x585de9['x'],_0x437762=_0x585de9['y'],_0x585de9[_0x426382(0x106)]=_0x426382(0x14e);try{const {x:_0x301b2c,y:_0x2c31de}=getCurrentGridSlotPosition(_0x585de9['gridRow'],_0x585de9['gridCol'],_0x255d5a);_0x585de9[_0x426382(0xbe)]=_0x301b2c,_0x585de9[_0x426382(0x191)]=_0x2c31de;}catch(_0x4c2308){console[_0x426382(0x95)](_0x426382(0x1ad)+_0x585de9['id']+':',_0x4c2308),_0x585de9[_0x426382(0xbe)]=gameCanvas[_0x426382(0x1c4)]/0x2,_0x585de9[_0x426382(0x191)]=ENEMY_TOP_MARGIN;}break;}if(_0x585de9&&_0x585de9[_0x426382(0x106)]==='attacking'){const _0x28bb97=_0x585de9[_0x426382(0xda)]||0x0,_0xc049bb=_0x449b32+_0x28bb97,_0x592fc2=_0x437762;_0x585de9[_0x426382(0x12e)]=_0xc049bb-_0x3d393d,_0x585de9[_0x426382(0x174)]=_0x592fc2-_0x47dc27,_0x585de9['x']=_0xc049bb,_0x585de9['y']=_0x592fc2;if(_0x585de9['y']>gameCanvas[_0x426382(0x120)]+_0x127035*1.5){_0x585de9['state']=_0x426382(0x14e),_0x585de9[_0x426382(0x119)]=0x0,_0x585de9['attackPathT']=0x0,_0x585de9[_0x426382(0xa8)]=0x0,_0x585de9[_0x426382(0xda)]=0x0,_0x585de9['attackGroupId']=null,_0x585de9['y']=-_0x127035*(1.1+Math[_0x426382(0xcb)]()*0.4),_0x585de9['x']=Math['random']()*(gameCanvas[_0x426382(0x1c4)]-_0x255d5a),_0x585de9['velocityX']=0x0,_0x585de9[_0x426382(0x174)]=0x0;try{const {x:_0x528efe,y:_0x59b0a8}=getCurrentGridSlotPosition(_0x585de9[_0x426382(0x1c9)],_0x585de9['gridCol'],_0x255d5a);_0x585de9[_0x426382(0xbe)]=_0x528efe,_0x585de9[_0x426382(0x191)]=_0x59b0a8;}catch(_0x44647b){console[_0x426382(0x95)](_0x426382(0xb5)+_0x2a8d85+_0x426382(0x17e),_0x44647b),_0x585de9[_0x426382(0xbe)]=gameCanvas['width']/0x2,_0x585de9[_0x426382(0x191)]=ENEMY_TOP_MARGIN;}}}break;}case'returning':{if(isEntrancePhaseActive)break;if(_0x585de9[_0x426382(0xbe)]==null||_0x585de9[_0x426382(0x191)]==null){console['warn']('Enemy\x20'+_0x2a8d85+'\x20returning\x20without\x20target\x20coords.\x20Recalculating.');try{const {x:_0x21a279,y:_0x6d92a6}=getCurrentGridSlotPosition(_0x585de9[_0x426382(0x1c9)],_0x585de9[_0x426382(0x1bf)],_0x255d5a);_0x585de9['targetGridX']=_0x21a279,_0x585de9[_0x426382(0x191)]=_0x6d92a6;}catch(_0x43983a){console[_0x426382(0x95)]('Error\x20getting\x20grid\x20pos\x20for\x20'+_0x2a8d85+_0x426382(0xac),_0x43983a),_0x585de9['state']='in_grid',_0x585de9['x']=gameCanvas[_0x426382(0x1c4)]/0x2,_0x585de9['y']=ENEMY_TOP_MARGIN;break;}}const _0x5e0677=_0x585de9['targetGridX'],_0x8218e2=_0x585de9['targetGridY'],_0x1f5932=_0x5e0677-_0x585de9['x'],_0x49445e=_0x8218e2-_0x585de9['y'],_0x15a5d0=Math[_0x426382(0x1b2)](_0x1f5932*_0x1f5932+_0x49445e*_0x49445e),_0x3d9bd8=scaleValue(level,BASE_RETURN_SPEED_FACTOR,MAX_RETURN_SPEED_FACTOR),_0x5ad7fa=BASE_RETURN_SPEED*_0x3d9bd8,_0x4b67d4=_0x5ad7fa*0.5;_0x15a5d0>_0x4b67d4?(_0x585de9[_0x426382(0x12e)]=_0x1f5932/_0x15a5d0*_0x5ad7fa,_0x585de9[_0x426382(0x174)]=_0x49445e/_0x15a5d0*_0x5ad7fa,_0x585de9['x']+=_0x585de9[_0x426382(0x12e)],_0x585de9['y']+=_0x585de9[_0x426382(0x174)]):(_0x585de9['x']=_0x5e0677,_0x585de9['y']=_0x8218e2,_0x585de9['velocityX']=0x0,_0x585de9[_0x426382(0x174)]=0x0,_0x585de9[_0x426382(0x106)]=_0x426382(0x9d),_0x585de9[_0x426382(0xf8)]=!![],_0x585de9[_0x426382(0xda)]=0x0,_0x585de9['attackGroupId']=null,_0x585de9[_0x426382(0xe3)](_0x426382(0x148))&&delete _0x585de9['returnLogDone'],!isGridSoundPlaying&&!isChallengingStage&&(isGridSoundPlaying=!![],playSound(_0x426382(0x11c),!![],0.1)));break;}}if(_0x585de9&&!isShowingPlayerGameOverMessage&&!(isTwoPlayerMode&&selectedGameMode==='coop'&&(isPlayer1ShowingGameOverMessage||isPlayer2ShowingGameOverMessage))&&gameOverSequenceStartTime===0x0){const _0x502591=[_0x426382(0xeb),'following_entrance_path',_0x426382(0x18f),_0x426382(0xd5)];if(_0x502591['includes'](_0x585de9[_0x426382(0x106)])){let _0x536cef=[];if(isTwoPlayerMode&&selectedGameMode===_0x426382(0x99)){if(ship1&&player1Lives>0x0&&!isPlayer1ShipCaptured&&!isPlayer1Invincible&&!isPlayer1ShowingGameOverMessage&&!player1NeedsRespawnAfterCapture)_0x536cef[_0x426382(0xd2)]({'shipObj':ship1,'playerNum':0x1,'dual':player1IsDualShipActive});if(ship2&&player2Lives>0x0&&!isPlayer2ShipCaptured&&!isPlayer2Invincible&&!isPlayer2ShowingGameOverMessage&&!player2NeedsRespawnAfterCapture)_0x536cef['push']({'shipObj':ship2,'playerNum':0x2,'dual':player2IsDualShipActive});}else ship&&playerLives>0x0&&!isShipCaptured&&!isShowingPlayerGameOverMessage&&!isInvincible&&_0x536cef['push']({'shipObj':ship,'playerNum':currentPlayer,'dual':isDualShipActive});for(const _0x5ab244 of _0x536cef){const _0x1ac290=_0x5ab244[_0x426382(0x1bb)],_0x68a15a={'x':_0x585de9['x'],'y':_0x585de9['y'],'width':_0x255d5a,'height':_0x127035},_0x2de1a1={'x':_0x1ac290['x'],'y':_0x1ac290['y'],'width':_0x1ac290[_0x426382(0x1c4)],'height':_0x1ac290['height']},_0x2ccfb5=_0x5ab244['dual']?{'x':_0x1ac290['x']+DUAL_SHIP_OFFSET_X,'y':_0x1ac290['y'],'width':_0x1ac290[_0x426382(0x1c4)],'height':_0x1ac290['height']}:null;let _0x4d9f92=![],_0x505ccd=![];if(checkCollision(_0x68a15a,_0x2de1a1))_0x4d9f92=!![];else _0x5ab244[_0x426382(0xad)]&&_0x2ccfb5&&checkCollision(_0x68a15a,_0x2ccfb5)&&(_0x4d9f92=!![],_0x505ccd=!![]);if(_0x4d9f92){createExplosion(_0x585de9['x']+_0x255d5a/0x2,_0x585de9['y']+_0x127035/0x2),playSound('lostLifeSound',![],0.6),enemies[_0x426382(0x1b0)](_0x436f09,0x1),_0x585de9=null,handlePlayerShipCollision(_0x5ab244[_0x426382(0xee)],_0x505ccd,_0x2a69df,![]);if(_0x585de9===null)break;}}}}if(!_0x585de9)continue;}if(!isShowingPlayerGameOverMessage&&!(isTwoPlayerMode&&selectedGameMode===_0x426382(0x99)&&(isPlayer1ShowingGameOverMessage||isPlayer2ShowingGameOverMessage))&&gameOverSequenceStartTime===0x0){let _0x1a7420=[];if(isTwoPlayerMode&&selectedGameMode===_0x426382(0x99)){if(ship1&&player1Lives>0x0&&!isPlayer1ShipCaptured&&!isPlayer1Invincible&&!isPlayer1ShowingGameOverMessage&&!player1NeedsRespawnAfterCapture)_0x1a7420[_0x426382(0xd2)]({'shipObj':ship1,'playerNum':0x1,'dual':player1IsDualShipActive});if(ship2&&player2Lives>0x0&&!isPlayer2ShipCaptured&&!isPlayer2Invincible&&!isPlayer2ShowingGameOverMessage&&!player2NeedsRespawnAfterCapture)_0x1a7420[_0x426382(0xd2)]({'shipObj':ship2,'playerNum':0x2,'dual':player2IsDualShipActive});}else ship&&playerLives>0x0&&!isShipCaptured&&!isShowingPlayerGameOverMessage&&!isInvincible&&_0x1a7420[_0x426382(0xd2)]({'shipObj':ship,'playerNum':currentPlayer,'dual':isDualShipActive});for(let _0x662001=enemyBullets[_0x426382(0x100)]-0x1;_0x662001>=0x0;_0x662001--){const _0x30d7fd=enemyBullets[_0x662001];if(!_0x30d7fd){enemyBullets[_0x426382(0x1b0)](_0x662001,0x1);continue;}const _0x49d392={'x':_0x30d7fd['x'],'y':_0x30d7fd['y'],'width':_0x30d7fd[_0x426382(0x1c4)],'height':_0x30d7fd[_0x426382(0x120)]};let _0x179a84=![];for(const _0x4d6e32 of _0x1a7420){const _0x3dab0d=_0x4d6e32[_0x426382(0x1bb)],_0x5c05fc={'x':_0x3dab0d['x'],'y':_0x3dab0d['y'],'width':_0x3dab0d['width'],'height':_0x3dab0d['height']},_0x396c67=_0x4d6e32[_0x426382(0xad)]?{'x':_0x3dab0d['x']+DUAL_SHIP_OFFSET_X,'y':_0x3dab0d['y'],'width':_0x3dab0d[_0x426382(0x1c4)],'height':_0x3dab0d['height']}:null;let _0x3743a9=![],_0x395c77=![];if(checkCollision(_0x49d392,_0x5c05fc))_0x3743a9=!![];else _0x4d6e32['dual']&&_0x396c67&&checkCollision(_0x49d392,_0x396c67)&&(_0x3743a9=!![],_0x395c77=!![]);if(_0x3743a9){playSound(_0x426382(0xef),![],0.6),handlePlayerShipCollision(_0x4d6e32['playerNum'],_0x395c77,_0x2a69df,![]),enemyBullets['splice'](_0x662001,0x1),_0x179a84=!![];break;}}if(_0x179a84)continue;}}updateHitSparks();}catch(_0x1e0ff0){console[_0x426382(0x95)](_0x426382(0x190),_0x1e0ff0,_0x1e0ff0['stack']),isGridSoundPlaying=![],stopSound(_0x426382(0x11c)),isEntrancePhaseActive=![],stopSound(_0x426382(0x173)),isShowingPlayerGameOverMessage=![],playerGameOverMessageStartTime=0x0,playerWhoIsGameOver=0x0,nextActionAfterPlayerGameOver='',isPlayer1ShowingGameOverMessage=![],player1GameOverMessageStartTime=0x0,isPlayer2ShowingGameOverMessage=![],player2GameOverMessageStartTime=0x0,isShipCaptured=![],captureBeamActive=![],capturingBossId=null,stopSound('captureSound'),stopSound(_0x426382(0x17b)),isWaitingForRespawn=![],fallingShips=[],isDualShipActive=![],player1IsDualShipActive=![],player2IsDualShipActive=![],isInvincible=![],invincibilityEndTime=0x0,hitSparks=[];if(typeof showMenuState===_0x426382(0x11f))showMenuState();if(mainLoopId)cancelAnimationFrame(mainLoopId);mainLoopId=null,alert('Critical\x20error\x20during\x20entity\x20movement/collision.\x20Returning\x20to\x20menu.');}}function handlePlayerShipCollision(_0x51e9d0,_0xf8a576,_0x10f593,_0x2dfab7=![]){const _0x1aa5f4=_0x571912,_0xd6f451=_0x10f593,_0x398389=gameCanvas?gameCanvas['height']-SHIP_HEIGHT-SHIP_BOTTOM_MARGIN:0x1f4;let _0x8f75e0=0x0,_0x2c7ace=null;if(isTwoPlayerMode&&selectedGameMode===_0x1aa5f4(0x99)){_0x2c7ace=_0x51e9d0===0x1?ship1:ship2;if(_0x2c7ace){_0x8f75e0=_0x2c7ace['x'];if(_0x2dfab7){if(_0x51e9d0===0x1)player1CaptureRespawnX=_0x2c7ace['x'];else{if(_0x51e9d0===0x2)player2CaptureRespawnX=_0x2c7ace['x'];}}}else{if(_0x51e9d0===0x1&&typeof player1CaptureRespawnX===_0x1aa5f4(0x112)&&player1CaptureRespawnX!==0x0)_0x8f75e0=player1CaptureRespawnX;else{if(_0x51e9d0===0x2&&typeof player2CaptureRespawnX===_0x1aa5f4(0x112)&&player2CaptureRespawnX!==0x0)_0x8f75e0=player2CaptureRespawnX;else{if((isCoopAIDemoActive||isPlayerTwoAI&&selectedOnePlayerGameVariant==='1P_VS_AI_COOP')&&gameCanvas)_0x8f75e0=_0x51e9d0===0x1?gameCanvas[_0x1aa5f4(0x1c4)]/0x2-gameCanvas[_0x1aa5f4(0x1c4)]*COOP_SHIP_HORIZONTAL_OFFSET_FACTOR-SHIP_WIDTH/0x2:gameCanvas[_0x1aa5f4(0x1c4)]/0x2+gameCanvas[_0x1aa5f4(0x1c4)]*COOP_SHIP_HORIZONTAL_OFFSET_FACTOR-SHIP_WIDTH/0x2;else gameCanvas?_0x8f75e0=gameCanvas['width']/0x2-SHIP_WIDTH/0x2:_0x8f75e0=0xc8;}}}}else{_0x2c7ace=ship;if(_0x2c7ace)_0x8f75e0=_0x2c7ace['x'],_0x2dfab7&&(capturedShipRespawnX_NormalMode=ship['x']);else _0x2dfab7&&capturedShipRespawnX_NormalMode!==0x0?_0x8f75e0=capturedShipRespawnX_NormalMode:_0x8f75e0=gameCanvas?gameCanvas[_0x1aa5f4(0x1c4)]/0x2-SHIP_WIDTH/0x2:0xc8;}if(isTwoPlayerMode&&selectedGameMode===_0x1aa5f4(0x99)){if(_0x51e9d0===0x1){if(_0x2dfab7){isPlayer1ShipCaptured=!![],player1IsDualShipActive=![],player1Lives--;if(isCoopAIDemoActive||isPlayerTwoAI&&selectedOnePlayerGameVariant===_0x1aa5f4(0x165))coopPartner1CapturedTime=_0xd6f451;if(player1Lives<=0x0){player1Lives=0x0,isPlayer1ShowingGameOverMessage=!![],player1GameOverMessageStartTime=_0xd6f451,playSound('gameOverSound',![],0.4),ship1=null,player1NeedsRespawnAfterCapture=![];if(aiPlayerActivelySeekingCaptureById==='p1')aiPlayerActivelySeekingCaptureById=null;if(capturedBossIdWithMessage&&enemies[_0x1aa5f4(0x19b)](_0x550f37=>_0x550f37['id']===capturedBossIdWithMessage)){const _0x18e3eb=enemies[_0x1aa5f4(0x19b)](_0x4c8c91=>_0x4c8c91['id']===capturedBossIdWithMessage);_0x18e3eb&&(_0x18e3eb[_0x1aa5f4(0x1b9)]=![],_0x18e3eb[_0x1aa5f4(0x1bd)]=null);}}else player1NeedsRespawnAfterCapture=!![],ship1=null;}else{if(player1IsDualShipActive&&ship1){player1IsDualShipActive=![];const _0x1df9d3=_0xf8a576?ship1['x']+DUAL_SHIP_OFFSET_X+ship1['width']/0x2:ship1['x']+ship1[_0x1aa5f4(0x1c4)]/0x2;createExplosion(_0x1df9d3,ship1['y']+ship1[_0x1aa5f4(0x120)]/0x2),ship1['x']=_0x8f75e0,ship1['y']=_0x398389,ship1[_0x1aa5f4(0x107)]=ship1['x'],isPlayer1Invincible=!![],player1InvincibilityEndTime=_0xd6f451+INVINCIBILITY_DURATION_MS,isPlayer1WaitingForRespawn=!![],player1RespawnTime=_0xd6f451+RESPAWN_DELAY_MS;}else{if(ship1)createExplosion(ship1['x']+ship1[_0x1aa5f4(0x1c4)]/0x2,ship1['y']+ship1[_0x1aa5f4(0x120)]/0x2);player1Lives--;if(player1Lives<=0x0){player1Lives=0x0,isPlayer1ShowingGameOverMessage=!![],player1GameOverMessageStartTime=_0xd6f451,playSound(_0x1aa5f4(0xd0),![],0.4),ship1=null;if(aiPlayerActivelySeekingCaptureById==='p1')aiPlayerActivelySeekingCaptureById=null;}else isPlayer1Invincible=!![],player1InvincibilityEndTime=_0xd6f451+INVINCIBILITY_DURATION_MS,isPlayer1WaitingForRespawn=!![],player1RespawnTime=_0xd6f451+RESPAWN_DELAY_MS,ship1?(ship1['x']=_0x8f75e0,ship1['y']=_0x398389,ship1[_0x1aa5f4(0x107)]=ship1['x']):ship1={'x':_0x8f75e0,'y':_0x398389,'width':SHIP_WIDTH,'height':SHIP_HEIGHT,'speed':SHIP_MOVE_SPEED,'targetX':_0x8f75e0,'id':'p1'};}}}else{if(_0x51e9d0===0x2){if(_0x2dfab7){isPlayer2ShipCaptured=!![],player2IsDualShipActive=![],player2Lives--;if(isCoopAIDemoActive||isPlayerTwoAI&&selectedOnePlayerGameVariant==='1P_VS_AI_COOP')coopPartner2CapturedTime=_0xd6f451;if(player2Lives<=0x0){player2Lives=0x0,isPlayer2ShowingGameOverMessage=!![],player2GameOverMessageStartTime=_0xd6f451,playSound('gameOverSound',![],0.4),ship2=null,player2NeedsRespawnAfterCapture=![];if(aiPlayerActivelySeekingCaptureById==='p2'||aiPlayerActivelySeekingCaptureById==='ai_p2')aiPlayerActivelySeekingCaptureById=null;if(capturedBossIdWithMessage&&enemies[_0x1aa5f4(0x19b)](_0xe4ab52=>_0xe4ab52['id']===capturedBossIdWithMessage)){const _0x5ab32b=enemies[_0x1aa5f4(0x19b)](_0x356f1=>_0x356f1['id']===capturedBossIdWithMessage);_0x5ab32b&&(_0x5ab32b[_0x1aa5f4(0x1b9)]=![],_0x5ab32b[_0x1aa5f4(0x1bd)]=null);}}else player2NeedsRespawnAfterCapture=!![],ship2=null;}else{if(player2IsDualShipActive&&ship2){player2IsDualShipActive=![];const _0x403f8b=_0xf8a576?ship2['x']+DUAL_SHIP_OFFSET_X+ship2[_0x1aa5f4(0x1c4)]/0x2:ship2['x']+ship2[_0x1aa5f4(0x1c4)]/0x2;createExplosion(_0x403f8b,ship2['y']+ship2[_0x1aa5f4(0x120)]/0x2),ship2['x']=_0x8f75e0,ship2['y']=_0x398389,ship2[_0x1aa5f4(0x107)]=ship2['x'],isPlayer2Invincible=!![],player2InvincibilityEndTime=_0xd6f451+INVINCIBILITY_DURATION_MS,isPlayer2WaitingForRespawn=!![],player2RespawnTime=_0xd6f451+RESPAWN_DELAY_MS;}else{if(ship2)createExplosion(ship2['x']+ship2[_0x1aa5f4(0x1c4)]/0x2,ship2['y']+ship2[_0x1aa5f4(0x120)]/0x2);player2Lives--;if(player2Lives<=0x0){player2Lives=0x0,isPlayer2ShowingGameOverMessage=!![],player2GameOverMessageStartTime=_0xd6f451,playSound(_0x1aa5f4(0xd0),![],0.4),ship2=null;if(aiPlayerActivelySeekingCaptureById==='p2'||aiPlayerActivelySeekingCaptureById===_0x1aa5f4(0xed))aiPlayerActivelySeekingCaptureById=null;}else isPlayer2Invincible=!![],player2InvincibilityEndTime=_0xd6f451+INVINCIBILITY_DURATION_MS,isPlayer2WaitingForRespawn=!![],player2RespawnTime=_0xd6f451+RESPAWN_DELAY_MS,ship2?(ship2['x']=_0x8f75e0,ship2['y']=_0x398389,ship2[_0x1aa5f4(0x107)]=_0x8f75e0):ship2={'x':_0x8f75e0,'y':_0x398389,'width':SHIP_WIDTH,'height':SHIP_HEIGHT,'speed':SHIP_MOVE_SPEED,'targetX':_0x8f75e0,'id':'p2'};}}}}player1Lives<=0x0&&player2Lives<=0x0&&gameOverSequenceStartTime===0x0&&triggerFinalGameOverSequence();}else{if(isDualShipActive&&!_0x2dfab7&&_0x2c7ace){isDualShipActive=![];if(isTwoPlayerMode&&selectedGameMode===_0x1aa5f4(0x156)){if(_0x51e9d0===0x1)player1IsDualShipActive=![];else{if(_0x51e9d0===0x2)player2IsDualShipActive=![];}}else{if(!isTwoPlayerMode)player1IsDualShipActive=![];}const _0x57751c=_0xf8a576?_0x8f75e0+DUAL_SHIP_OFFSET_X+SHIP_WIDTH/0x2:_0x8f75e0+SHIP_WIDTH/0x2;createExplosion(_0x57751c,_0x398389+SHIP_HEIGHT/0x2);ship&&(ship['x']=_0x8f75e0,ship['y']=_0x398389,ship[_0x1aa5f4(0x107)]=ship['x']);isInvincible=!![],invincibilityEndTime=_0xd6f451+INVINCIBILITY_DURATION_MS,isWaitingForRespawn=!![],respawnTime=_0xd6f451+RESPAWN_DELAY_MS;if(!isManualControl&&!isPlayerTwoAI)aiNeedsStabilization=!![];else{if(isPlayerTwoAI&&selectedGameMode===_0x1aa5f4(0x156)&&currentPlayer===0x2)aiNeedsStabilization=!![];}}else{if(!_0x2dfab7&&_0x2c7ace)createExplosion(_0x8f75e0+SHIP_WIDTH/0x2,_0x398389+SHIP_HEIGHT/0x2);if(_0x2dfab7){isShipCaptured=!![];if(ship)ship=null;}playerLives--;if(playerLives<=0x0){playerLives=0x0;if(isTwoPlayerMode&&selectedGameMode===_0x1aa5f4(0x156)){if(_0x51e9d0===0x1)player1Lives=0x0;else{if(_0x51e9d0===0x2)player2Lives=0x0;}isShowingPlayerGameOverMessage=!![],playerGameOverMessageStartTime=_0xd6f451,playerWhoIsGameOver=_0x51e9d0,playSound(_0x1aa5f4(0xd0),![],0.4);const _0x461e24=_0x51e9d0===0x1?0x2:0x1,_0x4d3d88=_0x461e24===0x1?player1Lives:player2Lives;_0x4d3d88>0x0?nextActionAfterPlayerGameOver='switch_player':nextActionAfterPlayerGameOver=_0x1aa5f4(0x192);bullets=[],enemyBullets=[],explosions=[];if(!(_0x4d3d88>0x0))ship=null;}else player1Lives=0x0,ship=null,playSound(_0x1aa5f4(0xd0),![],0.4),triggerFinalGameOverSequence();}else{if(isTwoPlayerMode&&selectedGameMode===_0x1aa5f4(0x156)){if(_0x51e9d0===0x1)player1Lives=playerLives;else player2Lives=playerLives;}if(!_0x2dfab7){isInvincible=!![],invincibilityEndTime=_0xd6f451+INVINCIBILITY_DURATION_MS,isWaitingForRespawn=!![],respawnTime=_0xd6f451+RESPAWN_DELAY_MS;if(ship&&gameCanvas){ship['x']=_0x8f75e0,ship['y']=_0x398389,ship[_0x1aa5f4(0x107)]=ship['x'];if(!isManualControl&&!isPlayerTwoAI)aiNeedsStabilization=!![];else{if(isPlayerTwoAI&&selectedGameMode==='normal'&&currentPlayer===0x2)aiNeedsStabilization=!![];}}}if(_0x2dfab7)isDualShipActive=![];}}}if(!_0x2dfab7)fallingShips=[];}function switchPlayerTurn(){const _0x1d5f54=_0x571912;if(!isTwoPlayerMode||selectedGameMode==='coop')return![];stopSound(_0x1d5f54(0x199));if(currentPlayer===0x1){player1Score=score,player1IsDualShipActive=isDualShipActive;if(player1Score>highScore)highScore=player1Score;}else{player2Score=score,player2IsDualShipActive=isDualShipActive;if(player2Score>highScore)highScore=player2Score;}const _0x1ef855=currentPlayer===0x1?0x2:0x1,_0x5a5d05=_0x1ef855===0x1?player1Lives:player2Lives;if(_0x5a5d05<=0x0){const _0x83eb68=currentPlayer===0x1?player1Lives:player2Lives;return _0x83eb68<=0x0?(triggerFinalGameOverSequence(),![]):(forceCenterShipNextReset=![],![]);}return currentPlayer=_0x1ef855,score=currentPlayer===0x1?player1Score:player2Score,playerLives=currentPlayer===0x1?player1Lives:player2Lives,isDualShipActive=currentPlayer===0x1?player1IsDualShipActive:player2IsDualShipActive,forceCenterShipNextReset=!![],scoreEarnedThisCS=0x0,csCurrentChainHits=0x0,csCurrentChainScore=0x0,csLastHitTime=0x0,csLastChainHitPosition=null,normalWaveCurrentChainHits=0x0,normalWaveCurrentChainScore=0x0,normalWaveLastHitTime=0x0,normalWaveLastHitPosition=null,leftPressed=![],rightPressed=![],shootPressed=![],p2LeftPressed=![],p2RightPressed=![],p2ShootPressed=![],keyboardP1LeftDown=![],keyboardP1RightDown=![],keyboardP1ShootDown=![],keyboardP2LeftDown=![],keyboardP2RightDown=![],keyboardP2ShootDown=![],p1JustFiredSingle=![],p2JustFiredSingle=![],p1FireInputWasDown=![],p2FireInputWasDown=![],isShipCaptured=![],isWaitingForRespawn=![],respawnTime=0x0,isInvincible=![],invincibilityEndTime=0x0,fallingShips=[],hitSparks=[],showExtraLifeMessage=![],extraLifeMessageStartTime=0x0,!![];}function triggerGridFiring(){const _0x216f35=_0x571912;if(isPaused||!isInGameState||isChallengingStage||isWaveTransitioning)return;let _0x581075=![];isTwoPlayerMode&&selectedGameMode===_0x216f35(0x99)?(player1Lives>0x0&&ship1&&!isPlayer1ShipCaptured&&!isPlayer1ShowingGameOverMessage&&!player1NeedsRespawnAfterCapture||player2Lives>0x0&&ship2&&!isPlayer2ShipCaptured&&!isPlayer2ShowingGameOverMessage&&!player2NeedsRespawnAfterCapture)&&(_0x581075=!![]):playerLives>0x0&&ship&&!isShipCaptured&&!isShowingPlayerGameOverMessage&&(_0x581075=!![]);if(!_0x581075)return;const _0x2623a6=enemies[_0x216f35(0x19e)](_0x413221=>_0x413221&&_0x413221[_0x216f35(0x106)]==='in_grid');if(_0x2623a6[_0x216f35(0x100)]===0x0)return;const _0x5d9241=Date[_0x216f35(0x1a6)](),_0x1ffb36=scaleValue(level,BASE_GRID_FIRE_INTERVAL,MIN_GRID_FIRE_INTERVAL);if(_0x5d9241-lastGridFireCheckTime<_0x1ffb36)return;lastGridFireCheckTime=_0x5d9241;const _0x2ec3cb=scaleValue(level,BASE_GRID_FIRE_PROBABILITY,MAX_GRID_FIRE_PROBABILITY),_0x3a5863=Math[_0x216f35(0x196)](scaleValue(level,BASE_GRID_MAX_FIRING_ENEMIES,MAX_GRID_MAX_FIRING_ENEMIES));let _0x35ddfc=0x0;_0x2623a6[_0x216f35(0x1ba)](()=>Math[_0x216f35(0xcb)]()-0.5);for(const _0x2e5ded of _0x2623a6){if(_0x35ddfc>=_0x3a5863)break;if(_0x2e5ded[_0x216f35(0x9f)]===ENEMY2_TYPE||_0x2e5ded[_0x216f35(0x9f)]===ENEMY3_TYPE){if(_0x2e5ded[_0x216f35(0x9f)]===ENEMY3_TYPE&&_0x2e5ded[_0x216f35(0x1b9)])continue;Math[_0x216f35(0xcb)]()<_0x2ec3cb&&(createBulletSimple(_0x2e5ded)&&(playSound(_0x216f35(0xfb),![],0.4),_0x2e5ded['lastFiredTime']=_0x5d9241,_0x35ddfc++));}}}function runSingleGameUpdate(_0x528f9b){const _0x54d5a9=_0x571912;try{const _0x52d25d=Date['now']();let _0x20c3d2=![];isTwoPlayerMode&&selectedGameMode===_0x54d5a9(0x99)?_0x20c3d2=player1Lives>0x0&&!isPlayer1ShipCaptured&&!isPlayer1WaitingForRespawn&&!isPlayer1ShowingGameOverMessage&&!player1NeedsRespawnAfterCapture||player2Lives>0x0&&!isPlayer2ShipCaptured&&!isPlayer2WaitingForRespawn&&!isPlayer2ShowingGameOverMessage&&!player2NeedsRespawnAfterCapture:_0x20c3d2=playerLives>0x0&&!isShipCaptured&&!isShowingPlayerGameOverMessage;let _0x45e552=![];if(isManualControl&&connectedGamepadIndex!==null){if(isTwoPlayerMode&&selectedGameMode===_0x54d5a9(0x99)){if(player1Lives>0x0&&!isPlayer1ShipCaptured&&!isPlayer1WaitingForRespawn&&!isPlayer1ShowingGameOverMessage)_0x45e552=!![];}else{if(playerLives>0x0&&!isShipCaptured&&!isShowingPlayerGameOverMessage&&(!isPlayerTwoAI||isPlayerTwoAI&&currentPlayer===0x1))_0x45e552=!![];}}if(_0x45e552&&gameOverSequenceStartTime===0x0&&!isPaused){const _0x4082ff=navigator[_0x54d5a9(0x92)]();if(_0x4082ff?.[connectedGamepadIndex]){const _0x16a274=_0x4082ff[connectedGamepadIndex],_0x4fa342=processSingleController(_0x16a274,previousGameButtonStates);previousGameButtonStates=_0x4fa342[_0x54d5a9(0xfc)][_0x54d5a9(0xfe)]();if(_0x4fa342['back']){stopGameAndShowMenu();return;}}else{if(previousGameButtonStates[_0x54d5a9(0x100)]>0x0)previousGameButtonStates=[];}}else connectedGamepadIndex===null&&previousGameButtonStates[_0x54d5a9(0x100)]>0x0&&(previousGameButtonStates=[]);let _0x4f90a6=![];if(isManualControl&&isTwoPlayerMode&&selectedGameMode===_0x54d5a9(0x99)&&!isPlayerTwoAI&&connectedGamepadIndexP2!==null){if(player2Lives>0x0&&!isPlayer2ShipCaptured&&!isPlayer2WaitingForRespawn&&!isPlayer2ShowingGameOverMessage)_0x4f90a6=!![];}else{if(isManualControl&&isTwoPlayerMode&&selectedGameMode==='normal'&&!isPlayerTwoAI&&connectedGamepadIndexP2!==null){if(playerLives>0x0&&!isShipCaptured&&!isShowingPlayerGameOverMessage&&currentPlayer===0x2)_0x4f90a6=!![];}}if(_0x4f90a6&&gameOverSequenceStartTime===0x0&&!isPaused){const _0x456536=navigator[_0x54d5a9(0x92)]();if(_0x456536?.[connectedGamepadIndexP2]){const _0x56cd41=_0x456536[connectedGamepadIndexP2],_0x1f5464=processSingleController(_0x56cd41,previousGameButtonStatesP2);previousGameButtonStatesP2=_0x1f5464[_0x54d5a9(0xfc)][_0x54d5a9(0xfe)]();if(_0x1f5464['back']){stopGameAndShowMenu();return;}}else{if(previousGameButtonStatesP2[_0x54d5a9(0x100)]>0x0)previousGameButtonStatesP2=[];}}else connectedGamepadIndexP2===null&&previousGameButtonStatesP2[_0x54d5a9(0x100)]>0x0&&(previousGameButtonStatesP2=[]);if(isPaused){renderGame();return;}const _0x1efebf=showCsBonusScoreMessage||showPerfectMessage;if(isCoopAIDemoActive&&_0x1efebf&&gameCanvas?.[_0x54d5a9(0x1c4)]>0x0){const _0x19856f=ship1&&player1Lives>0x0&&player2Lives<=0x0,_0x481998=ship2&&player2Lives>0x0&&player1Lives<=0x0;if(_0x19856f){const _0x13a0da=player1IsDualShipActive?SHIP_WIDTH+DUAL_SHIP_OFFSET_X:SHIP_WIDTH,_0x165ef2=Math['round'](gameCanvas[_0x54d5a9(0x1c4)]/0x2-_0x13a0da/0x2);ship1['x']=_0x165ef2,ship1[_0x54d5a9(0x107)]=_0x165ef2,smoothedShip1X=_0x165ef2,ship2&&(ship2[_0x54d5a9(0x107)]=ship2['x'],smoothedShip2X=ship2['x']);}else{if(_0x481998){const _0x484073=player2IsDualShipActive?SHIP_WIDTH+DUAL_SHIP_OFFSET_X:SHIP_WIDTH,_0x46baf2=Math[_0x54d5a9(0x196)](gameCanvas[_0x54d5a9(0x1c4)]/0x2-_0x484073/0x2);ship2['x']=_0x46baf2,ship2[_0x54d5a9(0x107)]=_0x46baf2,smoothedShip2X=_0x46baf2,ship1&&(ship1[_0x54d5a9(0x107)]=ship1['x'],smoothedShip1X=ship1['x']);}else{if(ship1&&player1Lives>0x0&&ship2&&player2Lives>0x0){const _0x52b878=gameCanvas['width']/0x2-gameCanvas['width']*COOP_SHIP_HORIZONTAL_OFFSET_FACTOR-SHIP_WIDTH/0x2;ship1['x']=_0x52b878,ship1[_0x54d5a9(0x107)]=_0x52b878,smoothedShip1X=_0x52b878;const _0x87b6f1=gameCanvas[_0x54d5a9(0x1c4)]/0x2+gameCanvas['width']*COOP_SHIP_HORIZONTAL_OFFSET_FACTOR-SHIP_WIDTH/0x2;ship2['x']=_0x87b6f1,ship2[_0x54d5a9(0x107)]=_0x87b6f1,smoothedShip2X=_0x87b6f1;}}}}else{if(_0x1efebf&&gameCanvas?.['width']>0x0){if(isTwoPlayerMode&&selectedGameMode===_0x54d5a9(0x99)){const _0x18b029=ship1&&player1Lives>0x0,_0x17ac4e=ship2&&player2Lives>0x0;if(_0x18b029&&_0x17ac4e){if(isPlayerTwoAI&&selectedOnePlayerGameVariant==='1P_VS_AI_COOP'){const _0x4cf836=gameCanvas[_0x54d5a9(0x1c4)]/0x2-gameCanvas[_0x54d5a9(0x1c4)]*COOP_SHIP_HORIZONTAL_OFFSET_FACTOR-SHIP_WIDTH/0x2,_0x1dcc95=gameCanvas['width']/0x2+gameCanvas['width']*COOP_SHIP_HORIZONTAL_OFFSET_FACTOR-SHIP_WIDTH/0x2;ship2&&(ship2['x']=_0x1dcc95,ship2[_0x54d5a9(0x107)]=_0x1dcc95,smoothedShip2X=_0x1dcc95);}}else{if(_0x18b029&&ship1){const _0x3db522=player1IsDualShipActive?SHIP_WIDTH+DUAL_SHIP_OFFSET_X:SHIP_WIDTH,_0x4d0dd6=Math[_0x54d5a9(0x196)](gameCanvas['width']/0x2-_0x3db522/0x2);ship1['x']=_0x4d0dd6,ship1['targetX']=_0x4d0dd6,ship2&&isPlayerTwoAI&&selectedOnePlayerGameVariant==='1P_VS_AI_COOP'&&(ship2[_0x54d5a9(0x107)]=ship2['x'],smoothedShip2X=ship2['x']);}else{if(_0x17ac4e&&ship2){const _0x58b35b=player2IsDualShipActive?SHIP_WIDTH+DUAL_SHIP_OFFSET_X:SHIP_WIDTH,_0x134f0a=Math[_0x54d5a9(0x196)](gameCanvas[_0x54d5a9(0x1c4)]/0x2-_0x58b35b/0x2);ship2['x']=_0x134f0a,ship2[_0x54d5a9(0x107)]=_0x134f0a;if(isPlayerTwoAI&&selectedOnePlayerGameVariant===_0x54d5a9(0x165))smoothedShip2X=_0x134f0a;ship1&&isPlayerTwoAI&&selectedOnePlayerGameVariant===_0x54d5a9(0x165)&&(ship1[_0x54d5a9(0x107)]=ship1['x']);}}}}else{if((!isManualControl||isPlayerTwoAI&&selectedGameMode===_0x54d5a9(0x156)&&currentPlayer===0x2)&&ship){const _0x4a5062=isDualShipActive?SHIP_WIDTH+DUAL_SHIP_OFFSET_X:SHIP_WIDTH;ship['x']=Math[_0x54d5a9(0x196)](gameCanvas['width']/0x2-_0x4a5062/0x2),ship['targetX']=ship['x'];if(isPlayerTwoAI&&selectedGameMode===_0x54d5a9(0x156)&&currentPlayer===0x2)smoothedShipX=ship['x'];else{if(!isManualControl)smoothedShipX=ship['x'];}}}}}let _0xf466f=![];if(selectedGameMode==='coop'&&level===0x1&&coopPlayersReadyStartTime>0x0){_0xf466f=!![];if(isShowingCoopPlayersReady){if(_0x52d25d-coopPlayersReadyStartTime<0x64){explosions=[];if(typeof updateExplosions===_0x54d5a9(0x11f))updateExplosions();}if(_0x52d25d>=coopPlayersReadyStartTime+0xbb8){isShowingCoopPlayersReady=![],explosions=[];if(typeof updateExplosions===_0x54d5a9(0x11f))updateExplosions();isCoopAIDemoActive||isPlayerTwoAI&&selectedOnePlayerGameVariant===_0x54d5a9(0x165)?(isShowingIntro=!![],introStep=0x2,introDisplayStartTime=_0x52d25d):(isShowingIntro=!![],introStep=0x1,introDisplayStartTime=_0x52d25d);}}else{if(isShowingIntro){if(_0x52d25d-introDisplayStartTime<0x64){explosions=[];if(typeof updateExplosions===_0x54d5a9(0x11f))updateExplosions();}let _0x1fb513=INTRO_DURATION_PER_STEP;introStep===0x1&&!isCoopAIDemoActive&&!(isPlayerTwoAI&&selectedOnePlayerGameVariant===_0x54d5a9(0x165))&&(_0x1fb513=TWO_PLAYER_STAGE_INTRO_DURATION);if(_0x52d25d>=introDisplayStartTime+_0x1fb513){if(introStep===0x1&&!isCoopAIDemoActive&&!(isPlayerTwoAI&&selectedOnePlayerGameVariant==='1P_VS_AI_COOP')){introStep=0x2,introDisplayStartTime=_0x52d25d,explosions=[];if(typeof updateExplosions===_0x54d5a9(0x11f))updateExplosions();}else{isShowingIntro=![],introStep=0x0,playerIntroSoundPlayed=![],stageIntroSoundPlayed=![],csIntroSoundPlayed=![],explosions=[];if(typeof updateExplosions===_0x54d5a9(0x11f))updateExplosions();_0xf466f=![],coopPlayersReadyStartTime=0x0;}}}else _0xf466f=![],coopPlayersReadyStartTime=0x0;}if(isManualControl||isCoopAIDemoActive||isPlayerTwoAI&&selectedOnePlayerGameVariant===_0x54d5a9(0x165))handlePlayerInput();if(typeof moveEntities===_0x54d5a9(0x11f))moveEntities();renderGame();if(_0xf466f)return;}if(selectedGameMode===_0x54d5a9(0x99)&&level===0x1&&!gameJustStartedAndWaveLaunched&&coopPlayersReadyStartTime===0x0&&gameJustStarted){if(isFullGridWave)startFullGridWave();else{if(isChallengingStage)startChallengingStageSequence();else{if(currentWaveDefinition&&currentWaveDefinition[_0x54d5a9(0x100)]>0x0)scheduleEntranceFlightWave();else isWaveTransitioning=!![],readyForNextWaveReset=!![];}}gameJustStartedAndWaveLaunched=!![],gameJustStarted=![];}if(isShowingPlayerGameOverMessage&&isTwoPlayerMode&&selectedGameMode===_0x54d5a9(0x156)){if(_0x52d25d-playerGameOverMessageStartTime<0x64){explosions=[];if(typeof updateExplosions===_0x54d5a9(0x11f))updateExplosions();}if(_0x52d25d-playerGameOverMessageStartTime>=PLAYER_GAME_OVER_MESSAGE_DURATION){isShowingPlayerGameOverMessage=![],explosions=[];if(typeof updateExplosions===_0x54d5a9(0x11f))updateExplosions();const _0x4b960e=playerWhoIsGameOver;playerWhoIsGameOver=0x0;if(nextActionAfterPlayerGameOver===_0x54d5a9(0x97))switchPlayerTurn()?(_0x4b960e===0x2&&currentPlayer===0x1&&player1CompletedLevel===level&&(level++,player1CompletedLevel=-0x1,player1MaxLevelReached=Math['max'](player1MaxLevelReached,level)),resetWaveInternal(),gameJustStartedAndWaveLaunched=![],gameJustStarted=!![]):triggerFinalGameOverSequence();else nextActionAfterPlayerGameOver===_0x54d5a9(0x192)?triggerFinalGameOverSequence():triggerFinalGameOverSequence();renderGame();return;}else{renderGame();return;}}if(isTwoPlayerMode&&selectedGameMode===_0x54d5a9(0x99)){let _0x328fb9=![],_0x2f71eb=![];if(isPlayer1ShowingGameOverMessage){if(_0x52d25d-player1GameOverMessageStartTime<0x64){explosions=[];if(typeof updateExplosions===_0x54d5a9(0x11f))updateExplosions();}if(_0x52d25d-player1GameOverMessageStartTime>=PLAYER_GAME_OVER_MESSAGE_DURATION_COOP){isPlayer1ShowingGameOverMessage=![],_0x328fb9=!![],explosions=[];if(typeof updateExplosions===_0x54d5a9(0x11f))updateExplosions();}}if(isPlayer2ShowingGameOverMessage){if(_0x52d25d-player2GameOverMessageStartTime<0x64){explosions=[];if(typeof updateExplosions===_0x54d5a9(0x11f))updateExplosions();}if(_0x52d25d-player2GameOverMessageStartTime>=PLAYER_GAME_OVER_MESSAGE_DURATION_COOP){isPlayer2ShowingGameOverMessage=![],_0x2f71eb=!![],explosions=[];if(typeof updateExplosions===_0x54d5a9(0x11f))updateExplosions();}}if(_0x328fb9||_0x2f71eb){player1Lives<=0x0&&player2Lives<=0x0&&gameOverSequenceStartTime===0x0&&triggerFinalGameOverSequence();if(isManualControl||isCoopAIDemoActive||isPlayerTwoAI&&selectedOnePlayerGameVariant===_0x54d5a9(0x165))handlePlayerInput();if(typeof moveEntities===_0x54d5a9(0x11f))moveEntities();renderGame();if(gameOverSequenceStartTime>0x0||player1Lives>0x0||player2Lives>0x0)return;}else{if(isPlayer1ShowingGameOverMessage||isPlayer2ShowingGameOverMessage){if(isManualControl||isCoopAIDemoActive||isPlayerTwoAI&&selectedOnePlayerGameVariant===_0x54d5a9(0x165))handlePlayerInput();if(typeof moveEntities===_0x54d5a9(0x11f))moveEntities();renderGame();return;}}}if(isShowingCaptureMessage){if(_0x52d25d-captureMessageStartTime<0x64){explosions=[];if(typeof updateExplosions==='function')updateExplosions();}const _0x1721c1=enemies[_0x54d5a9(0x19b)](_0x10065b=>_0x10065b['id']===capturedBossIdWithMessage);if(_0x1721c1&&_0x1721c1[_0x54d5a9(0x106)]===_0x54d5a9(0x169)){const _0xd0f0bb=_0x52d25d-captureMessageStartTime,_0x565564=Math['min'](0x1,_0xd0f0bb/CAPTURE_MESSAGE_DURATION);_0x1721c1[_0x54d5a9(0xf2)]=_0x565564*0x2*(0x2*Math['PI']);}else _0x1721c1&&(_0x1721c1[_0x54d5a9(0xf2)]=0x0);if(isInGameState&&!isShowingPlayerGameOverMessage&&!isPlayer1ShowingGameOverMessage&&!isPlayer2ShowingGameOverMessage&&gameOverSequenceStartTime===0x0){if(isManualControl||isCoopAIDemoActive||isPlayerTwoAI&&selectedOnePlayerGameVariant==='1P_VS_AI_COOP')handlePlayerInput();if(isCoopAIDemoActive||isPlayerTwoAI&&selectedOnePlayerGameVariant==='1P_VS_AI_COOP')aiControlCoop();else isPlayerTwoAI&&selectedGameMode===_0x54d5a9(0x156)&&currentPlayer===0x2&&aiControl();if(typeof moveEntities===_0x54d5a9(0x11f))moveEntities();updateExplosions(),updateFloatingScores();}if(_0x52d25d-captureMessageStartTime>=CAPTURE_MESSAGE_DURATION){isShowingCaptureMessage=![],explosions=[];if(typeof updateExplosions===_0x54d5a9(0x11f))updateExplosions();stopSound(_0x54d5a9(0x17b)),captureBeamActive=![];if(_0x1721c1&&_0x1721c1[_0x54d5a9(0x106)]===_0x54d5a9(0x169)){_0x1721c1['state']=_0x54d5a9(0x14e),_0x1721c1['captureAnimationRotation']=0x0;try{const _0x31b865=_0x1721c1[_0x54d5a9(0x9f)]===ENEMY3_TYPE?BOSS_WIDTH:ENEMY_WIDTH,{x:_0x333601,y:_0x3c73ba}=getCurrentGridSlotPosition(_0x1721c1[_0x54d5a9(0x1c9)],_0x1721c1[_0x54d5a9(0x1bf)],_0x31b865);_0x1721c1[_0x54d5a9(0xbe)]=_0x333601,_0x1721c1[_0x54d5a9(0x191)]=_0x3c73ba;}catch(_0x224658){console['error'](_0x54d5a9(0x18c)+_0x1721c1['id']+':',_0x224658),_0x1721c1['targetGridX']=gameCanvas['width']/0x2,_0x1721c1[_0x54d5a9(0x191)]=ENEMY_TOP_MARGIN;}}else _0x1721c1&&(_0x1721c1[_0x54d5a9(0xf2)]=0x0);capturedBossIdWithMessage=null;const _0x1a19d1=gameCanvas?gameCanvas[_0x54d5a9(0x120)]-SHIP_HEIGHT-SHIP_BOTTOM_MARGIN:0x1f4;if(isTwoPlayerMode&&selectedGameMode===_0x54d5a9(0x99)){if(player1NeedsRespawnAfterCapture&&player1Lives>0x0){ship1={'x':player1CaptureRespawnX,'y':_0x1a19d1,'width':SHIP_WIDTH,'height':SHIP_HEIGHT,'speed':SHIP_MOVE_SPEED,'targetX':player1CaptureRespawnX,'id':'p1'},isPlayer1ShipCaptured=![],isPlayer1Invincible=!![],player1InvincibilityEndTime=_0x52d25d+INVINCIBILITY_DURATION_MS,isPlayer1WaitingForRespawn=![],player1NeedsRespawnAfterCapture=![],player1CaptureRespawnX=0x0;if(isCoopAIDemoActive||isPlayerTwoAI&&selectedOnePlayerGameVariant===_0x54d5a9(0x165))smoothedShip1X=ship1['x'];}if(player2NeedsRespawnAfterCapture&&player2Lives>0x0){ship2={'x':player2CaptureRespawnX,'y':_0x1a19d1,'width':SHIP_WIDTH,'height':SHIP_HEIGHT,'speed':SHIP_MOVE_SPEED,'targetX':player2CaptureRespawnX,'id':'p2'},isPlayer2ShipCaptured=![],isPlayer2Invincible=!![],player2InvincibilityEndTime=_0x52d25d+INVINCIBILITY_DURATION_MS,isPlayer2WaitingForRespawn=![],player2NeedsRespawnAfterCapture=![],player2CaptureRespawnX=0x0;if(isCoopAIDemoActive||isPlayerTwoAI&&selectedOnePlayerGameVariant===_0x54d5a9(0x165))smoothedShip2X=ship2['x'];}if(player1Lives<=0x0&&player2Lives<=0x0){if(gameOverSequenceStartTime===0x0)triggerFinalGameOverSequence();}}else{if(!isManualControl&&!isPlayerTwoAI){if(isShipCaptured&&playerLives>0x0){let _0x324d2f=gameCanvas?gameCanvas['width']/0x2-SHIP_WIDTH/0x2:0xc8;if(typeof smoothedShipX===_0x54d5a9(0x112))_0x324d2f=smoothedShipX;ship={'x':_0x324d2f,'y':_0x1a19d1,'width':SHIP_WIDTH,'height':SHIP_HEIGHT,'speed':SHIP_MOVE_SPEED,'targetX':_0x324d2f,'id':'main'},isShipCaptured=![],isInvincible=!![],invincibilityEndTime=_0x52d25d+INVINCIBILITY_DURATION_MS,isWaitingForRespawn=![],aiNeedsStabilization=!![];if(smoothedShipX===undefined&&ship)smoothedShipX=ship['x'];}else playerLives<=0x0&&gameOverSequenceStartTime===0x0&&triggerFinalGameOverSequence();}else{if(isManualControl){if(isShipCaptured&&playerLives>0x0){let _0x203913=capturedShipRespawnX_NormalMode!==0x0?capturedShipRespawnX_NormalMode:gameCanvas?gameCanvas[_0x54d5a9(0x1c4)]/0x2-SHIP_WIDTH/0x2:0xc8;ship={'x':_0x203913,'y':_0x1a19d1,'width':SHIP_WIDTH,'height':SHIP_HEIGHT,'speed':SHIP_MOVE_SPEED,'targetX':_0x203913,'id':'main'},isShipCaptured=![],capturedShipRespawnX_NormalMode=0x0,isInvincible=!![],invincibilityEndTime=_0x52d25d+INVINCIBILITY_DURATION_MS,isWaitingForRespawn=!![],respawnTime=_0x52d25d+RESPAWN_DELAY_MS;if(isPlayerTwoAI&&selectedGameMode===_0x54d5a9(0x156)&&currentPlayer===0x2)aiNeedsStabilization=!![];}else playerLives<=0x0&&gameOverSequenceStartTime===0x0&&((!isTwoPlayerMode||isTwoPlayerMode&&selectedGameMode===_0x54d5a9(0x156)&&(currentPlayer===0x1&&player2Lives<=0x0||currentPlayer===0x2&&player1Lives<=0x0))&&triggerFinalGameOverSequence());}}}}renderGame();return;}const _0x363b3e=!(isPlayer1ShowingGameOverMessage||isPlayer2ShowingGameOverMessage||isShowingPlayerGameOverMessage),_0x4ba795=isShowingIntro&&!_0xf466f&&!(selectedGameMode===_0x54d5a9(0x99)&&level===0x1);if(!_0xf466f&&gameOverSequenceStartTime===0x0&&_0x20c3d2&&!isShowingCaptureMessage&&_0x363b3e){if(isInGameState&&!_0x4ba795){if(!(_0x1efebf&&!isManualControl)){if(isCoopAIDemoActive||isPlayerTwoAI&&selectedOnePlayerGameVariant===_0x54d5a9(0x165))aiControlCoop();else{if(isPlayerTwoAI&&selectedGameMode==='normal'&&currentPlayer===0x2)aiControl();else!isManualControl&&!isPlayerTwoAI&&aiControl();}}isManualControl&&handlePlayerInput();}}isTwoPlayerMode&&selectedGameMode===_0x54d5a9(0x99)?(isPlayer1Invincible&&_0x52d25d>=player1InvincibilityEndTime&&(isPlayer1Invincible=![],player1InvincibilityEndTime=0x0),isPlayer2Invincible&&_0x52d25d>=player2InvincibilityEndTime&&(isPlayer2Invincible=![],player2InvincibilityEndTime=0x0)):(isInvincible&&_0x52d25d>=invincibilityEndTime&&(isInvincible=![],invincibilityEndTime=0x0),isWaitingForRespawn&&_0x52d25d>=respawnTime&&(isWaitingForRespawn=![]));const _0x25a996=showExtraLifeMessage&&_0x52d25d-extraLifeMessageStartTime<0x64;if(_0x25a996&&(isWaveTransitioning||isChallengingStage&&enemies['length']===0x0)){}if((isCoopAIDemoActive||isPlayerTwoAI&&selectedOnePlayerGameVariant===_0x54d5a9(0x165))&&isChallengingStage&&enemies[_0x54d5a9(0x100)]===0x0&&!isCsCompletionDelayActive&&!showCsBonusScoreMessage&&!showPerfectMessage&&gameCanvas&&gameCanvas[_0x54d5a9(0x1c4)]>0x0){const _0x54b77c=ship1&&player1Lives>0x0&&!isPlayer1ShipCaptured&&!isPlayer1WaitingForRespawn&&!isPlayer1ShowingGameOverMessage,_0x149e40=ship2&&player2Lives>0x0&&!isPlayer2ShipCaptured&&!isPlayer2WaitingForRespawn&&!isPlayer2ShowingGameOverMessage;if(_0x54b77c&&!_0x149e40){const _0x5e66bf=player1IsDualShipActive?SHIP_WIDTH+DUAL_SHIP_OFFSET_X:SHIP_WIDTH,_0x19e4cd=Math[_0x54d5a9(0x196)](gameCanvas[_0x54d5a9(0x1c4)]/0x2-_0x5e66bf/0x2);ship1['x']=_0x19e4cd,ship1['targetX']=_0x19e4cd,smoothedShip1X=_0x19e4cd;}else{if(_0x149e40&&!_0x54b77c){const _0x58568f=player2IsDualShipActive?SHIP_WIDTH+DUAL_SHIP_OFFSET_X:SHIP_WIDTH,_0x27dbc6=Math[_0x54d5a9(0x196)](gameCanvas[_0x54d5a9(0x1c4)]/0x2-_0x58568f/0x2);ship2['x']=_0x27dbc6,ship2[_0x54d5a9(0x107)]=_0x27dbc6,smoothedShip2X=_0x27dbc6;}}}if(isCsCompletionDelayActive&&_0x363b3e&&gameOverSequenceStartTime===0x0){if(_0x52d25d-csCompletionDelayStartTime>=CS_COMPLETION_MESSAGE_DELAY+EXPLOSION_DURATION){isCsCompletionDelayActive=![],csCompletionResultIsPerfect=challengingStageEnemiesHit>=challengingStageTotalEnemies;csCompletionResultIsPerfect?(playSound('csPerfectSound',![],0.6),showCsHitsMessage=!![],csHitsMessageStartTime=_0x52d25d):(playSound(_0x54d5a9(0x124),![],0.6),showCSClearMessage=!![],csClearMessageStartTime=_0x52d25d);bullets=[],enemyBullets=[],renderGame();return;}else{if(_0x52d25d-csCompletionDelayStartTime>=CS_COMPLETION_MESSAGE_DELAY&&explosions[_0x54d5a9(0x100)]>0x0){updateExplosions(),renderGame();return;}else{if(_0x52d25d-csCompletionDelayStartTime<CS_COMPLETION_MESSAGE_DELAY){renderGame();return;}}}}let _0x1292e2=![],_0x33ae2b=![];if(_0x363b3e&&gameOverSequenceStartTime===0x0&&!isShowingCoopPlayersReady&&!_0xf466f){if(showCsHitsMessage){if(_0x52d25d-csHitsMessageStartTime<0x64){explosions=[];if(typeof updateExplosions===_0x54d5a9(0x11f))updateExplosions();}if(Date[_0x54d5a9(0x1a6)]()-csHitsMessageStartTime>CS_HITS_MESSAGE_DURATION){showCsHitsMessage=![],showPerfectMessage=!![],perfectMessageStartTime=_0x52d25d,explosions=[];if(typeof updateExplosions===_0x54d5a9(0x11f))updateExplosions();}_0x33ae2b=!![];}else{if(showPerfectMessage){if(_0x52d25d-perfectMessageStartTime<0x64){explosions=[];if(typeof updateExplosions===_0x54d5a9(0x11f))updateExplosions();}if(Date[_0x54d5a9(0x1a6)]()-perfectMessageStartTime>CS_PERFECT_MESSAGE_DURATION){showPerfectMessage=![],showCsBonusScoreMessage=!![],csBonusScoreMessageStartTime=_0x52d25d,explosions=[];if(typeof updateExplosions==='function')updateExplosions();}_0x33ae2b=!![];}else{if(showCsBonusScoreMessage){if(_0x52d25d-csBonusScoreMessageStartTime<0x64){explosions=[];if(typeof updateExplosions===_0x54d5a9(0x11f))updateExplosions();}if(Date[_0x54d5a9(0x1a6)]()-csBonusScoreMessageStartTime>CS_BONUS_MESSAGE_DURATION){showCsBonusScoreMessage=![],_0x1292e2=!![],playLevelUpAfterCSBonus=!![],explosions=[];if(typeof updateExplosions===_0x54d5a9(0x11f))updateExplosions();}_0x33ae2b=!![];}else{if(showCSClearMessage){if(_0x52d25d-csClearMessageStartTime<0x64){explosions=[];if(typeof updateExplosions===_0x54d5a9(0x11f))updateExplosions();}Date[_0x54d5a9(0x1a6)]()-csClearMessageStartTime>=CS_CLEAR_HITS_DELAY&&!showCsHitsForClearMessage&&(showCsHitsForClearMessage=!![]);Date['now']()-csClearMessageStartTime>=CS_CLEAR_SCORE_DELAY&&!showCsScoreForClearMessage&&(showCsScoreForClearMessage=!![]);if(Date[_0x54d5a9(0x1a6)]()-csClearMessageStartTime>=CS_CLEAR_DELAY){showCSClearMessage=![],showCsHitsForClearMessage=![],showCsScoreForClearMessage=![],_0x1292e2=!![],playLevelUpAfterCSBonus=!![],explosions=[];if(typeof updateExplosions==='function')updateExplosions();}_0x33ae2b=!![];}else{if(showExtraLifeMessage)Date[_0x54d5a9(0x1a6)]()-extraLifeMessageStartTime>EXTRA_LIFE_MESSAGE_DURATION&&(showExtraLifeMessage=![]),_0x33ae2b=!![];else{if(showReadyMessage){if(_0x52d25d-readyMessageStartTime<0x64){explosions=[];if(typeof updateExplosions===_0x54d5a9(0x11f))updateExplosions();}if(Date[_0x54d5a9(0x1a6)]()-readyMessageStartTime>READY_MESSAGE_DURATION){showReadyMessage=![],_0x1292e2=!![],explosions=[];if(typeof updateExplosions===_0x54d5a9(0x11f))updateExplosions();}_0x33ae2b=!![];}}}}}}}if(_0x33ae2b&&!_0x1292e2&&!isShowingCoopPlayersReady&&!_0xf466f&&!isShowingCaptureMessage&&_0x363b3e){if(!((_0x1efebf||showCsHitsMessage||showCSClearMessage)&&isManualControl)&&!showExtraLifeMessage){renderGame();return;}}if(_0x4ba795&&_0x363b3e&&gameOverSequenceStartTime===0x0){let _0x3419b2=![];const _0x9a5e65=_0x52d25d-introDisplayStartTime;let _0x486417=INTRO_DURATION_PER_STEP;const _0xba9f48=isPlayerTwoAI&&selectedOnePlayerGameVariant==='1P_VS_AI_NORMAL',_0x2e1d39=isTwoPlayerMode&&selectedGameMode===_0x54d5a9(0x156)&&!isPlayerTwoAI;(_0x2e1d39||_0xba9f48)&&(_0x486417=TWO_PLAYER_STAGE_INTRO_DURATION);if(introStep===0x1){if(_0x9a5e65<0x64){explosions=[];if(typeof updateExplosions===_0x54d5a9(0x11f))updateExplosions();}let _0x28b188=null,_0x5794bd=0x1;if(!playerIntroSoundPlayed){const _0x56b916=_0xba9f48||_0x2e1d39,_0x14fe27=isPlayerTwoAI&&selectedOnePlayerGameVariant===_0x54d5a9(0x165)&&level>0x1;if(_0x56b916){if(currentPlayer===0x1&&level===0x1&&!initialGameStartSoundPlayedThisSession)_0x28b188=_0x54d5a9(0x116),_0x5794bd=0.4;else(currentPlayer===0x2||level>0x1)&&(_0x28b188=_0x54d5a9(0xe7),_0x5794bd=0.2);}else{if(_0x14fe27)_0x28b188=_0x54d5a9(0xe7),_0x5794bd=0.2;else{if(!isTwoPlayerMode){if(level===0x1&&!initialGameStartSoundPlayedThisSession)_0x28b188=_0x54d5a9(0x116),_0x5794bd=0.4;else level>0x1&&(_0x28b188=_0x54d5a9(0xe7),_0x5794bd=0.2);}}}}_0x28b188&&(playSound(_0x28b188,![],_0x5794bd),playerIntroSoundPlayed=!![],_0x28b188==='startSound'&&(initialGameStartSoundPlayedThisSession=!![]));if(_0x9a5e65>=_0x486417){if(isChallengingStage)introStep=0x3;else introStep=0x2;introDisplayStartTime=_0x52d25d,explosions=[];if(typeof updateExplosions==='function')updateExplosions();}}else{if(introStep===0x2){if(_0x9a5e65<0x64){explosions=[];if(typeof updateExplosions===_0x54d5a9(0x11f))updateExplosions();}if(!stageIntroSoundPlayed){if(playLevelUpAfterCSBonus&&(isTwoPlayerMode&&selectedGameMode===_0x54d5a9(0x99)))playSound(_0x54d5a9(0xe7),![],0.2),playLevelUpAfterCSBonus=![],stageIntroSoundPlayed=!![];else{if(isTwoPlayerMode&&selectedGameMode===_0x54d5a9(0x99)&&!isPlayerTwoAI&&!isCoopAIDemoActive)playSound('levelUpSound',![],0.2),stageIntroSoundPlayed=!![];else{if(selectedGameMode===_0x54d5a9(0x99)){if((isCoopAIDemoActive||isPlayerTwoAI&&selectedOnePlayerGameVariant===_0x54d5a9(0x165))&&level>0x1)playSound(_0x54d5a9(0xe7),![],0.2),stageIntroSoundPlayed=!![];else(isCoopAIDemoActive||isPlayerTwoAI&&selectedOnePlayerGameVariant==='1P_VS_AI_COOP')&&level===0x1&&(stageIntroSoundPlayed=!![]);}else{if(!isTwoPlayerMode&&level>0x1)playSound(_0x54d5a9(0xe7),![],0.2),stageIntroSoundPlayed=!![];else{if(level>0x1&&!playerIntroSoundPlayed&&!(isPlayerTwoAI&&selectedGameMode===_0x54d5a9(0x156))&&!initialGameStartSoundPlayedThisSession)playSound(_0x54d5a9(0xe7),![],0.2),stageIntroSoundPlayed=!![];else level===0x1&&!isManualControl&&!isCoopAIDemoActive&&!(isPlayerTwoAI&&selectedGameMode==='coop')&&!initialGameStartSoundPlayedThisSession&&(playSound(_0x54d5a9(0x116),![],0.4),initialGameStartSoundPlayedThisSession=!![],stageIntroSoundPlayed=!![]);}}}}}if(_0x9a5e65>=_0x486417){_0x3419b2=!![],explosions=[];if(typeof updateExplosions==='function')updateExplosions();}}else{if(introStep===0x3){if(_0x9a5e65<0x64){explosions=[];if(typeof updateExplosions==='function')updateExplosions();}!csIntroSoundPlayed&&(playSound('entranceSound',![],0.4),csIntroSoundPlayed=!![],stageIntroSoundPlayed=!![]);if(_0x9a5e65>=_0x486417){_0x3419b2=!![],explosions=[];if(typeof updateExplosions===_0x54d5a9(0x11f))updateExplosions();}}}}if(isInGameState&&_0x363b3e&&gameOverSequenceStartTime===0x0&&gameCanvas){let _0x679aa8=null,_0x31f28f=null;const _0x5b1170=isManualControl&&isPlayerTwoAI&&selectedOnePlayerGameVariant===_0x54d5a9(0xde)&&currentPlayer===0x1&&isShowingIntro;if(_0x5b1170){let _0xb14171=![],_0x1ffb77=![];const _0x19498e=navigator[_0x54d5a9(0x92)]();if(connectedGamepadIndex!==null&&_0x19498e?.[connectedGamepadIndex]){const _0x110df4=_0x19498e[connectedGamepadIndex],_0x2ab1ba=processSingleController(_0x110df4,previousGameButtonStates);_0xb14171=_0x2ab1ba['left'],_0x1ffb77=_0x2ab1ba[_0x54d5a9(0x94)];}_0x679aa8=keyboardP1LeftDown||_0xb14171,_0x31f28f=keyboardP1RightDown||_0x1ffb77;}if(_0xba9f48&&currentPlayer===0x2)aiControl();else{if(isCoopAIDemoActive||isPlayerTwoAI&&selectedOnePlayerGameVariant===_0x54d5a9(0x165))aiControlCoop();else!isManualControl&&!isPlayerTwoAI&&aiControl();}typeof moveEntities==='function'&&moveEntities(_0x679aa8,_0x31f28f),updateExplosions(),updateFloatingScores();}if(_0x3419b2){isShowingIntro=![],introStep=0x0,playerIntroSoundPlayed=![],stageIntroSoundPlayed=![],csIntroSoundPlayed=![];isManualControl&&(isShowingDemoText=![]);if(!isChallengingStage)isCoopAIDemoActive||isPlayerTwoAI&&selectedOnePlayerGameVariant==='1P_VS_AI_COOP'?(aiShip1CanShootTime=Date[_0x54d5a9(0x1a6)]()+0x3e8,aiShip2CanShootTime=Date[_0x54d5a9(0x1a6)]()+0x4b0):aiCanShootTime=Date['now']()+(isPlayerTwoAI&&selectedOnePlayerGameVariant===_0x54d5a9(0xde)?0x3e8:0xbb8);else{if(isCoopAIDemoActive||isPlayerTwoAI&&selectedOnePlayerGameVariant===_0x54d5a9(0x165))aiShip1CanShootTime=0x0,aiShip2CanShootTime=0x0;else aiCanShootTime=0x0;}const _0x47a350=level===0x1&&selectedGameMode!==_0x54d5a9(0x99),_0x56a130=level===0x1&&selectedGameMode===_0x54d5a9(0x99),_0x194d72=_0x47a350&&!gameJustStartedAndWaveLaunched||level>0x1||isChallengingStage||_0x56a130&&!gameJustStartedAndWaveLaunched;if(_0x194d72){if(isChallengingStage)startChallengingStageSequence();else{if(currentWaveDefinition&&currentWaveDefinition[_0x54d5a9(0x100)]>0x0){if(isFullGridWave)startFullGridWave();else scheduleEntranceFlightWave(),playSound('entranceSound',![],0.4);}else isEntrancePhaseActive=![],stopSound(_0x54d5a9(0x173)),isWaveTransitioning=!![],readyForNextWaveReset=!![],bullets=[],enemyBullets=[],explosions=[],setTimeout(()=>{const _0x33ff58=_0x54d5a9,_0x314de3=isTwoPlayerMode&&selectedGameMode===_0x33ff58(0x99)?player1Lives>0x0||player2Lives>0x0:playerLives>0x0;if((isInGameState||!isInGameState&&_0x314de3)&&typeof resetWaveInternal==='function'){if(_0x314de3)resetWaveInternal(),gameJustStartedAndWaveLaunched=![],gameJustStarted=!![];else triggerFinalGameOverSequence();}},0x64);}if(_0x47a350||level>0x1||isChallengingStage||_0x56a130)gameJustStartedAndWaveLaunched=!![];}}isManualControl&&_0x4ba795&&_0x363b3e&&gameOverSequenceStartTime===0x0&&handlePlayerInput();renderGame();return;}const _0x326f39=!_0xf466f&&!_0x4ba795&&!_0x1292e2&&!isShowingCaptureMessage;if(gameJustStarted&&_0x326f39){if(!gameJustStartedAndWaveLaunched){const _0x4998e8=selectedGameMode===_0x54d5a9(0x99)&&level===0x1&&coopPlayersReadyStartTime!==0x0;if(!_0x4998e8){if(isChallengingStage)startChallengingStageSequence();else{if(currentWaveDefinition&&currentWaveDefinition[_0x54d5a9(0x100)]>0x0){if(isFullGridWave)startFullGridWave();else scheduleEntranceFlightWave(),playSound(_0x54d5a9(0x173),![],0.4);}else isWaveTransitioning=!![],readyForNextWaveReset=!![];}gameJustStartedAndWaveLaunched=!![];}}gameJustStarted=![];}if(_0x326f39&&isInGameState&&_0x363b3e&&gameOverSequenceStartTime===0x0){if(!_0x1efebf||_0x1efebf&&isManualControl){if(isCoopAIDemoActive||isPlayerTwoAI&&selectedOnePlayerGameVariant===_0x54d5a9(0x165))aiControlCoop();else{if(isPlayerTwoAI&&selectedGameMode===_0x54d5a9(0x156)&&currentPlayer===0x2)aiControl();else!isManualControl&&!isPlayerTwoAI&&aiControl();}isManualControl&&handlePlayerInput();if(typeof moveEntities===_0x54d5a9(0x11f))moveEntities();updateExplosions(),updateFloatingScores();}else _0x1efebf&&(isCoopAIDemoActive||isPlayerTwoAI&&selectedOnePlayerGameVariant===_0x54d5a9(0x165))&&(updateExplosions(),updateFloatingScores());}if(_0x326f39&&_0x363b3e&&gameOverSequenceStartTime===0x0){if(GRID_BREATH_ENABLED&&isInGameState&&!isChallengingStage&&!isWaveTransitioning&&_0x20c3d2){const _0x4bdd32=enemies[_0x54d5a9(0xdd)](_0x3b53d5=>_0x3b53d5?.['state']===_0x54d5a9(0x9d));if(_0x4bdd32&&isGridBreathingActive){const _0x1d2b9e=_0x52d25d-gridBreathStartTime,_0x2a2446=scaleValue(level,BASE_GRID_BREATH_CYCLE_MS,MIN_GRID_BREATH_CYCLE_MS),_0x40494b=_0x1d2b9e%_0x2a2446;currentGridBreathFactor=(Math[_0x54d5a9(0xa1)](_0x40494b/_0x2a2446*Math['PI']*0x2-Math['PI']/0x2)+0x1)/0x2;}else{if(!_0x4bdd32&&isGridBreathingActive)isGridBreathingActive=![],gridBreathStartTime=0x0,currentGridBreathFactor=0x0;else _0x4bdd32&&!isGridBreathingActive&&(isGridBreathingActive=!![],gridBreathStartTime=_0x52d25d,currentGridBreathFactor=0x0);}}else isGridBreathingActive&&(isGridBreathingActive=![],gridBreathStartTime=0x0,currentGridBreathFactor=0x0);if(isEntrancePhaseActive){const _0x4c0413=enemiesSpawnedThisWave>=totalEnemiesScheduledForWave,_0x57fd44=enemies['some'](_0x4f8c40=>_0x4f8c40?.[_0x54d5a9(0x106)]==='following_entrance_path'||_0x4f8c40?.[_0x54d5a9(0x106)]===_0x54d5a9(0x15f)||_0x4f8c40?.[_0x54d5a9(0x106)]==='following_bezier_path');if(totalEnemiesScheduledForWave>0x0&&_0x4c0413&&!_0x57fd44){const _0x1fb77e=isEntrancePhaseActive;isEntrancePhaseActive=![];if(_0x1fb77e){stopSound(_0x54d5a9(0x173)),enemiesSpawnedThisWave=0x0,totalEnemiesScheduledForWave=0x0,enemySpawnTimeouts[_0x54d5a9(0xce)](clearTimeout),enemySpawnTimeouts=[],gridJustCompleted=!![];if(!isChallengingStage&&!isFullGridWave){if(isCoopAIDemoActive||isPlayerTwoAI&&selectedOnePlayerGameVariant===_0x54d5a9(0x165))coopAICaptureDiveAnticipationActive=!![],coopAICaptureDiveAnticipationEndTime=Date[_0x54d5a9(0x1a6)]()+COOP_AI_CAPTURE_DIVE_ANTICIPATION_DURATION_MS,typeof triggerImmediateCaptureDive===_0x54d5a9(0x11f)&&triggerImmediateCaptureDive();else typeof triggerImmediateCaptureDive===_0x54d5a9(0x11f)&&triggerImmediateCaptureDive();}}}}if(!isChallengingStage&&!_0x4ba795&&!isPaused&&!isWaveTransitioning)triggerGridFiring();if(!isWaveTransitioning&&_0x20c3d2&&!_0x4ba795&&!isShowingCaptureMessage&&!isEntrancePhaseActive){let _0x4ab928=enemies[_0x54d5a9(0x100)]===0x0,_0x2b7880=fallingShips[_0x54d5a9(0x100)]===0x0,_0x501e37=![];if(isChallengingStage){if(_0x4ab928&&!isEntrancePhaseActive)_0x501e37=!![];}else{if(_0x4ab928&&!isEntrancePhaseActive&&_0x2b7880)_0x501e37=!![];}if(_0x501e37){isGridBreathingActive&&(isGridBreathingActive=![],gridBreathStartTime=0x0,currentGridBreathFactor=0x0);if((isCoopAIDemoActive||isPlayerTwoAI&&selectedOnePlayerGameVariant==='1P_VS_AI_COOP')&&gameCanvas&&gameCanvas['width']>0x0){const _0x1dee26=player1Lives,_0x55cce6=player2Lives,_0x282aff=gameCanvas[_0x54d5a9(0x120)]-SHIP_HEIGHT-SHIP_BOTTOM_MARGIN;if(_0x1dee26>0x0&&_0x55cce6<=0x0&&ship1){const _0xed1c9f=player1IsDualShipActive?SHIP_WIDTH+DUAL_SHIP_OFFSET_X:SHIP_WIDTH,_0x4350cd=Math[_0x54d5a9(0x196)](gameCanvas[_0x54d5a9(0x1c4)]/0x2-_0xed1c9f/0x2);ship1['x']=_0x4350cd,ship1[_0x54d5a9(0x107)]=_0x4350cd,smoothedShip1X=_0x4350cd,ship1['y']=_0x282aff;}else{if(_0x55cce6>0x0&&_0x1dee26<=0x0&&ship2){const _0x4a8748=player2IsDualShipActive?SHIP_WIDTH+DUAL_SHIP_OFFSET_X:SHIP_WIDTH,_0x1f50fd=Math[_0x54d5a9(0x196)](gameCanvas[_0x54d5a9(0x1c4)]/0x2-_0x4a8748/0x2);ship2['x']=_0x1f50fd,ship2[_0x54d5a9(0x107)]=_0x1f50fd,smoothedShip2X=_0x1f50fd,ship2['y']=_0x282aff;}}}isWaveTransitioning=!![];isGridSoundPlaying&&(stopSound(_0x54d5a9(0x11c)),isGridSoundPlaying=![]);!isChallengingStage&&(bullets=[],enemyBullets=[]);floatingScores=[],enemySpawnTimeouts[_0x54d5a9(0xce)](clearTimeout),enemySpawnTimeouts=[],totalEnemiesScheduledForWave=0x0,enemiesSpawnedThisWave=0x0;let _0x1abef2;if(isChallengingStage){csCompletionResultIsPerfect=challengingStageEnemiesHit>=challengingStageTotalEnemies,csCurrentChainHits=0x0,csCurrentChainScore=0x0,csLastHitTime=0x0,csLastChainHitPosition=null,setTimeout(()=>{const _0x342bcd=_0x54d5a9;if(isWaveTransitioning){explosions=[];if(typeof updateExplosions===_0x342bcd(0x11f))updateExplosions();isCsCompletionDelayActive=!![],csCompletionDelayStartTime=Date[_0x342bcd(0x1a6)]();}},EXPLOSION_DURATION);if(csCompletionResultIsPerfect){let _0x24457e=0x2710;if(isTwoPlayerMode&&selectedGameMode==='coop')(player1Lives>0x0||(isCoopAIDemoActive||isPlayerTwoAI&&selectedOnePlayerGameVariant===_0x54d5a9(0x165))&&ship1)&&(player1Score+=_0x24457e),(player2Lives>0x0||(isCoopAIDemoActive||isPlayerTwoAI&&selectedOnePlayerGameVariant==='1P_VS_AI_COOP')&&ship2)&&(player2Score+=_0x24457e),highScore=Math['max'](highScore,player1Score,player2Score),checkAndAwardExtraLife(null);else{score+=_0x24457e;if(!isTwoPlayerMode)player1Score=score;else{if(isTwoPlayerMode&&selectedGameMode===_0x54d5a9(0x156)){if(currentPlayer===0x1)player1Score=score;else player2Score=score;}}highScore=Math[_0x54d5a9(0x14a)](highScore,score,player1Score,player2Score),checkAndAwardExtraLife(currentPlayer);}_0x1abef2=EXPLOSION_DURATION+CS_COMPLETION_MESSAGE_DELAY+CS_HITS_MESSAGE_DURATION+CS_PERFECT_MESSAGE_DURATION+CS_BONUS_MESSAGE_DURATION;}else isTwoPlayerMode&&selectedGameMode===_0x54d5a9(0x99)?checkAndAwardExtraLife(null):checkAndAwardExtraLife(currentPlayer),_0x1abef2=EXPLOSION_DURATION+CS_COMPLETION_MESSAGE_DELAY+CS_CLEAR_DELAY;_0x1abef2+=0x64;}else playSound(_0x54d5a9(0x1a7),![],0.8),normalWaveCurrentChainHits=0x0,normalWaveCurrentChainScore=0x0,normalWaveLastHitTime=0x0,normalWaveLastHitPosition=null,_0x1abef2=POST_MESSAGE_RESET_DELAY;setTimeout(()=>{const _0x396eb1=_0x54d5a9;let _0x12804a=![],_0x1f82ac=0x0;if(isTwoPlayerMode&&selectedGameMode==='normal'){_0x1f82ac=currentPlayer;_0x1f82ac===0x1?player1MaxLevelReached=Math[_0x396eb1(0x14a)](player1MaxLevelReached,level):player2MaxLevelReached=Math[_0x396eb1(0x14a)](player2MaxLevelReached,level);const _0x4b12d7=switchPlayerTurn();if(_0x4b12d7){if(_0x1f82ac===0x2&&currentPlayer===0x1&&player1CompletedLevel===level)_0x12804a=!![],player1CompletedLevel=-0x1;else _0x1f82ac===0x1?(player1CompletedLevel=level,_0x12804a=![]):_0x12804a=![];}else _0x12804a=!![],player1CompletedLevel=-0x1;}else{_0x12804a=!![];if(!isTwoPlayerMode)player1MaxLevelReached=Math[_0x396eb1(0x14a)](player1MaxLevelReached,level);else{if(isTwoPlayerMode&&selectedGameMode===_0x396eb1(0x99)){if(player1Lives>0x0)player1MaxLevelReached=Math[_0x396eb1(0x14a)](player1MaxLevelReached,level);if(player2Lives>0x0)player2MaxLevelReached=Math['max'](player2MaxLevelReached,level);}}}if(_0x12804a){level++;if(isTwoPlayerMode&&selectedGameMode==='coop'){if(player1Lives>0x0)player1MaxLevelReached=Math['max'](player1MaxLevelReached,level);if(player2Lives>0x0)player2MaxLevelReached=Math[_0x396eb1(0x14a)](player2MaxLevelReached,level);}else{if(isTwoPlayerMode&&selectedGameMode===_0x396eb1(0x156)){if(currentPlayer===0x1&&player1Lives>0x0)player1MaxLevelReached=Math['max'](player1MaxLevelReached,level);else{if(currentPlayer===0x2&&player2Lives>0x0)player2MaxLevelReached=Math[_0x396eb1(0x14a)](player2MaxLevelReached,level);}}else{if(playerLives>0x0)player1MaxLevelReached=Math[_0x396eb1(0x14a)](player1MaxLevelReached,level);}}}let _0x10b64e=![];if(isTwoPlayerMode&&selectedGameMode==='coop')_0x10b64e=player1Lives>0x0||player2Lives>0x0;else{if(isTwoPlayerMode&&selectedGameMode===_0x396eb1(0x156))_0x10b64e=(currentPlayer===0x1?player1Lives:player2Lives)>0x0;else _0x10b64e=playerLives>0x0;}_0x10b64e?(resetWaveInternal(),gameJustStartedAndWaveLaunched=![],gameJustStarted=!![]):triggerFinalGameOverSequence();},_0x1abef2),renderGame();return;}if(!isChallengingStage){if(enemies[_0x54d5a9(0x100)]>0x0){let _0x55ecdd=null;const _0x258128=enemies[_0x54d5a9(0x19e)](_0x44e663=>_0x44e663?.['state']==='in_grid'),_0x4f7731=_0x258128[_0x54d5a9(0x100)]<=0x3,_0x91d73c=Math[_0x54d5a9(0x14a)](0x1,Math[_0x54d5a9(0xf4)](level,LEVEL_CAP_FOR_SCALING)),_0x370bd8=0x1068,_0x290a7a=0x320,_0x557702=(_0x91d73c-0x1)*((_0x370bd8-_0x290a7a)/(LEVEL_CAP_FOR_SCALING-0x1)),_0x465c09=Math['max'](_0x290a7a,_0x370bd8-_0x557702),_0x37027e=Math[_0x54d5a9(0x196)](scaleValue(level,BASE_MAX_ATTACKING_ENEMIES,MAX_MAX_ATTACKING_ENEMIES)),_0x10507f=enemies['filter'](_0x2726a6=>_0x2726a6?.[_0x54d5a9(0x106)]===_0x54d5a9(0xeb)||_0x2726a6?.[_0x54d5a9(0x106)]===_0x54d5a9(0x147))[_0x54d5a9(0x100)];if(_0x4f7731||_0x52d25d-lastEnemyDetachTime>_0x465c09&&_0x258128[_0x54d5a9(0x100)]>0x0&&_0x10507f<_0x37027e){_0x55ecdd=findAndDetachEnemy();if(_0x55ecdd&&_0x55ecdd['length']>0x0){const _0x448c79=_0x55ecdd[_0x54d5a9(0x11b)](_0x5af17c=>enemies[_0x54d5a9(0x19b)](_0x4363ed=>_0x4363ed?.['id']===_0x5af17c['id']))[_0x54d5a9(0x19e)](_0x3d252=>_0x3d252&&_0x3d252['state']===_0x54d5a9(0x9d));if(_0x448c79[_0x54d5a9(0x100)]>0x0){const _0x47acb7=_0x448c79[0x0],_0x2d8ffb=_0x47acb7[_0x54d5a9(0x13f)];if(!_0x4f7731)lastEnemyDetachTime=_0x52d25d;if(_0x2d8ffb===_0x54d5a9(0x156)){const _0x47b1a2=generateAttackPathInternal(_0x47acb7);if(_0x47b1a2&&_0x47b1a2[_0x54d5a9(0x100)]>0x0){if(_0x448c79['length']===0x3&&_0x47acb7[_0x54d5a9(0x9f)]===ENEMY3_TYPE&&level!==0x1)playSound('tripleAttackSound',![],0.3);let _0x429612=[..._0x448c79];const _0x1fc59b=_0x429612['length'];if(_0x1fc59b>0x1){let _0x1bcf8f=null,_0x1d0bd2=[];_0x429612['forEach'](_0x4940ec=>{const _0x2f9baa=_0x54d5a9;if(_0x4940ec[_0x2f9baa(0x9f)]===ENEMY3_TYPE)_0x1bcf8f=_0x4940ec;else _0x1d0bd2[_0x2f9baa(0xd2)](_0x4940ec);});if(_0x1bcf8f&&level!==0x1&&_0x1fc59b===0x3&&_0x1d0bd2[_0x54d5a9(0x100)]===0x2)_0x429612=[_0x1d0bd2[0x0],_0x1bcf8f,_0x1d0bd2[0x1]];else _0x429612[_0x54d5a9(0x1ba)]((_0x5286b7,_0x4c7bc8)=>(_0x5286b7?.[_0x54d5a9(0x1bf)]??0x0)-(_0x4c7bc8?.[_0x54d5a9(0x1bf)]??0x0));const _0x20a3db=0x5;let _0x5d1aa6=0x0;_0x429612=_0x429612[_0x54d5a9(0x19e)](_0x3a00b8=>_0x3a00b8&&typeof _0x3a00b8[_0x54d5a9(0x1c4)]==='number');const _0x5bcb78=_0x429612[_0x54d5a9(0x100)];for(let _0x1c02bc=0x0;_0x1c02bc<_0x5bcb78;_0x1c02bc++){_0x5d1aa6+=_0x429612[_0x1c02bc][_0x54d5a9(0x1c4)];if(_0x1c02bc<_0x5bcb78-0x1)_0x5d1aa6+=_0x20a3db;}const _0xa3cfd6=-_0x5d1aa6/0x2;let _0x48e26d=_0xa3cfd6;for(let _0x49a2a9=0x0;_0x49a2a9<_0x5bcb78;_0x49a2a9++){const _0x414f08=_0x429612[_0x49a2a9];_0x414f08[_0x54d5a9(0xda)]=_0x48e26d+_0x414f08[_0x54d5a9(0x1c4)]/0x2,_0x48e26d+=_0x414f08['width']+_0x20a3db;}}else _0x429612[_0x54d5a9(0xce)](_0x174faf=>_0x174faf[_0x54d5a9(0xda)]=0x0);const _0x42781d=_0x54d5a9(0x1aa)+_0x47acb7['id']+'-'+_0x52d25d;_0x429612[_0x54d5a9(0xce)](_0x503dd2=>{const _0x1ee945=_0x54d5a9;if(_0x503dd2)_0x503dd2[_0x1ee945(0xb7)]=_0x42781d;});let _0x466988=![],_0x2e554b=GROUP_FIRE_BURST_DELAY;if(_0x47acb7[_0x54d5a9(0x9f)]===ENEMY2_TYPE||_0x47acb7[_0x54d5a9(0x9f)]===ENEMY3_TYPE){_0x466988=!![];if(_0x47acb7['type']===ENEMY2_TYPE&&_0x1fc59b===0x1)_0x2e554b=SOLO_BUTTERFLY_FIRE_DELAY;}else{if(_0x47acb7[_0x54d5a9(0x9f)]===ENEMY1_TYPE)_0x466988=!![];}if(_0x4f7731&&level>0x1)_0x466988=![];_0x466988&&_0x429612[_0x54d5a9(0xce)](_0x5aabd1=>{const _0x29f26a=_0x54d5a9,_0x2d1140=_0x5aabd1&&!(_0x5aabd1['type']===ENEMY3_TYPE&&_0x5aabd1[_0x29f26a(0x1b9)]);if(_0x2d1140)fireEnemyBurst(_0x5aabd1['id'],_0x29f26a(0xeb),_0x2e554b);}),_0x429612['forEach']((_0x2f1ee4,_0x8c37dc)=>{const _0x417754=_0x54d5a9;_0x2f1ee4&&_0x2f1ee4[_0x417754(0x106)]===_0x417754(0x9d)&&(_0x2f1ee4['state']=_0x417754(0x147),_0x2f1ee4[_0x417754(0xf8)]=![],_0x2f1ee4['velocityX']=0x0,_0x2f1ee4[_0x417754(0x174)]=0x0,_0x2f1ee4[_0x417754(0x135)]=![],setTimeout(()=>{const _0x42ebd4=_0x417754;if(isPaused)return;const _0xc6cd6a=enemies['find'](_0xec1e30=>_0xec1e30?.['id']===_0x2f1ee4['id']);if(_0xc6cd6a&&_0xc6cd6a['state']===_0x42ebd4(0x147))try{const _0x5d55b2=scaleValue(level,BASE_ENEMY_ATTACK_SPEED,MAX_ENEMY_ATTACK_SPEED);let _0x3250b0=0x1;if(_0xc6cd6a[_0x42ebd4(0x9f)]===ENEMY1_TYPE)_0x3250b0=ENEMY1_DIVE_SPEED_FACTOR;else{if(_0xc6cd6a[_0x42ebd4(0x9f)]===ENEMY2_TYPE)_0x3250b0=ENEMY2_DIVE_SPEED_FACTOR;else{if(_0xc6cd6a['type']===ENEMY3_TYPE)_0x3250b0=ENEMY3_ATTACK_SPEED_FACTOR;}}if(_0x2f1ee4[_0x42ebd4(0x9f)]===ENEMY3_TYPE)playSound(_0x42ebd4(0x11e),![],0.2);else playSound(_0x42ebd4(0x1a3),![],0.2);_0xc6cd6a['state']='attacking',_0xc6cd6a['attackPathSegments']=_0x47b1a2,_0xc6cd6a['attackPathSegmentIndex']=0x0,_0xc6cd6a[_0x42ebd4(0x1ab)]=0x0,_0xc6cd6a[_0x42ebd4(0x17f)]=_0x5d55b2*_0x3250b0,_0xc6cd6a[_0x42ebd4(0xa8)]=0x0,_0xc6cd6a[_0x42ebd4(0x135)]=!![];}catch(_0x14e2b2){console[_0x42ebd4(0x95)](_0x42ebd4(0x13b)+_0x2f1ee4['id']+':',_0x14e2b2);}},_0x8c37dc*GROUP_DETACH_DELAY_MS));});}else _0x55ecdd['forEach'](_0x5ba0d4=>{const _0x34dc49=_0x54d5a9;if(_0x5ba0d4)_0x5ba0d4[_0x34dc49(0xf8)]=![];});}}}}}}enemies['forEach'](_0x31756a=>{const _0x165771=_0x54d5a9;if(_0x31756a&&_0x31756a[_0x165771(0x9f)]===ENEMY3_TYPE&&_0x31756a[_0x165771(0x1b9)]&&_0x31756a[_0x165771(0x106)]==='attacking'&&_0x31756a['capturedShipDimensions']&&typeof _0x31756a[_0x165771(0x197)]==='number'){if(_0x52d25d-_0x31756a[_0x165771(0x197)]>CAPTURED_SHIP_FIRE_COOLDOWN_MS){const _0x359196=_0x31756a['x']+_0x31756a[_0x165771(0x1c4)]/0x2,_0x21f690=_0x31756a['y']+_0x31756a[_0x165771(0x120)]+_0x31756a['capturedShipDimensions']['height']*0.5,_0xef79d4={'x':_0x359196,'y':_0x21f690};createBulletSimple(_0x31756a,_0xef79d4)&&(_0x31756a[_0x165771(0x197)]=_0x52d25d,playSound(_0x165771(0x10a),![],0.4));}}});}}else{if(gameOverSequenceStartTime>0x0){const _0xfefc45=_0x52d25d-gameOverSequenceStartTime,_0x118565=_0xfefc45>=GAME_OVER_DURATION;if(_0x118565&&!isShowingResultsScreen){isShowingResultsScreen=!![],stopSound(_0x54d5a9(0xd0)),playSound(_0x54d5a9(0x167),!![],0.2),explosions=[];if(typeof updateExplosions===_0x54d5a9(0x11f))updateExplosions();}}}!_0xf466f&&renderGame();}catch(_0x2856f7){console[_0x54d5a9(0x95)]('!!!\x20CRITICAL\x20ERROR\x20IN\x20runSingleGameUpdate\x20!!!',_0x2856f7,_0x2856f7[_0x54d5a9(0xcd)]),isPaused=![];mainLoopId&&(cancelAnimationFrame(mainLoopId),mainLoopId=null);isInGameState=![],isPlayer1ShowingGameOverMessage=![],player1GameOverMessageStartTime=0x0,isPlayer2ShowingGameOverMessage=![],player2GameOverMessageStartTime=0x0,isShowingPlayerGameOverMessage=![],playerGameOverMessageStartTime=0x0,playerWhoIsGameOver=0x0,nextActionAfterPlayerGameOver='',alert(_0x54d5a9(0x1c5)),stopAllGameSoundsInternal(),isGridSoundPlaying=![],isInvincible=![],invincibilityEndTime=0x0;try{typeof showMenuState===_0x54d5a9(0x11f)&&showMenuState();}catch(_0x4c1717){console[_0x54d5a9(0x95)](_0x54d5a9(0x181),_0x4c1717);}}}function checkAndAwardExtraLife(_0x44319e=null){const _0xb17df8=_0x571912;try{const _0x1d7ec5=[];if(_0x44319e===0x1){const _0x3946e1=isTwoPlayerMode&&selectedGameMode===_0xb17df8(0x99)?player1Lives:isTwoPlayerMode&&selectedGameMode===_0xb17df8(0x156)&&currentPlayer===0x1?playerLives:player1Lives,_0x3adce5=isTwoPlayerMode&&selectedGameMode==='coop'?player1Score:isTwoPlayerMode&&selectedGameMode===_0xb17df8(0x156)&&currentPlayer===0x1?score:player1Score;_0x1d7ec5['push']({'num':0x1,'currentLives':_0x3946e1,'currentScore':_0x3adce5,'thresholdsMet':player1LifeThresholdsMet});}else{if(_0x44319e===0x2&&isTwoPlayerMode){const _0x5c311c=selectedGameMode==='coop'?player2Lives:selectedGameMode==='normal'&&currentPlayer===0x2?playerLives:player2Lives,_0x47e8b0=selectedGameMode===_0xb17df8(0x99)?player2Score:selectedGameMode===_0xb17df8(0x156)&&currentPlayer===0x2?score:player2Score;_0x1d7ec5[_0xb17df8(0xd2)]({'num':0x2,'currentLives':_0x5c311c,'currentScore':_0x47e8b0,'thresholdsMet':player2LifeThresholdsMet});}else{if(isTwoPlayerMode&&selectedGameMode===_0xb17df8(0x99)&&_0x44319e===null)_0x1d7ec5[_0xb17df8(0xd2)]({'num':0x1,'currentLives':player1Lives,'currentScore':player1Score,'thresholdsMet':player1LifeThresholdsMet}),_0x1d7ec5[_0xb17df8(0xd2)]({'num':0x2,'currentLives':player2Lives,'currentScore':player2Score,'thresholdsMet':player2LifeThresholdsMet});else{if(!isTwoPlayerMode&&(_0x44319e===null||_0x44319e===0x1))_0x1d7ec5['push']({'num':0x1,'currentLives':playerLives,'currentScore':score,'thresholdsMet':player1LifeThresholdsMet});else isTwoPlayerMode&&selectedGameMode===_0xb17df8(0x156)&&_0x44319e===currentPlayer&&(currentPlayer===0x1?_0x1d7ec5['push']({'num':0x1,'currentLives':playerLives,'currentScore':score,'thresholdsMet':player1LifeThresholdsMet}):_0x1d7ec5['push']({'num':0x2,'currentLives':playerLives,'currentScore':score,'thresholdsMet':player2LifeThresholdsMet}));}}}_0x1d7ec5[_0xb17df8(0xce)](_0x317a17=>{const _0x3b5801=_0xb17df8;let _0x567adc=![];while(!![]){let _0x39b841=![],_0x211b38=-0x1;const _0x1aa40f=_0x317a17['thresholdsMet'][_0x3b5801(0x109)];if(_0x1aa40f===0x0)_0x211b38=EXTRA_LIFE_THRESHOLD_1;else{if(_0x1aa40f===0x1&&!_0x317a17[_0x3b5801(0xb1)][_0x3b5801(0x10d)](EXTRA_LIFE_THRESHOLD_2))_0x211b38=EXTRA_LIFE_THRESHOLD_2;else{if(_0x1aa40f>=0x1&&_0x317a17[_0x3b5801(0xb1)][_0x3b5801(0x10d)](EXTRA_LIFE_THRESHOLD_1)&&_0x317a17['thresholdsMet'][_0x3b5801(0x10d)](EXTRA_LIFE_THRESHOLD_2)){let _0x18b6f1=0x0;_0x317a17[_0x3b5801(0xb1)]['forEach'](_0x4b6f13=>{_0x4b6f13>=EXTRA_LIFE_THRESHOLD_2&&(_0x4b6f13-EXTRA_LIFE_THRESHOLD_2)%RECURRING_EXTRA_LIFE_INTERVAL===0x0&&_0x18b6f1++;}),_0x211b38=EXTRA_LIFE_THRESHOLD_2+_0x18b6f1*RECURRING_EXTRA_LIFE_INTERVAL;}else{if(_0x1aa40f===0x1&&_0x317a17[_0x3b5801(0xb1)][_0x3b5801(0x10d)](EXTRA_LIFE_THRESHOLD_1)&&!_0x317a17['thresholdsMet'][_0x3b5801(0x10d)](EXTRA_LIFE_THRESHOLD_2))_0x211b38=EXTRA_LIFE_THRESHOLD_2;else _0x1aa40f===0x1&&_0x317a17[_0x3b5801(0xb1)][_0x3b5801(0x10d)](EXTRA_LIFE_THRESHOLD_2)&&!_0x317a17[_0x3b5801(0xb1)]['has'](EXTRA_LIFE_THRESHOLD_1)&&(_0x211b38=EXTRA_LIFE_THRESHOLD_1);}}}if(_0x211b38!==-0x1&&_0x317a17['currentScore']>=_0x211b38&&!_0x317a17['thresholdsMet'][_0x3b5801(0x10d)](_0x211b38)){if(_0x317a17[_0x3b5801(0x13a)]===0x1){if(isTwoPlayerMode&&selectedGameMode===_0x3b5801(0x99))player1Lives++;else{if(isTwoPlayerMode&&selectedGameMode===_0x3b5801(0x156)&&currentPlayer===0x1)playerLives++;else{if(!isTwoPlayerMode)playerLives++;}}player1Lives=isTwoPlayerMode&&selectedGameMode==='coop'?player1Lives:isTwoPlayerMode&&selectedGameMode===_0x3b5801(0x156)&&currentPlayer===0x1?playerLives:player1Lives,_0x317a17[_0x3b5801(0xa3)]=player1Lives;}else{if(_0x317a17[_0x3b5801(0x13a)]===0x2){if(isTwoPlayerMode&&selectedGameMode===_0x3b5801(0x99))player2Lives++;else{if(isTwoPlayerMode&&selectedGameMode===_0x3b5801(0x156)&&currentPlayer===0x2)playerLives++;}player2Lives=isTwoPlayerMode&&selectedGameMode==='coop'?player2Lives:isTwoPlayerMode&&selectedGameMode==='normal'&&currentPlayer===0x2?playerLives:player2Lives,_0x317a17[_0x3b5801(0xa3)]=player2Lives;}}_0x317a17[_0x3b5801(0xb1)][_0x3b5801(0xc7)](_0x211b38),_0x567adc=!![],_0x39b841=!![];}if(!_0x39b841)break;}_0x567adc&&!showExtraLifeMessage&&!showCsBonusScoreMessage&&!showPerfectMessage&&!showCsHitsMessage&&!showCSClearMessage&&!showReadyMessage&&setTimeout(()=>{const _0x1802b4=_0x3b5801;if(isInGameState){explosions=[];if(typeof updateExplosions==='function')updateExplosions();showExtraLifeMessage=!![],extraLifeMessageStartTime=Date[_0x1802b4(0x1a6)](),playSound(_0x1802b4(0xe9),![],0.5);}},EXPLOSION_DURATION);});}catch(_0x37d63a){console[_0xb17df8(0x95)](_0xb17df8(0x13c),_0x37d63a);}}